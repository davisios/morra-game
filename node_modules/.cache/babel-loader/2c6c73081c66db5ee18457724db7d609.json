{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function () {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nimport algosdk from 'algosdk';\nimport ethers from 'ethers';\nimport Timeout from 'await-timeout';\nimport buffer from 'buffer';\nimport * as RHC from './ALGO_ReachHTTPClient.mjs'; // @ts-ignore // XXX Dan FIXME pls\n\nimport * as UTBC from './ALGO_UTBC.mjs';\nvar Buffer = buffer.Buffer;\nimport { VERSION } from './version.mjs';\nimport { apiStateMismatchError, stdContract, stdVerifyContract, stdABIFilter, stdAccount, stdAccount_unsupported, debug, envDefault, argsSplit, makeRandom, replaceableThunk, ensureConnectorAvailable, make_newTestAccounts, make_waitUntilX, checkTimeout, truthyEnv, Lock, retryLoop, makeEventQueue, makeEventStream, makeSigningMonitor, j2sf, j2s, hideWarnings, hasProp, makeParseCurrency } from './shared_impl.mjs';\nimport { bigNumberify, bigNumberToNumber, bigNumberToBigInt } from './shared_user.mjs';\nimport waitPort from './waitPort.mjs';\nimport { addressFromHex, stdlib, typeDefs, extractAddr, bytestringyNet } from './ALGO_compiled.mjs';\nimport { simTokenAccepted_ } from './shared_backend.mjs';\nimport { window, process } from './shim.mjs';\nimport { sha512_256 } from 'js-sha512';\nimport * as shared_user from './shared_user.mjs';\nimport * as shared_impl from './shared_impl.mjs';\n;\n;\nvar defaultALGO_TOKEN_HEADER = 'X-Algo-API-Token';\nvar defaultALGO_INDEXER_TOKEN_HEADER = 'X-Indexer-API-Token';\nvar reachBackendVersion = 18;\nvar reachAlgoBackendVersion = 10;\n;\n;\nexport var load = function () {\n  var connector = 'ALGO';\n  var reachStdlib = stdlib;\n  var setQueryLowerBound = shared_impl.setQueryLowerBound,\n      getQueryLowerBound = shared_impl.getQueryLowerBound,\n      formatWithDecimals = shared_impl.formatWithDecimals,\n      handleFormat = shared_impl.handleFormat;\n\n  var _a = __read(makeSigningMonitor(), 2),\n      setSigningMonitor = _a[0],\n      notifySend = _a[1]; // module-wide config\n\n\n  var customHttpEventHandler = function () {\n    return __awaiter(void 0, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2\n        /*return*/\n        , undefined];\n      });\n    });\n  };\n\n  function setCustomHttpEventHandler(h) {\n    customHttpEventHandler = h;\n  }\n  /**\n   * @description client-side rate limiting.\n   *  Setting this to any positive number will also prevent requests from being sent in parallel.\n   *  Rate limiting is applied to all outgoing http requests, even if they are to different servers.\n   */\n\n\n  var minMillisBetweenRequests = 0;\n\n  function setMinMillisBetweenRequests(n) {\n    minMillisBetweenRequests = n;\n  }\n\n  var reqLock = new Lock();\n  var currentReqNum = undefined;\n  var currentReqLabel = undefined;\n  var lastReqSentAt = undefined; // ms\n\n  var appStateMinRefreshMillis = 1000;\n\n  function httpEventHandler(e) {\n    return __awaiter(this, void 0, void 0, function () {\n      var en, waitMs;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            en = e.eventName;\n            if (!(minMillisBetweenRequests > 0)) return [3\n            /*break*/\n            , 5];\n            if (!(en === 'before')) return [3\n            /*break*/\n            , 4];\n            return [4\n            /*yield*/\n            , reqLock.acquire()];\n\n          case 1:\n            _a.sent();\n\n            if (!lastReqSentAt) return [3\n            /*break*/\n            , 3];\n            waitMs = Math.max(0, lastReqSentAt + minMillisBetweenRequests - Date.now());\n            debug(\"waiting \".concat(waitMs, \"ms due to minMillisBetweenRequests=\").concat(minMillisBetweenRequests));\n            return [4\n            /*yield*/\n            , Timeout.set(waitMs)];\n\n          case 2:\n            _a.sent();\n\n            _a.label = 3;\n\n          case 3:\n            lastReqSentAt = Date.now();\n            currentReqNum = e.reqNum;\n            currentReqLabel = e.label;\n            _a.label = 4;\n\n          case 4:\n            if (en === 'success' || en === 'error') {\n              if (currentReqNum === e.reqNum && currentReqLabel == e.label) {\n                currentReqNum = undefined;\n                currentReqLabel = undefined;\n                reqLock.release();\n              } else {\n                throw Error('impossible: multiple requests in flight');\n              }\n            }\n\n            _a.label = 5;\n\n          case 5:\n            return [4\n            /*yield*/\n            , customHttpEventHandler(e)];\n\n          case 6:\n            _a.sent();\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  } // Helpers\n  // Parse CBR into Public Key\n\n\n  var cbr2algo_addr = function (x) {\n    return algosdk.encodeAddress(Buffer.from(x.slice(2), 'hex'));\n  };\n\n  var txnFromAddress = function (t) {\n    return algosdk.encodeAddress(t.from.publicKey);\n  };\n\n  function uint8ArrayToStr(a, enc) {\n    if (enc === void 0) {\n      enc = 'utf8';\n    }\n\n    if (!(a instanceof Uint8Array)) {\n      console.log(a);\n      throw Error(\"Expected Uint8Array, got \".concat(a));\n    }\n\n    return Buffer.from(a).toString(enc);\n  } // TODO: read token from scripts/devnet-algo/algorand_data/algod.token\n\n\n  var rawDefaultToken = 'c87f5580d7a866317b4bfe9e8b8d1dda955636ccebfa88c12b414db208dd9705';\n  var rawDefaultItoken = 'reach-devnet';\n\n  var indexerTxn2RecvTxn = function (txn) {\n    var ait = txn['application-transaction'] || {};\n    var aargs = ait['application-args'] || [];\n    var aidx = ait['application-id']; // We're returning the first we find, but actually we just want the first one\n    // period.\n\n    var ccai = function () {\n      var e_1, _a;\n\n      var its = txn['inner-txns'] || [];\n\n      try {\n        for (var its_1 = __values(its), its_1_1 = its_1.next(); !its_1_1.done; its_1_1 = its_1.next()) {\n          var itx = its_1_1.value;\n          debug('ccai itx', itx);\n          return itx['created-application-index'];\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (its_1_1 && !its_1_1.done && (_a = its_1[\"return\"])) _a.call(its_1);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n\n      return undefined;\n    }();\n\n    return {\n      'confirmed-round': txn['confirmed-round'],\n      'sender': txn['sender'],\n      'approval-program': ait['approval-program'],\n      'clear-state-program': ait['clear-state-program'],\n      'logs': txn['logs'] || [],\n      'application-args': aargs,\n      'application-index': aidx,\n      'created-application-index': txn['created-application-index'],\n      'created-asset-index': txn['created-asset-index'],\n      'created-companion-application-index': ccai\n    };\n  };\n\n  var waitForConfirmation = function (txId) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var doOrDie, dhead, client, checkAlgod, checkIndexer;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            doOrDie = function (p) {\n              return __awaiter(void 0, void 0, void 0, function () {\n                var e_2;\n\n                var _a;\n\n                return __generator(this, function (_b) {\n                  switch (_b.label) {\n                    case 0:\n                      _b.trys.push([0, 2,, 3]);\n\n                      _a = {};\n                      return [4\n                      /*yield*/\n                      , p];\n\n                    case 1:\n                      return [2\n                      /*return*/\n                      , (_a.val = _b.sent(), _a)];\n\n                    case 2:\n                      e_2 = _b.sent();\n                      return [2\n                      /*return*/\n                      , {\n                        'exn': e_2\n                      }];\n\n                    case 3:\n                      return [2\n                      /*return*/\n                      ];\n                  }\n                });\n              });\n            };\n\n            dhead = \"waitForConfirmation \".concat(txId);\n            return [4\n            /*yield*/\n            , getAlgodClient()];\n\n          case 1:\n            client = _a.sent();\n\n            checkAlgod = function () {\n              return __awaiter(void 0, void 0, void 0, function () {\n                var q, infoM, info, cr, l, dtxn, uToS, ccai;\n                return __generator(this, function (_a) {\n                  switch (_a.label) {\n                    case 0:\n                      q = client.pendingTransactionInformation(txId)[\"do\"]();\n                      return [4\n                      /*yield*/\n                      , doOrDie(q)];\n\n                    case 1:\n                      infoM = _a.sent();\n                      debug(dhead, 'info', infoM);\n                      if (!('exn' in infoM)) return [3\n                      /*break*/\n                      , 3];\n                      debug(dhead, 'switching to indexer on error');\n                      return [4\n                      /*yield*/\n                      , checkIndexer()];\n\n                    case 2:\n                      return [2\n                      /*return*/\n                      , _a.sent()];\n\n                    case 3:\n                      info = infoM.val;\n                      cr = info['confirmed-round'];\n                      if (!(cr !== undefined && cr > 0)) return [3\n                      /*break*/\n                      , 4];\n                      l = info['logs'] === undefined ? [] : info['logs'];\n                      debug(dhead, 'confirmed');\n                      dtxn = algosdk.Transaction.from_obj_for_encoding(info['txn']['txn']);\n                      debug(dhead, 'confirmed', dtxn);\n\n                      uToS = function (a) {\n                        return (a || []).map(function (x) {\n                          return uint8ArrayToStr(x, 'base64');\n                        });\n                      };\n\n                      ccai = function () {\n                        var e_3, _a;\n\n                        var its = info['inner-txns'] || [];\n\n                        try {\n                          for (var its_2 = __values(its), its_2_1 = its_2.next(); !its_2_1.done; its_2_1 = its_2.next()) {\n                            var itx = its_2_1.value;\n                            debug('ccai itx', itx);\n                            return itx['application-index'];\n                          }\n                        } catch (e_3_1) {\n                          e_3 = {\n                            error: e_3_1\n                          };\n                        } finally {\n                          try {\n                            if (its_2_1 && !its_2_1.done && (_a = its_2[\"return\"])) _a.call(its_2);\n                          } finally {\n                            if (e_3) throw e_3.error;\n                          }\n                        }\n\n                        return undefined;\n                      }();\n\n                      return [2\n                      /*return*/\n                      , {\n                        'confirmed-round': cr,\n                        'created-asset-index': info['asset-index'],\n                        // @ts-ignore\n                        'logs': uToS(l),\n                        'created-application-index': info['application-index'],\n                        'created-companion-application-index': ccai,\n                        'sender': txnFromAddress(dtxn),\n                        'application-args': uToS(dtxn.appArgs)\n                      }];\n\n                    case 4:\n                      if (!(info['pool-error'] === '')) return [3\n                      /*break*/\n                      , 6];\n                      debug(dhead, 'still in pool, trying again');\n                      return [4\n                      /*yield*/\n                      , checkAlgod()];\n\n                    case 5:\n                      return [2\n                      /*return*/\n                      , _a.sent()];\n\n                    case 6:\n                      throw Error(\"waitForConfirmation: error confirming: \".concat(j2s(info)));\n                  }\n                });\n              });\n            };\n\n            checkIndexer = function () {\n              return __awaiter(void 0, void 0, void 0, function () {\n                var indexer, q, res;\n                return __generator(this, function (_a) {\n                  switch (_a.label) {\n                    case 0:\n                      return [4\n                      /*yield*/\n                      , getIndexer()];\n\n                    case 1:\n                      indexer = _a.sent();\n                      q = indexer.lookupTransactionByID(txId);\n                      return [4\n                      /*yield*/\n                      , doQuery_(dhead, q)];\n\n                    case 2:\n                      res = _a.sent();\n                      debug(dhead, 'indexer', res);\n                      return [2\n                      /*return*/\n                      , indexerTxn2RecvTxn(res['transaction'])];\n                  }\n                });\n              });\n            };\n\n            return [4\n            /*yield*/\n            , nodeCanRead()];\n\n          case 2:\n            if (!_a.sent()) return [3\n            /*break*/\n            , 4];\n            return [4\n            /*yield*/\n            , checkAlgod()];\n\n          case 3:\n            return [2\n            /*return*/\n            , _a.sent()];\n\n          case 4:\n            return [4\n            /*yield*/\n            , checkIndexer()];\n\n          case 5:\n            return [2\n            /*return*/\n            , _a.sent()];\n        }\n      });\n    });\n  };\n\n  var decodeB64Txn = function (ts) {\n    var tb = Buffer.from(ts, 'base64');\n    return algosdk.decodeUnsignedTransaction(tb);\n  };\n\n  var doSignTxnToB64 = function (t, sk) {\n    var sb = Buffer.from(t.signTxn(sk));\n    return sb.toString('base64');\n  };\n\n  var doSignTxn = function (ts, sk) {\n    return doSignTxnToB64(decodeB64Txn(ts), sk);\n  };\n\n  var signSendAndConfirm = function (acc, txns) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var p, sapt_res, notifyComplete, e_4, es, r, N, tN, e_5, es;\n\n      var _a;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            if (acc.sk !== undefined) {\n              txns.forEach(function (t) {\n                // XXX this comparison is probably wrong, because the addresses are the\n                // wrong type\n                if (acc.sk !== undefined && !t.stxn && t.signers !== undefined && t.signers.length === 1 && t.signers[0] === acc.addr) {\n                  debug('signSendAndConfirm', 'signing one');\n                  t.stxn = doSignTxn(t.txn, acc.sk);\n                }\n              });\n            }\n\n            return [4\n            /*yield*/\n            , getProvider()];\n\n          case 1:\n            p = _b.sent();\n            _b.label = 2;\n\n          case 2:\n            _b.trys.push([2, 4,, 5]);\n\n            return [4\n            /*yield*/\n            , notifySend(txns, p.signAndPostTxns(txns))];\n\n          case 3:\n            _a = __read.apply(void 0, [_b.sent(), 2]), sapt_res = _a[0], notifyComplete = _a[1];\n            return [3\n            /*break*/\n            , 5];\n\n          case 4:\n            e_4 = _b.sent();\n            es = \"\".concat(e_4);\n\n            if (hasProp(e_4, 'response')) {\n              r = e_4.response;\n\n              if (hasProp(r, 'body')) {\n                e_4.response = r.body;\n              } else if (hasProp(r, 'text')) {\n                e_4.response = r.text;\n              } else {\n                delete r.request;\n                delete r.req;\n              }\n            }\n\n            throw {\n              type: 'signAndPost',\n              e: e_4,\n              es: es\n            };\n\n          case 5:\n            debug({\n              sapt_res: sapt_res\n            });\n            N = txns.length - 1;\n            tN = decodeB64Txn(txns[N].txn);\n            _b.label = 6;\n\n          case 6:\n            _b.trys.push([6, 8,, 9]);\n\n            return [4\n            /*yield*/\n            , notifyComplete(waitForConfirmation(tN.txID()))];\n\n          case 7:\n            return [2\n            /*return*/\n            , _b.sent()];\n          // tN.lastRound\n\n          case 8:\n            e_5 = _b.sent();\n            es = \"\".concat(e_5);\n            throw {\n              type: 'waitForConfirmation',\n              e: e_5,\n              es: es\n            };\n\n          case 9:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  var encodeUnsignedTransaction = function (t) {\n    return Buffer.from(algosdk.encodeUnsignedTransaction(t)).toString('base64');\n  };\n\n  var toWTxn = function (t) {\n    return {\n      txn: encodeUnsignedTransaction(t),\n      signers: [txnFromAddress(t)]\n    };\n  }; // Backend\n\n\n  var stdWait = function () {\n    return Timeout.set(1000);\n  };\n\n  var getTxnParams = function (label) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var dhead, client, params_r, bi2n, params;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            dhead = \"\".concat(label, \" fillTxn\");\n            debug(dhead, \"getting params\");\n            return [4\n            /*yield*/\n            , getAlgodClient()];\n\n          case 1:\n            client = _a.sent();\n            _a.label = 2;\n\n          case 2:\n            if (!true) return [3\n            /*break*/\n            , 5];\n            return [4\n            /*yield*/\n            , client.getTransactionParams()[\"do\"]()];\n\n          case 3:\n            params_r = _a.sent();\n            debug(dhead, 'got params:', params_r);\n\n            bi2n = function (x) {\n              return bigNumberToNumber(bigNumberify(x));\n            };\n\n            params = __assign(__assign({}, params_r), {\n              fee: bi2n(params_r.fee),\n              firstRound: bi2n(params_r.firstRound),\n              lastRound: bi2n(params_r.lastRound)\n            });\n            debug(dhead, 'got params:', params);\n\n            if (params.firstRound !== 0) {\n              return [2\n              /*return*/\n              , params];\n            }\n\n            debug(dhead, \"...but firstRound is 0, so let's wait and try again.\");\n            return [4\n            /*yield*/\n            , stdWait()];\n\n          case 4:\n            _a.sent();\n\n            return [3\n            /*break*/\n            , 2];\n\n          case 5:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  var sign_and_send_sync = function (label, acc, txn) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var e_6;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            _a.trys.push([0, 2,, 3]);\n\n            return [4\n            /*yield*/\n            , signSendAndConfirm(acc, [txn])];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent()];\n\n          case 2:\n            e_6 = _a.sent();\n            console.log(e_6);\n            throw Error(\"\".concat(label, \" txn failed:\\n\").concat(j2s(txn), \"\\nwith:\\n\").concat(j2s(e_6)));\n\n          case 3:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  }; // XXX I'd use x.replaceAll if I could (not supported in this node version), but it would be better to extend ConnectorInfo so these are functions\n\n\n  var replaceAll = function (orig, what, whatp) {\n    var once = orig.replace(what, whatp);\n\n    if (once === orig) {\n      return orig;\n    } else {\n      return replaceAll(once, what, whatp);\n    }\n  };\n\n  function must_be_supported(bin) {\n    var algob = bin._Connectors.ALGO;\n    var unsupported = algob.unsupported,\n        warnings = algob.warnings;\n\n    var render = function (x) {\n      return x.map(function (s) {\n        return \" * \".concat(s);\n      }).join('\\n');\n    };\n\n    if (warnings.length > 0 && !hideWarnings()) {\n      console.error(\"This Reach application is dangerous to run on Algorand for the following reasons:\\n\".concat(render(warnings)));\n    }\n\n    if (unsupported.length > 0) {\n      throw Error(\"This Reach application is not supported on Algorand for the following reasons:\\n\".concat(render(unsupported)));\n    }\n  } // Get these from stdlib\n  // const MaxTxnLife = 1000;\n\n\n  var MinTxnFee = 1000;\n  var MaxAppTxnAccounts = 4;\n  var MinBalance = 100000;\n  var MaxAppProgramLen = 2048;\n  var SchemaMinBalancePerEntry = 25000;\n  var SchemaBytesMinBalance = 25000;\n  var SchemaUintMinBalance = 3500;\n  var AppFlatParamsMinBalance = 100000;\n  var AppFlatOptInMinBalance = 100000;\n\n  var ui8h = function (x) {\n    return Buffer.from(x).toString('hex');\n  };\n\n  var base64ToUI8A = function (x) {\n    return Uint8Array.from(Buffer.from(x, 'base64'));\n  };\n\n  var base64ify = function (x) {\n    return Buffer.from(x).toString('base64');\n  };\n\n  function looksLikeAccountingNotInitialized(e) {\n    var _a;\n\n    var responseText = ((_a = e === null || e === void 0 ? void 0 : e.response) === null || _a === void 0 ? void 0 : _a.text) || null; // TODO: trust the response to be json and parse it?\n    // const json = JSON.parse(responseText) || {};\n    // const msg: string = (json.message || '').toLowerCase();\n\n    var msg = (responseText || '').toLowerCase();\n    return msg.includes(\"accounting not initialized\");\n  }\n\n  var doQueryM_ = function (dhead, query) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var val, exn_1;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            _a.trys.push([0, 2,, 3]);\n\n            return [4\n            /*yield*/\n            , query[\"do\"]()];\n\n          case 1:\n            val = _a.sent();\n            debug(dhead, 'RESULT', val);\n            return [2\n            /*return*/\n            , {\n              val: val\n            }];\n\n          case 2:\n            exn_1 = _a.sent();\n            return [2\n            /*return*/\n            , {\n              exn: exn_1\n            }];\n\n          case 3:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  var doQuery_ = function (dhead, query, howMany, failOk) {\n    if (howMany === void 0) {\n      howMany = 0;\n    }\n\n    if (failOk === void 0) {\n      failOk = function (exn) {\n        return {\n          exn: exn\n        };\n      };\n    }\n\n    return __awaiter(void 0, void 0, void 0, function () {\n      var res, e, fr;\n\n      var _a;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            debug(dhead, query.query);\n            _b.label = 1;\n\n          case 1:\n            if (!true) return [3\n            /*break*/\n            , 5];\n            if (!(howMany > 0)) return [3\n            /*break*/\n            , 3];\n            return [4\n            /*yield*/\n            , stdWait()];\n\n          case 2:\n            _b.sent();\n\n            _b.label = 3;\n\n          case 3:\n            return [4\n            /*yield*/\n            , doQueryM_(dhead, query)];\n\n          case 4:\n            res = _b.sent();\n\n            if ('exn' in res) {\n              e = res.exn;\n\n              if ((e === null || e === void 0 ? void 0 : e.errno) === -111 || (e === null || e === void 0 ? void 0 : e.code) === \"ECONNRESET\") {\n                debug(dhead, 'NO CONNECTION');\n              } else if (looksLikeAccountingNotInitialized(e)) {\n                debug(dhead, 'ACCOUNTING NOT INITIALIZED');\n              }\n\n              if ((_a = e === null || e === void 0 ? void 0 : e.response) === null || _a === void 0 ? void 0 : _a.text) {\n                e = e.response.text;\n              }\n\n              fr = failOk(e);\n\n              if ('exn' in fr) {\n                debug(dhead, 'RETRYING', {\n                  e: e\n                });\n                howMany++;\n              } else {\n                debug(dhead, 'FAIL OK', {\n                  e: e,\n                  fr: fr\n                });\n                return [2\n                /*return*/\n                , fr.val];\n              }\n            } else {\n              return [2\n              /*return*/\n              , res.val];\n            }\n\n            return [3\n            /*break*/\n            , 1];\n\n          case 5:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  function getValidQueryWindow() {\n    return true;\n  }\n\n  function setValidQueryWindow(n) {\n    if (typeof n === 'number') {\n      throw Error(\"Only setValidQueryWindow(true) is supported on Algorand\");\n    }\n  }\n\n  var isCreateTxn = function (txn) {\n    var at = txn['application-transaction'];\n    return at ? bigNumberify(at['application-id']).eq(0) : false;\n  };\n\n  var emptyOptIn = function (txn) {\n    var at = txn['application-transaction'];\n    var ataa = at && at['application-args'] || [];\n    return at ? at['on-completion'] === 'optin' && ataa.length == 0 : false;\n  };\n\n  var apiOnly = function (txn) {\n    var ls = txn['logs'];\n\n    if (ls && ls.length === 1) {\n      var l0 = ls[0];\n      var l0ui = base64ToUI8A(l0);\n\n      if (l0ui.length >= 4) {\n        var l0h = ui8h(l0ui.subarray(0, 4));\n        debug('apiOnly', {\n          l0h: l0h\n        });\n        return l0h === '151f7c75';\n      } else {\n        return false;\n      }\n    } else {\n      return false;\n    }\n  };\n\n  var newEventQueue = function () {\n    var getTxns = function (dhead, initArgs, ctime, howMany, limsug) {\n      return __awaiter(void 0, void 0, void 0, function () {\n        var ApplicationID, indexer, mtime, appn, query, q, res, txns, walkTxns, gtime;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              ApplicationID = initArgs.ApplicationID;\n              return [4\n              /*yield*/\n              , getIndexer()];\n\n            case 1:\n              indexer = _a.sent();\n              mtime = bigNumberToNumber(ctime.add(1));\n              debug(dhead, {\n                ctime: ctime,\n                mtime: mtime\n              });\n              appn = bigNumberToNumber(ApplicationID);\n              query = indexer.searchForTransactions().applicationID(appn) //.txType('appl')\n              .minRound(mtime); // TODO: ignore limsug on randlabs?\n\n              if (limsug) {\n                query = query.limit(limsug);\n              }\n\n              q = query;\n              return [4\n              /*yield*/\n              , doQuery_(dhead, q, howMany)];\n\n            case 2:\n              res = _a.sent();\n              txns = [];\n\n              walkTxns = function (ints) {\n                ints.filter(function (x) {\n                  return x['tx-type'] === 'appl';\n                }).forEach(function (x) {\n                  var at = x['application-transaction'] || {};\n                  var ai = bigNumberify(at['application-id'] || 0);\n                  var cai = bigNumberify(x['created-application-index'] || 0);\n                  var its = x['inner-txns'];\n\n                  if (ai.eq(ApplicationID) || cai.eq(ApplicationID)) {\n                    txns.push(x);\n                  } else if (its) {\n                    walkTxns(its);\n                  }\n                });\n              };\n\n              walkTxns(res.transactions);\n              gtime = bigNumberify(res['current-round']);\n              return [2\n              /*return*/\n              , {\n                txns: txns,\n                gtime: gtime\n              }];\n          }\n        });\n      });\n    };\n\n    var getTxnTime = function (x) {\n      return bigNumberify(x['confirmed-round']);\n    };\n\n    return makeEventQueue({\n      raw2proc: indexerTxn2RecvTxn,\n      alwaysIgnored: function (x) {\n        return emptyOptIn(x) || apiOnly(x);\n      },\n      getTxns: getTxns,\n      getTxnTime: getTxnTime\n    });\n  };\n\n  var addressEq = stdlib.addressEq,\n      assert = stdlib.assert,\n      gt = stdlib.gt,\n      protect = stdlib.protect;\n  var T_UInt = typeDefs.T_UInt,\n      T_Tuple = typeDefs.T_Tuple,\n      T_Contract = typeDefs.T_Contract,\n      T_Bytes = typeDefs.T_Bytes,\n      T_Address = typeDefs.T_Address,\n      T_Digest = typeDefs.T_Digest;\n\n  var _b = makeRandom(8),\n      randomUInt = _b.randomUInt,\n      hasRandom = _b.hasRandom;\n\n  function waitIndexerFromEnv(env) {\n    return __awaiter(this, void 0, void 0, function () {\n      var ALGO_INDEXER_SERVER, ALGO_INDEXER_PORT, ALGO_INDEXER_TOKEN, ALGO_INDEXER_TOKEN_HEADER, port, utbc, rhc;\n\n      var _a;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            ALGO_INDEXER_SERVER = env.ALGO_INDEXER_SERVER, ALGO_INDEXER_PORT = env.ALGO_INDEXER_PORT, ALGO_INDEXER_TOKEN = env.ALGO_INDEXER_TOKEN, ALGO_INDEXER_TOKEN_HEADER = env.ALGO_INDEXER_TOKEN_HEADER;\n            return [4\n            /*yield*/\n            , waitPort(ALGO_INDEXER_SERVER, ALGO_INDEXER_PORT)];\n\n          case 1:\n            _b.sent();\n\n            port = ALGO_INDEXER_PORT || undefined;\n            utbc = new UTBC.URLTokenBaseHTTPClient((_a = {}, _a[ALGO_INDEXER_TOKEN_HEADER] = ALGO_INDEXER_TOKEN, _a), ALGO_INDEXER_SERVER, port);\n            rhc = new RHC.ReachHTTPClient(utbc, 'indexer', httpEventHandler);\n            return [2\n            /*return*/\n            , [rhc, new algosdk.Indexer(rhc)]];\n        }\n      });\n    });\n  }\n\n  function waitAlgodClientFromEnv(env) {\n    return __awaiter(this, void 0, void 0, function () {\n      var ALGO_SERVER, ALGO_PORT, ALGO_TOKEN, ALGO_TOKEN_HEADER, port, utbc, rhc;\n\n      var _a;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            ALGO_SERVER = env.ALGO_SERVER, ALGO_PORT = env.ALGO_PORT, ALGO_TOKEN = env.ALGO_TOKEN, ALGO_TOKEN_HEADER = env.ALGO_TOKEN_HEADER;\n            return [4\n            /*yield*/\n            , waitPort(ALGO_SERVER, ALGO_PORT)];\n\n          case 1:\n            _b.sent();\n\n            port = ALGO_PORT || undefined;\n            utbc = new UTBC.URLTokenBaseHTTPClient((_a = {}, _a[ALGO_TOKEN_HEADER] = ALGO_TOKEN, _a), ALGO_SERVER, port);\n            rhc = new RHC.ReachHTTPClient(utbc, 'algodv2', httpEventHandler);\n            return [2\n            /*return*/\n            , [rhc, new algosdk.Algodv2(rhc)]];\n        }\n      });\n    });\n  }\n\n  var makeProviderByWallet = function (wallet, env) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var defaults, allEnv, ALGO_GENESIS_ID, ALGO_GENESIS_HASH, ALGO_ACCOUNT, REACH_ISOLATED_NETWORK, ALGO_NODE_WRITE_ONLY, walletOpts, isIsolatedNetwork, nodeWriteOnly, enabledNetwork, enabledAccounts, enabled, algod_bc, indexer_bc, algodClient, indexer, getDefaultAddress, signAndPostTxns;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            debug(\"making provider with wallet\");\n            defaults = {\n              REACH_ISOLATED_NETWORK: 'no',\n              ALGO_NODE_WRITE_ONLY: 'yes'\n            };\n            allEnv = __assign(__assign(__assign({}, defaults), env), wallet._env || {});\n            ALGO_GENESIS_ID = env.ALGO_GENESIS_ID, ALGO_GENESIS_HASH = env.ALGO_GENESIS_HASH, ALGO_ACCOUNT = env.ALGO_ACCOUNT;\n            REACH_ISOLATED_NETWORK = allEnv.REACH_ISOLATED_NETWORK, ALGO_NODE_WRITE_ONLY = allEnv.ALGO_NODE_WRITE_ONLY;\n            walletOpts = {\n              genesisID: ALGO_GENESIS_ID || undefined,\n              genesisHash: ALGO_GENESIS_HASH || undefined,\n              accounts: ALGO_ACCOUNT ? [ALGO_ACCOUNT] : undefined\n            };\n            isIsolatedNetwork = truthyEnv(REACH_ISOLATED_NETWORK);\n            nodeWriteOnly = truthyEnv(ALGO_NODE_WRITE_ONLY);\n            if (!(wallet.enableNetwork === undefined && wallet.enableAccounts === undefined)) return [3\n            /*break*/\n            , 2];\n            return [4\n            /*yield*/\n            , wallet.enable(walletOpts)];\n\n          case 1:\n            enabled = _a.sent();\n            enabledNetwork = enabled;\n            enabledAccounts = enabled;\n            return [3\n            /*break*/\n            , 5];\n\n          case 2:\n            if (!(wallet.enableNetwork === undefined || wallet.enableAccounts === undefined)) return [3\n            /*break*/\n            , 3];\n            throw new Error('must have enableNetwork AND enableAccounts OR neither');\n\n          case 3:\n            return [4\n            /*yield*/\n            , wallet.enableNetwork(walletOpts)];\n\n          case 4:\n            enabledNetwork = _a.sent();\n            _a.label = 5;\n\n          case 5:\n            void enabledNetwork;\n            return [4\n            /*yield*/\n            , wallet.getAlgodv2Client()];\n\n          case 6:\n            algod_bc = _a.sent();\n            return [4\n            /*yield*/\n            , wallet.getIndexerClient()];\n\n          case 7:\n            indexer_bc = _a.sent();\n            algodClient = new algosdk.Algodv2(algod_bc);\n            indexer = new algosdk.Indexer(indexer_bc);\n\n            getDefaultAddress = function () {\n              return __awaiter(void 0, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                  switch (_a.label) {\n                    case 0:\n                      if (!(enabledAccounts === undefined)) return [3\n                      /*break*/\n                      , 2];\n\n                      if (wallet.enableAccounts === undefined) {\n                        throw new Error('impossible: no wallet.enableAccounts');\n                      }\n\n                      return [4\n                      /*yield*/\n                      , wallet.enableAccounts(walletOpts)];\n\n                    case 1:\n                      enabledAccounts = _a.sent();\n\n                      if (enabledAccounts === undefined) {\n                        throw new Error('Could not enable accounts');\n                      }\n\n                      _a.label = 2;\n\n                    case 2:\n                      return [2\n                      /*return*/\n                      , enabledAccounts.accounts[0]];\n                  }\n                });\n              });\n            };\n\n            signAndPostTxns = wallet.signAndPostTxns;\n            return [2\n            /*return*/\n            , {\n              algod_bc: algod_bc,\n              indexer_bc: indexer_bc,\n              indexer: indexer,\n              algodClient: algodClient,\n              nodeWriteOnly: nodeWriteOnly,\n              getDefaultAddress: getDefaultAddress,\n              isIsolatedNetwork: isIsolatedNetwork,\n              signAndPostTxns: signAndPostTxns\n            }];\n        }\n      });\n    });\n  };\n\n  var setWalletFallback = function (wf) {\n    if (!window.algorand) {\n      window.algorand = wf();\n    }\n  };\n\n  var checkNetwork = function (ret, eopts) {\n    var id = ret.genesisID,\n        h = ret.genesisHash;\n\n    var _a = eopts || {},\n        eid = _a.genesisID,\n        eh = _a.genesisHash;\n\n    if (eid && eid !== id || eh && eh !== h) {\n      throw Error(\"Requested genesis ID or hash not supported by this wallet.\\n\" + \"Expected: '\".concat(id, \"' '\").concat(h, \"'\\n\") + \"Got: '\".concat(eid, \"' '\").concat(eh, \"'\"));\n    }\n  };\n\n  var checkAccounts = function (addr, got) {\n    if (got && (got[0] !== addr || got.length > 1)) {\n      throw Error(\"One or more requested accounts not supported by this wallet.\\n\" + \"Expected: \".concat(JSON.stringify([addr]), \"\\n\") + \"Got: \".concat(JSON.stringify(got)));\n    }\n  };\n\n  var doWalletFallback_signOnly = function (opts, getAddr, signTxns_, disconnect_) {\n    var p = undefined;\n    var base = opts['providerEnv'] || 'LocalHost';\n\n    var _env = typeof base === 'string' ? providerEnvByName(base) : base;\n\n    var enableNetwork = function (eopts) {\n      return __awaiter(void 0, void 0, void 0, function () {\n        var op, _a, genesisID, genesisHash, ret;\n\n        return __generator(this, function (_b) {\n          switch (_b.label) {\n            case 0:\n              op = opts.provider;\n              if (!op) return [3\n              /*break*/\n              , 1];\n              p = op;\n              return [3\n              /*break*/\n              , 3];\n\n            case 1:\n              return [4\n              /*yield*/\n              , makeProviderByEnv(_env)];\n\n            case 2:\n              p = _b.sent();\n              _b.label = 3;\n\n            case 3:\n              return [4\n              /*yield*/\n              , p.algodClient.getTransactionParams()[\"do\"]()];\n\n            case 4:\n              _a = _b.sent(), genesisID = _a.genesisID, genesisHash = _a.genesisHash;\n              ret = {\n                genesisID: genesisID,\n                genesisHash: genesisHash\n              };\n              checkNetwork(ret, eopts);\n              return [2\n              /*return*/\n              , ret];\n          }\n        });\n      });\n    };\n\n    var enableAccounts = function (eopts) {\n      return __awaiter(void 0, void 0, void 0, function () {\n        var addr;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              return [4\n              /*yield*/\n              , getAddr()];\n\n            case 1:\n              addr = _a.sent();\n              checkAccounts(addr, eopts === null || eopts === void 0 ? void 0 : eopts.accounts);\n              return [2\n              /*return*/\n              , {\n                accounts: [addr]\n              }];\n          }\n        });\n      });\n    };\n\n    var enable = function (eopts) {\n      return __awaiter(void 0, void 0, void 0, function () {\n        var nres, ares;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              return [4\n              /*yield*/\n              , enableNetwork(eopts)];\n\n            case 1:\n              nres = _a.sent();\n              return [4\n              /*yield*/\n              , enableAccounts(eopts)];\n\n            case 2:\n              ares = _a.sent();\n              return [2\n              /*return*/\n              , __assign(__assign({}, nres), ares)];\n          }\n        });\n      });\n    };\n\n    var getAlgodv2Client = function () {\n      return __awaiter(void 0, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n          if (!p) {\n            throw new Error(\"must call enable\");\n          }\n\n          ;\n          return [2\n          /*return*/\n          , p.algod_bc];\n        });\n      });\n    };\n\n    var getIndexerClient = function () {\n      return __awaiter(void 0, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n          if (!p) {\n            throw new Error(\"must call enable\");\n          }\n\n          ;\n          return [2\n          /*return*/\n          , p.indexer_bc];\n        });\n      });\n    };\n\n    var signTxns = function (txns, sopts) {\n      return __awaiter(void 0, void 0, void 0, function () {\n        var to_sign, signed, _a, stxns;\n\n        return __generator(this, function (_b) {\n          switch (_b.label) {\n            case 0:\n              void sopts;\n              debug(\"fallBack: signAndPostTxns\", {\n                txns: txns\n              });\n              to_sign = [];\n              txns.forEach(function (txn) {\n                if (!txn.stxn) {\n                  to_sign.push(txn.txn);\n                }\n              });\n              debug(\"fallBack: signAndPostTxns\", {\n                to_sign: to_sign\n              });\n              if (!(to_sign.length == 0)) return [3\n              /*break*/\n              , 1];\n              _a = [];\n              return [3\n              /*break*/\n              , 3];\n\n            case 1:\n              return [4\n              /*yield*/\n              , signTxns_(to_sign)];\n\n            case 2:\n              _a = _b.sent();\n              _b.label = 3;\n\n            case 3:\n              signed = _a;\n              debug(\"fallBack: signAndPostTxns\", {\n                signed: signed\n              });\n              stxns = txns.map(function (txn) {\n                if (txn.stxn) {\n                  return txn.stxn;\n                }\n\n                var s = signed.shift();\n\n                if (!s) {\n                  throw new Error(\"txn not signed\");\n                }\n\n                return s;\n              });\n              return [2\n              /*return*/\n              , stxns];\n          }\n        });\n      });\n    };\n\n    var postTxns = function (stxns, popts) {\n      return __awaiter(void 0, void 0, void 0, function () {\n        var bs;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              if (!p) {\n                throw new Error(\"must call enable\");\n              }\n\n              ;\n              void popts;\n              bs = stxns.map(function (stxn) {\n                return Buffer.from(stxn, 'base64');\n              });\n              debug(\"fallBack: signAndPostTxns\", bs);\n              return [4\n              /*yield*/\n              , p.algodClient.sendRawTransaction(bs)[\"do\"]()];\n\n            case 1:\n              _a.sent();\n\n              return [2\n              /*return*/\n              , {}];\n            // TODO\n          }\n        });\n      });\n    };\n\n    var signAndPostTxns = function (txns, spopts) {\n      return __awaiter(void 0, void 0, void 0, function () {\n        var stxns;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              if (!p) {\n                throw new Error(\"must call enable\");\n              }\n\n              ;\n              return [4\n              /*yield*/\n              , signTxns(txns, spopts)];\n\n            case 1:\n              stxns = _a.sent();\n              return [4\n              /*yield*/\n              , postTxns(stxns, spopts)];\n\n            case 2:\n              return [2\n              /*return*/\n              , _a.sent()];\n          }\n        });\n      });\n    };\n\n    var disconnect = function () {\n      return __awaiter(void 0, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              return [4\n              /*yield*/\n              , disconnect_()];\n\n            case 1:\n              return [2\n              /*return*/\n              , _a.sent()];\n          }\n        });\n      });\n    };\n\n    return {\n      _env: _env,\n      enable: enable,\n      enableNetwork: enableNetwork,\n      enableAccounts: enableAccounts,\n      getAlgodv2Client: getAlgodv2Client,\n      getIndexerClient: getIndexerClient,\n      signTxns: signTxns,\n      postTxns: postTxns,\n      signAndPostTxns: signAndPostTxns,\n      disconnect: disconnect\n    };\n  };\n\n  var walletFallback_mnemonic = function (opts) {\n    return function () {\n      debug(\"using mnemonic wallet fallback\");\n\n      var getAddr = function () {\n        return __awaiter(void 0, void 0, void 0, function () {\n          return __generator(this, function (_a) {\n            return [2\n            /*return*/\n            , window.prompt(\"Please paste the address of your account:\")];\n          });\n        });\n      };\n\n      var signTxns = function (txns) {\n        return __awaiter(void 0, void 0, void 0, function () {\n          return __generator(this, function (_a) {\n            return [2\n            /*return*/\n            , txns.map(function (ts) {\n              var t = decodeB64Txn(ts);\n              var addr = txnFromAddress(t);\n              var mn = window.prompt(\"Please paste the mnemonic for the address, \".concat(addr, \". It will not be saved.\"));\n              var acc = algosdk.mnemonicToSecretKey(mn);\n              return doSignTxnToB64(t, acc.sk);\n            })];\n          });\n        });\n      };\n\n      var disconnect = function () {\n        return __awaiter(void 0, void 0, void 0, function () {\n          return __generator(this, function (_a) {\n            return [2\n            /*return*/\n            ];\n          });\n        });\n      };\n\n      return doWalletFallback_signOnly(opts, getAddr, signTxns, disconnect);\n    };\n  };\n\n  var walletFallback_MyAlgoWallet = function (MyAlgoConnect, opts) {\n    return function () {\n      debug(\"using MyAlgoWallet wallet fallback\"); // Workaround for known webpack issue w/ MAW 1.1.2 & earlier\n      // https://github.com/randlabs/myalgo-connect/issues/27\n\n      if (!window.Buffer) window.Buffer = Buffer; // @ts-ignore\n\n      var mac = new MyAlgoConnect(); // MyAlgoConnect uses a global popup object for managing, so we need to\n      // guarantee there is only one in flight at a time.\n\n      var lock = new Lock();\n\n      var getAddr = function () {\n        return __awaiter(void 0, void 0, void 0, function () {\n          var accts;\n          return __generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                return [4\n                /*yield*/\n                , lock.runWith(function () {\n                  return __awaiter(void 0, void 0, void 0, function () {\n                    return __generator(this, function (_a) {\n                      switch (_a.label) {\n                        case 0:\n                          return [4\n                          /*yield*/\n                          , mac.connect({\n                            shouldSelectOneAccount: true\n                          })];\n\n                        case 1:\n                          return [2\n                          /*return*/\n                          , _a.sent()];\n                      }\n                    });\n                  });\n                })];\n\n              case 1:\n                accts = _a.sent();\n                return [2\n                /*return*/\n                , accts[0].address];\n            }\n          });\n        });\n      };\n\n      var signTxns = function (txns) {\n        return __awaiter(void 0, void 0, void 0, function () {\n          var stxns;\n          return __generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                debug(\"MAW signTransaction ->\", txns);\n                return [4\n                /*yield*/\n                , lock.runWith(function () {\n                  return __awaiter(void 0, void 0, void 0, function () {\n                    return __generator(this, function (_a) {\n                      switch (_a.label) {\n                        case 0:\n                          return [4\n                          /*yield*/\n                          , mac.signTransaction(txns)];\n\n                        case 1:\n                          return [2\n                          /*return*/\n                          , _a.sent()];\n                      }\n                    });\n                  });\n                })];\n\n              case 1:\n                stxns = _a.sent();\n                debug(\"MAW signTransaction <-\", stxns);\n                return [2\n                /*return*/\n                , stxns.map(function (sts) {\n                  return Buffer.from(sts.blob).toString('base64');\n                })];\n            }\n          });\n        });\n      };\n\n      var disconnect = function () {\n        return __awaiter(void 0, void 0, void 0, function () {\n          return __generator(this, function (_a) {\n            return [2\n            /*return*/\n            ];\n          });\n        });\n      };\n\n      return doWalletFallback_signOnly(opts, getAddr, signTxns, disconnect);\n    };\n  };\n\n  ;\n\n  var walletFallback_WalletConnect = function (WalletConnect, opts) {\n    return function () {\n      debug(\"using WalletConnect wallet fallback\");\n      var wc = opts.WalletConnect_wc || new WalletConnect();\n\n      var disconnect = function () {\n        return wc.disconnect();\n      };\n\n      var wallet = doWalletFallback_signOnly(opts, function () {\n        return wc.getAddr();\n      }, function (ts) {\n        return wc.signTxns(ts);\n      }, disconnect);\n      return __assign(__assign({}, wallet), {\n        wc: wc\n      });\n    };\n  };\n\n  var walletFallback = function (opts) {\n    debug(\"using wallet fallback with\", opts);\n    var mac = opts.MyAlgoConnect;\n\n    if (mac) {\n      return walletFallback_MyAlgoWallet(mac, opts);\n    }\n\n    var wc = opts.WalletConnect;\n\n    if (wc) {\n      return walletFallback_WalletConnect(wc, opts);\n    } // This could be implemented with walletFallback_signOnly and the residue\n    // from the old version.\n    //  return walletFallback_AlgoSigner(opts);\n\n\n    return walletFallback_mnemonic(opts);\n  };\n\n  var _c = __read(replaceableThunk(function () {\n    return __awaiter(void 0, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!window.algorand) return [3\n            /*break*/\n            , 2];\n            return [4\n            /*yield*/\n            , makeProviderByWallet(window.algorand, process.env)];\n\n          case 1:\n            // @ts-ignore\n            return [2\n            /*return*/\n            , _a.sent()];\n\n          case 2:\n            debug(\"making default provider based on process.env\");\n            return [4\n            /*yield*/\n            , makeProviderByEnv(process.env)];\n\n          case 3:\n            return [2\n            /*return*/\n            , _a.sent()];\n        }\n      });\n    });\n  }), 2),\n      getProvider = _c[0],\n      setProvider = _c[1];\n\n  var getAlgodClient = function () {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var c;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , getProvider()];\n\n          case 1:\n            c = _a.sent().algodClient;\n            c.setIntEncoding(algosdk.IntDecoding.BIGINT);\n            return [2\n            /*return*/\n            , c];\n        }\n      });\n    });\n  };\n\n  var getIndexer = function () {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var p;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , getProvider()];\n\n          case 1:\n            p = _a.sent().indexer;\n            p.setIntEncoding(algosdk.IntDecoding.BIGINT);\n            return [2\n            /*return*/\n            , p];\n        }\n      });\n    });\n  };\n\n  var nodeCanRead = function () {\n    return __awaiter(void 0, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , getProvider()];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent().nodeWriteOnly === false];\n        }\n      });\n    });\n  };\n\n  var ensureNodeCanRead = function () {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var _a;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            _a = assert;\n            return [4\n            /*yield*/\n            , nodeCanRead()];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.apply(void 0, [_b.sent(), \"node can read\"])];\n        }\n      });\n    });\n  };\n\n  var localhostProviderEnv = {\n    ALGO_SERVER: 'http://localhost',\n    ALGO_PORT: '4180',\n    ALGO_TOKEN_HEADER: defaultALGO_TOKEN_HEADER,\n    ALGO_TOKEN: rawDefaultToken,\n    ALGO_INDEXER_SERVER: 'http://localhost',\n    ALGO_INDEXER_PORT: '8980',\n    ALGO_INDEXER_TOKEN_HEADER: defaultALGO_INDEXER_TOKEN_HEADER,\n    ALGO_INDEXER_TOKEN: rawDefaultItoken,\n    REACH_ISOLATED_NETWORK: 'yes',\n    ALGO_NODE_WRITE_ONLY: 'no'\n  };\n\n  function envDefaultsALGO(env) {\n    var e_7, _a;\n\n    var denv = localhostProviderEnv; // @ts-ignore\n\n    var ret = {};\n\n    try {\n      for (var _b = __values(['ALGO_SERVER', 'ALGO_PORT', 'ALGO_TOKEN_HEADER', 'ALGO_TOKEN', 'ALGO_INDEXER_SERVER', 'ALGO_INDEXER_PORT', 'ALGO_INDEXER_TOKEN_HEADER', 'ALGO_INDEXER_TOKEN', 'REACH_ISOLATED_NETWORK', 'ALGO_NODE_WRITE_ONLY']), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var f = _c.value; // @ts-ignore\n\n        ret[f] = envDefault(env[f], denv[f]);\n      }\n    } catch (e_7_1) {\n      e_7 = {\n        error: e_7_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b[\"return\"])) _a.call(_b);\n      } finally {\n        if (e_7) throw e_7.error;\n      }\n    }\n\n    return ret;\n  }\n\n  ;\n\n  function makeProviderByEnv(env) {\n    return __awaiter(this, void 0, void 0, function () {\n      var fullEnv, _a, algod_bc, algodClient, _b, indexer_bc, indexer, isIsolatedNetwork, nodeWriteOnly, errmsg, getDefaultAddress, signAndPostTxns;\n\n      var _this = this;\n\n      return __generator(this, function (_c) {\n        switch (_c.label) {\n          case 0:\n            debug(\"makeProviderByEnv\", env);\n            fullEnv = envDefaultsALGO(env);\n            debug(\"makeProviderByEnv defaulted\", fullEnv);\n            return [4\n            /*yield*/\n            , waitAlgodClientFromEnv(fullEnv)];\n\n          case 1:\n            _a = __read.apply(void 0, [_c.sent(), 2]), algod_bc = _a[0], algodClient = _a[1];\n            return [4\n            /*yield*/\n            , waitIndexerFromEnv(fullEnv)];\n\n          case 2:\n            _b = __read.apply(void 0, [_c.sent(), 2]), indexer_bc = _b[0], indexer = _b[1];\n            isIsolatedNetwork = truthyEnv(fullEnv.REACH_ISOLATED_NETWORK);\n            nodeWriteOnly = truthyEnv(fullEnv.ALGO_NODE_WRITE_ONLY);\n\n            errmsg = function (s) {\n              return \"Providers created by environment \".concat(s, \". Calling setProviderByEnv or setProviderByName removes this capability. Try removing calls to those functions.\");\n            };\n\n            getDefaultAddress = function () {\n              return __awaiter(_this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                  throw new Error(errmsg(\"do not have default addresses\"));\n                });\n              });\n            };\n\n            signAndPostTxns = function (txns, opts) {\n              return __awaiter(_this, void 0, void 0, function () {\n                var stxns, bs;\n                return __generator(this, function (_a) {\n                  switch (_a.label) {\n                    case 0:\n                      void opts;\n                      stxns = txns.map(function (txn) {\n                        if (txn.stxn) {\n                          return txn.stxn;\n                        }\n\n                        throw new Error(errmsg(\"cannot interactively sign\"));\n                      });\n                      bs = stxns.map(function (stxn) {\n                        return Buffer.from(stxn, 'base64');\n                      });\n                      debug(\"signAndPostTxns\", bs);\n                      return [4\n                      /*yield*/\n                      , algodClient.sendRawTransaction(bs)[\"do\"]()];\n\n                    case 1:\n                      _a.sent();\n\n                      return [2\n                      /*return*/\n                      ];\n                  }\n                });\n              });\n            };\n\n            return [2\n            /*return*/\n            , {\n              algod_bc: algod_bc,\n              indexer_bc: indexer_bc,\n              algodClient: algodClient,\n              indexer: indexer,\n              nodeWriteOnly: nodeWriteOnly,\n              isIsolatedNetwork: isIsolatedNetwork,\n              getDefaultAddress: getDefaultAddress,\n              signAndPostTxns: signAndPostTxns\n            }];\n        }\n      });\n    });\n  }\n\n  ;\n\n  function setProviderByEnv(env) {\n    setProvider(makeProviderByEnv(env));\n  }\n\n  ;\n\n  function algonodeEnv(net) {\n    // works for MainNet, TestNet, and BetaNet\n    // https://algonode.io/api/#node-api\n    var prefix = \"https://\".concat(net.toLowerCase(), \"-\");\n    var suffix = \".algonode.cloud\";\n    return {\n      ALGO_SERVER: \"\".concat(prefix, \"api\").concat(suffix),\n      ALGO_PORT: \"\",\n      ALGO_TOKEN_HEADER: defaultALGO_TOKEN_HEADER,\n      ALGO_TOKEN: \"\",\n      ALGO_INDEXER_SERVER: \"\".concat(prefix, \"idx\").concat(suffix),\n      ALGO_INDEXER_PORT: \"\",\n      ALGO_INDEXER_TOKEN_HEADER: defaultALGO_INDEXER_TOKEN_HEADER,\n      ALGO_INDEXER_TOKEN: \"\",\n      REACH_ISOLATED_NETWORK: 'no',\n      ALGO_NODE_WRITE_ONLY: 'yes'\n    };\n  }\n\n  function randlabsProviderEnv(net) {\n    var prefix = net === 'MainNet' ? '' : \"\".concat(net.toLowerCase(), \".\");\n    var RANDLABS_BASE = \"\".concat(prefix, \"algoexplorerapi.io\");\n    return {\n      ALGO_SERVER: \"https://node.\".concat(RANDLABS_BASE),\n      ALGO_PORT: '',\n      ALGO_TOKEN_HEADER: defaultALGO_TOKEN_HEADER,\n      ALGO_TOKEN: '',\n      // TODO: update to just indexer.\n      ALGO_INDEXER_SERVER: \"https://algoindexer.\".concat(RANDLABS_BASE),\n      ALGO_INDEXER_PORT: '',\n      ALGO_INDEXER_TOKEN_HEADER: defaultALGO_INDEXER_TOKEN_HEADER,\n      ALGO_INDEXER_TOKEN: '',\n      REACH_ISOLATED_NETWORK: 'no',\n      ALGO_NODE_WRITE_ONLY: 'yes'\n    };\n  }\n\n  function providerEnvByName(pn) {\n    switch (pn) {\n      case 'MainNet':\n        return algonodeEnv('MainNet');\n\n      case 'TestNet':\n        return algonodeEnv('TestNet');\n\n      case 'BetaNet':\n        return algonodeEnv('BetaNet');\n\n      case 'randlabs/MainNet':\n        return randlabsProviderEnv('MainNet');\n\n      case 'randlabs/TestNet':\n        return randlabsProviderEnv('TestNet');\n\n      case 'randlabs/BetaNet':\n        return randlabsProviderEnv('BetaNet');\n\n      case 'algonode/MainNet':\n        return algonodeEnv('MainNet');\n\n      case 'algonode/TestNet':\n        return algonodeEnv('TestNet');\n\n      case 'algonode/BetaNet':\n        return algonodeEnv('BetaNet');\n\n      case 'LocalHost':\n        return localhostProviderEnv;\n\n      default:\n        throw Error(\"Unrecognized provider name: \".concat(pn));\n    }\n  }\n\n  function setProviderByName(pn) {\n    return setProviderByEnv(providerEnvByName(pn));\n  } // eslint-disable-next-line max-len\n\n\n  var rawFaucetDefaultMnemonic = 'guilt butter canyon devote inflict comfort lumber relief chat key fury absorb reject palm siege draw jelly lyrics melody palace use box joy ability result';\n\n  var _d = __read(replaceableThunk(function () {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var FAUCET;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            FAUCET = algosdk.mnemonicToSecretKey(envDefault(process.env.ALGO_FAUCET_PASSPHRASE, rawFaucetDefaultMnemonic));\n            return [4\n            /*yield*/\n            , connectAccount(FAUCET)];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent()];\n        }\n      });\n    });\n  }), 2),\n      getFaucet = _d[0],\n      setFaucet = _d[1];\n\n  var str2note = function (x) {\n    return new Uint8Array(Buffer.from(x));\n  };\n\n  var NOTE_Reach_str = \"Reach \".concat(VERSION);\n  var NOTE_Reach = str2note(NOTE_Reach_str);\n\n  var NOTE_Reach_tag = function (tag) {\n    return tag ? str2note(NOTE_Reach_str + \" \".concat(tag, \")\")) : NOTE_Reach;\n  };\n\n  var makeTransferTxn = function (from, to, value, token, ps, closeTo, tag) {\n    if (closeTo === void 0) {\n      closeTo = undefined;\n    }\n\n    if (tag === void 0) {\n      tag = undefined;\n    }\n\n    var valuen = bigNumberToBigInt(value);\n    var note = NOTE_Reach_tag(tag);\n    var txn = token ? algosdk.makeAssetTransferTxnWithSuggestedParams(from, to, closeTo, undefined, valuen, note, bigNumberToNumber(token), ps) : algosdk.makePaymentTxnWithSuggestedParams(from, to, valuen, closeTo, note, ps);\n    return txn;\n  };\n\n  var transfer = function (from, to, value, token, tag) {\n    if (token === void 0) {\n      token = undefined;\n    }\n\n    if (tag === void 0) {\n      tag = undefined;\n    }\n\n    return __awaiter(void 0, void 0, void 0, function () {\n      var sender, receiver, valuebn, ps, txn;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            sender = from.networkAccount;\n            receiver = extractAddr(to);\n            valuebn = bigNumberify(value);\n            return [4\n            /*yield*/\n            , getTxnParams('transfer')];\n\n          case 1:\n            ps = _a.sent();\n            txn = toWTxn(makeTransferTxn(sender.addr, receiver, valuebn, token, ps, undefined, tag));\n            return [4\n            /*yield*/\n            , sign_and_send_sync(\"transfer \".concat(j2s(from), \" \").concat(j2s(to), \" \").concat(valuebn), sender, txn)];\n\n          case 2:\n            return [2\n            /*return*/\n            , _a.sent()];\n        }\n      });\n    });\n  };\n\n  ;\n\n  var makeLogRep = function (evt, tys) {\n    var hLen = 4;\n    var tyns = tys.map(function (ty) {\n      return ty.netName;\n    });\n    var sig = \"\".concat(evt, \"(\").concat(tyns.join(','), \")\");\n    var hu = sha512_256(sig);\n    var hp = hu.slice(0, hLen * 2); // hu is hex nibbles\n\n    var trunc = function (x) {\n      return ui8h(base64ToUI8A(x).slice(0, hLen));\n    };\n\n    debug(\"makeLogRep\", {\n      evt: evt,\n      tyns: tyns,\n      sig: sig,\n      hu: hu,\n      hp: hp\n    });\n\n    var parse = function (log) {\n      if (trunc(log) !== hp) {\n        return undefined;\n      }\n\n      debug(\"parse\", {\n        log: log\n      }); // @ts-ignore\n\n      var _a = __read(T_Tuple(__spreadArray([bytestringyNet(hLen)], __read(tys), false)).fromNet(reNetify(log))),\n          logb = _a[0],\n          pd = _a.slice(1);\n\n      debug(\"parse\", {\n        logb: logb,\n        pd: pd\n      });\n      return pd;\n    };\n\n    var parse0 = function (txn) {\n      if (txn.logs.length == 0) {\n        return undefined;\n      }\n\n      var log = txn.logs[0];\n      return parse(log);\n    };\n\n    var parse0b = function (txn) {\n      return parse0(txn) !== undefined;\n    };\n\n    return {\n      parse: parse,\n      parse0: parse0,\n      parse0b: parse0b\n    };\n  };\n\n  var reachEvent = function (i) {\n    return \"_reach_e\".concat(i);\n  };\n\n  var makeHasLogFor = function (i, tys) {\n    debug(\"hasLogFor\", i, tys);\n    var lr = makeLogRep(reachEvent(i), tys);\n    return lr.parse0b;\n  };\n  /** @description base64->hex->arrayify */\n\n\n  var reNetify = function (x) {\n    var s = Buffer.from(x, 'base64').toString('hex');\n    return ethers.utils.arrayify('0x' + s);\n  };\n\n  var getAccountInfo = function (acc) {\n    return getAddressInfo(extractAddr(acc));\n  };\n\n  var getAddressInfo = function (a) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var dhead, client, req, res_1, e_8, indexer, failOk, query, res;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            dhead = 'getAddressInfo';\n            _a.label = 1;\n\n          case 1:\n            _a.trys.push([1, 5,, 6]);\n\n            return [4\n            /*yield*/\n            , ensureNodeCanRead()];\n\n          case 2:\n            _a.sent();\n\n            return [4\n            /*yield*/\n            , getAlgodClient()];\n\n          case 3:\n            client = _a.sent();\n            req = client.accountInformation(a);\n            debug(dhead, req);\n            return [4\n            /*yield*/\n            , req[\"do\"]()];\n\n          case 4:\n            res_1 = _a.sent();\n            debug(dhead, 'node', res_1);\n            return [2\n            /*return*/\n            , res_1];\n\n          case 5:\n            e_8 = _a.sent();\n            debug(dhead, 'node err', e_8);\n            return [3\n            /*break*/\n            , 6];\n\n          case 6:\n            return [4\n            /*yield*/\n            , getIndexer()];\n\n          case 7:\n            indexer = _a.sent();\n\n            failOk = function (x) {\n              if (typeof x === 'string' && x.includes('no accounts found for address')) {\n                return {\n                  val: {\n                    'current-round': BigInt(0),\n                    'account': {\n                      'amount': BigInt(0)\n                    }\n                  }\n                };\n              } else {\n                return {\n                  exn: x\n                };\n              }\n            };\n\n            query = indexer.lookupAccountByID(a);\n            return [4\n            /*yield*/\n            , doQuery_(dhead, query, 0, failOk)];\n\n          case 8:\n            res = _a.sent();\n            debug(dhead, res);\n            return [2\n            /*return*/\n            , res.account];\n        }\n      });\n    });\n  };\n\n  var getAssetInfo = function (a) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var dhead, indexer, q, failOk, res;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            dhead = 'getAssetInfo';\n            return [4\n            /*yield*/\n            , getIndexer()];\n\n          case 1:\n            indexer = _a.sent();\n            q = indexer.lookupAssetByID(a);\n\n            failOk = function (x) {\n              if (typeof x === 'string' && x.includes('no assets found for asset-id')) {\n                throw Error(\"Asset \".concat(a, \" does not exist\"));\n              } else {\n                return {\n                  exn: x\n                };\n              }\n            };\n\n            return [4\n            /*yield*/\n            , doQuery_(dhead, q, 0, failOk)];\n\n          case 2:\n            res = _a.sent();\n            debug(dhead, res);\n            return [2\n            /*return*/\n            , res.asset];\n        }\n      });\n    });\n  };\n\n  var getApplicationInfoM = function (idn) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var id, dhead, client, res, e_9, indexer, query, queryRes;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            id = bigNumberToNumber(idn);\n            dhead = 'getApplicationInfo';\n            _a.label = 1;\n\n          case 1:\n            _a.trys.push([1, 5,, 6]);\n\n            return [4\n            /*yield*/\n            , ensureNodeCanRead()];\n\n          case 2:\n            _a.sent();\n\n            return [4\n            /*yield*/\n            , getAlgodClient()];\n\n          case 3:\n            client = _a.sent();\n            return [4\n            /*yield*/\n            , client.getApplicationByID(id)[\"do\"]()];\n\n          case 4:\n            res = _a.sent();\n            debug(dhead, 'node', res);\n            return [2\n            /*return*/\n            , {\n              val: res\n            }];\n\n          case 5:\n            e_9 = _a.sent();\n            debug(dhead, 'node err', e_9);\n            return [3\n            /*break*/\n            , 6];\n\n          case 6:\n            return [4\n            /*yield*/\n            , getIndexer()];\n\n          case 7:\n            indexer = _a.sent();\n            query = indexer.lookupApplications(id).includeAll(true);\n            return [4\n            /*yield*/\n            , doQueryM_(dhead, query)];\n\n          case 8:\n            queryRes = _a.sent();\n\n            if ('val' in queryRes) {\n              debug(dhead, {\n                application: queryRes.val.application\n              }); // If application was deleted, synthesize AppInfo from transaction data\n\n              return [2\n              /*return*/\n              , queryRes.val.application.deleted ? getDeletedApplicationInfoM(id) : {\n                val: queryRes.val.application\n              }];\n            } else {\n              return [2\n              /*return*/\n              , queryRes];\n            }\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  var getDeletedApplicationInfoM = function (id) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var dhead, indexer, query, queryRes, txn, appTxn;\n\n      var _a;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            dhead = 'getDeletedApplicationInfoM';\n            return [4\n            /*yield*/\n            , getIndexer()];\n\n          case 1:\n            indexer = _b.sent();\n            query = indexer.searchForTransactions() // .txType('appl')\n            .applicationID(id).limit(1);\n            return [4\n            /*yield*/\n            , doQueryM_(dhead, query)];\n\n          case 2:\n            queryRes = _b.sent();\n\n            if ('val' in queryRes) {\n              if (queryRes.val.transactions.length === 0) {\n                return [2\n                /*return*/\n                , {\n                  exn: 'application does not exist'\n                }];\n              }\n\n              txn = queryRes.val.transactions[0];\n              appTxn = txn['application-transaction'];\n              debug(dhead, {\n                appTxn: appTxn\n              });\n\n              if (txn['tx-type'] !== 'appl' || appTxn === undefined || txn['created-application-index'] !== BigInt(id) || appTxn['application-id'] !== BigInt(0) || appTxn['approval-program'] === undefined || appTxn['clear-state-program'] === undefined || appTxn['local-state-schema'] === undefined || appTxn['global-state-schema'] === undefined) {\n                return [2\n                /*return*/\n                , {\n                  exn: 'tried to synthesize AppInfo from deployment transaction, but the deployment transaction was wrong'\n                }];\n              }\n\n              return [2\n              /*return*/\n              , {\n                val: {\n                  'id': txn['created-application-index'],\n                  'created-at-round': txn['confirmed-round'],\n                  'deleted': true,\n                  'params': {\n                    'creator': txn['sender'],\n                    'approval-program': appTxn['approval-program'],\n                    'clear-state-program': appTxn['clear-state-program'],\n                    'local-state-schema': appTxn['local-state-schema'],\n                    'global-state-schema': appTxn['global-state-schema'],\n                    'global-state': [],\n                    'extra-program-pages': (_a = appTxn['extra-program-pages']) !== null && _a !== void 0 ? _a : BigInt(0)\n                  }\n                }\n              }];\n            } else {\n              return [2\n              /*return*/\n              , queryRes];\n            }\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  var connectAccount = function (networkAccount) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      function setDebugLabel(newLabel) {\n        label = newLabel;\n        debug(\"setDebugLabel\", {\n          newLabel: newLabel,\n          pks: pks\n        }); // @ts-ignore\n\n        return this;\n      }\n\n      var thisAcc, label, pks, createTag, selfAddress, iam, contract, me_na, tokenAccepted, tokenAccept, tokenMetadata, unsupportedAcc, accObj, acc, balanceOf_, balancesOf_;\n      return __generator(this, function (_a) {\n        thisAcc = networkAccount;\n        label = thisAcc.addr.substring(2, 6);\n        pks = T_Address.canonicalize(thisAcc);\n        debug(label, 'connectAccount');\n        createTag = 0;\n\n        selfAddress = function () {\n          return pks;\n        };\n\n        iam = function (some_addr) {\n          if (some_addr === pks) {\n            return some_addr;\n          } else {\n            throw Error(\"I should be \".concat(some_addr, \", but am \").concat(pks));\n          }\n        };\n\n        contract = function (bin, givenInfoP) {\n          ensureConnectorAvailable(bin, 'ALGO', reachBackendVersion, reachAlgoBackendVersion);\n          must_be_supported(bin);\n          var _a = bin._Connectors.ALGO,\n              stateSize = _a.stateSize,\n              stateKeys = _a.stateKeys,\n              mapDataKeys = _a.mapDataKeys,\n              mapDataSize = _a.mapDataSize,\n              ABI = _a.ABI,\n              companionInfo = _a.companionInfo;\n          var hasCompanion = companionInfo !== null;\n          var hasMaps = mapDataKeys > 0;\n\n          var mapDataTy = bin._getMaps({\n            reachStdlib: stdlib\n          }).mapDataTy;\n\n          var emptyMapDataTy = T_Bytes(mapDataTy.netSize);\n          var emptyMapData = // This is a bunch of Nones\n          mapDataTy.fromNet(emptyMapDataTy.toNet(emptyMapDataTy.canonicalize('')));\n          debug({\n            emptyMapData: emptyMapData\n          });\n\n          var makeGetC = function (setupViewArgs, eq) {\n            var getInfo = setupViewArgs.getInfo;\n            var _theC = undefined;\n            return function () {\n              return __awaiter(void 0, void 0, void 0, function () {\n                var ctcInfo, _a, ApplicationID, Deployer, ctcAddr, getLocalState, didOptIn, doOptIn, ensuredOptIn, ensureOptIn, lastAppState, lastAppStateTime, getAppState, getAppStateFresh, getGlobalState, canIWin, isin, isIsolatedNetwork, viewMapRef;\n\n                return __generator(this, function (_b) {\n                  switch (_b.label) {\n                    case 0:\n                      debug(label, 'getC');\n\n                      if (_theC) {\n                        debug(label, 'getC', 'ret');\n                        return [2\n                        /*return*/\n                        , _theC];\n                      }\n\n                      debug(label, 'getC', 'wait');\n                      return [4\n                      /*yield*/\n                      , getInfo()];\n\n                    case 1:\n                      ctcInfo = _b.sent();\n                      return [4\n                      /*yield*/\n                      , stdVerifyContract(setupViewArgs, function () {\n                        return __awaiter(void 0, void 0, void 0, function () {\n                          return __generator(this, function (_a) {\n                            switch (_a.label) {\n                              case 0:\n                                return [4\n                                /*yield*/\n                                , verifyContract_(label, ctcInfo, bin, eq)];\n\n                              case 1:\n                                return [2\n                                /*return*/\n                                , _a.sent()];\n                            }\n                          });\n                        });\n                      })];\n\n                    case 2:\n                      _a = _b.sent(), ApplicationID = _a.ApplicationID, Deployer = _a.Deployer;\n\n                      if (!eq.isInited()) {\n                        eq.init({\n                          ApplicationID: ApplicationID\n                        });\n                        eq.pushIgnore(isCreateTxn);\n                      }\n\n                      debug(label, 'getC', {\n                        ApplicationID: ApplicationID\n                      });\n                      ctcAddr = algosdk.getApplicationAddress(bigNumberToBigInt(ApplicationID));\n                      debug(label, 'getC', {\n                        ctcAddr: ctcAddr\n                      });\n\n                      getLocalState = function (addr) {\n                        return __awaiter(void 0, void 0, void 0, function () {\n                          var dhead, client, query, accAppInfo, indexer, query, appLocalStatesRes, appsLocalStates, appLocalState;\n\n                          var _a, _b;\n\n                          return __generator(this, function (_c) {\n                            switch (_c.label) {\n                              case 0:\n                                dhead = 'getLocalState';\n                                return [4\n                                /*yield*/\n                                , nodeCanRead()];\n\n                              case 1:\n                                if (!_c.sent()) return [3\n                                /*break*/\n                                , 4];\n                                return [4\n                                /*yield*/\n                                , getAlgodClient()];\n\n                              case 2:\n                                client = _c.sent();\n                                query = client.accountApplicationInformation(addr, bigNumberToNumber(ApplicationID));\n                                return [4\n                                /*yield*/\n                                , doQuery_('contract.getLocalState', query, 0, function (_) {\n                                  return {\n                                    val: undefined\n                                  };\n                                })];\n\n                              case 3:\n                                accAppInfo = _c.sent();\n                                return [2\n                                /*return*/\n                                , (_a = accAppInfo === null || accAppInfo === void 0 ? void 0 : accAppInfo['app-local-state']) === null || _a === void 0 ? void 0 : _a['key-value']];\n\n                              case 4:\n                                return [4\n                                /*yield*/\n                                , getIndexer()];\n\n                              case 5:\n                                indexer = _c.sent();\n                                query = indexer.lookupAccountAppLocalStates(addr).applicationID(bigNumberToNumber(ApplicationID));\n                                return [4\n                                /*yield*/\n                                , doQuery_(dhead, query)];\n\n                              case 6:\n                                appLocalStatesRes = _c.sent();\n                                appsLocalStates = (_b = appLocalStatesRes['apps-local-states']) !== null && _b !== void 0 ? _b : [];\n                                appLocalState = appsLocalStates.find(function (app) {\n                                  return ApplicationID.eq(app['id']);\n                                });\n                                return [2\n                                /*return*/\n                                , appLocalState === null || appLocalState === void 0 ? void 0 : appLocalState['key-value']];\n                            }\n                          });\n                        });\n                      };\n\n                      didOptIn = function () {\n                        return __awaiter(void 0, void 0, void 0, function () {\n                          return __generator(this, function (_a) {\n                            switch (_a.label) {\n                              case 0:\n                                return [4\n                                /*yield*/\n                                , getLocalState(thisAcc.addr)];\n\n                              case 1:\n                                return [2\n                                /*return*/\n                                , _a.sent() !== undefined];\n                            }\n                          });\n                        });\n                      };\n\n                      doOptIn = function () {\n                        return __awaiter(void 0, void 0, void 0, function () {\n                          var dhead, _a, _b, _c, _d, _e, _f;\n\n                          return __generator(this, function (_g) {\n                            switch (_g.label) {\n                              case 0:\n                                dhead = \"\".concat(label, \" doOptIn\");\n                                debug(dhead);\n                                _a = sign_and_send_sync;\n                                _b = [dhead, thisAcc];\n                                _c = toWTxn;\n                                _e = (_d = algosdk).makeApplicationOptInTxn;\n                                _f = [thisAcc.addr];\n                                return [4\n                                /*yield*/\n                                , getTxnParams(dhead)];\n\n                              case 1:\n                                return [4\n                                /*yield*/\n                                , _a.apply(void 0, _b.concat([_c.apply(void 0, [_e.apply(_d, _f.concat([_g.sent(), bigNumberToNumber(ApplicationID), undefined, undefined, undefined, undefined, NOTE_Reach]))])]))];\n\n                              case 2:\n                                _g.sent();\n\n                                return [2\n                                /*return*/\n                                ];\n                            }\n                          });\n                        });\n                      };\n\n                      ensuredOptIn = false;\n\n                      ensureOptIn = function () {\n                        return __awaiter(void 0, void 0, void 0, function () {\n                          return __generator(this, function (_a) {\n                            switch (_a.label) {\n                              case 0:\n                                if (!!ensuredOptIn) return [3\n                                /*break*/\n                                , 4];\n                                return [4\n                                /*yield*/\n                                , didOptIn()];\n\n                              case 1:\n                                if (!!_a.sent()) return [3\n                                /*break*/\n                                , 3];\n                                return [4\n                                /*yield*/\n                                , doOptIn()];\n\n                              case 2:\n                                _a.sent();\n\n                                _a.label = 3;\n\n                              case 3:\n                                ensuredOptIn = true;\n                                _a.label = 4;\n\n                              case 4:\n                                return [2\n                                /*return*/\n                                ];\n                            }\n                          });\n                        });\n                      };\n\n                      lastAppState = undefined;\n                      lastAppStateTime = 0;\n\n                      getAppState = function () {\n                        return __awaiter(void 0, void 0, void 0, function () {\n                          var now, minMillis;\n                          return __generator(this, function (_a) {\n                            switch (_a.label) {\n                              case 0:\n                                now = Date.now();\n                                minMillis = isIsolatedNetwork() ? 0 : appStateMinRefreshMillis;\n\n                                if (lastAppState && now - lastAppStateTime < minMillis) {\n                                  debug('getAppState cached');\n                                  return [2\n                                  /*return*/\n                                  , lastAppState];\n                                }\n\n                                return [4\n                                /*yield*/\n                                , getAppStateFresh()];\n\n                              case 1:\n                                lastAppState = _a.sent();\n                                lastAppStateTime = now;\n                                return [2\n                                /*return*/\n                                , lastAppState];\n                            }\n                          });\n                        });\n                      };\n\n                      getAppStateFresh = function () {\n                        return __awaiter(void 0, void 0, void 0, function () {\n                          var lab, appInfoM, appInfo, appSt;\n                          return __generator(this, function (_a) {\n                            switch (_a.label) {\n                              case 0:\n                                lab = \"getAppStateFresh\";\n                                return [4\n                                /*yield*/\n                                , getApplicationInfoM(ApplicationID)];\n\n                              case 1:\n                                appInfoM = _a.sent();\n\n                                if ('exn' in appInfoM || appInfoM.val.deleted) {\n                                  return [2\n                                  /*return*/\n                                  , undefined];\n                                }\n\n                                appInfo = appInfoM.val;\n                                appSt = appInfo['params']['global-state'];\n                                debug(lab, {\n                                  appSt: appSt\n                                });\n                                return [2\n                                /*return*/\n                                , appSt];\n                            }\n                          });\n                        });\n                      };\n\n                      getGlobalState = function (appSt_g) {\n                        return __awaiter(void 0, void 0, void 0, function () {\n                          var appSt, _a, gsbs, mCompanion, gty;\n\n                          return __generator(this, function (_b) {\n                            switch (_b.label) {\n                              case 0:\n                                _a = appSt_g;\n                                if (_a) return [3\n                                /*break*/\n                                , 2];\n                                return [4\n                                /*yield*/\n                                , getAppState()];\n\n                              case 1:\n                                _a = _b.sent();\n                                _b.label = 2;\n\n                              case 2:\n                                appSt = _a;\n\n                                if (!appSt) {\n                                  return [2\n                                  /*return*/\n                                  , undefined];\n                                }\n\n                                gsbs = readStateBytes('', [], appSt);\n\n                                if (!gsbs) {\n                                  return [2\n                                  /*return*/\n                                  , undefined];\n                                }\n\n                                mCompanion = hasCompanion ? [T_Contract] : [];\n                                gty = T_Tuple(__spreadArray([T_UInt, T_UInt], __read(mCompanion), false)); // @ts-ignore\n\n                                return [2\n                                /*return*/\n                                , gty.fromNet(gsbs)];\n                            }\n                          });\n                        });\n                      };\n\n                      canIWin = function (lct) {\n                        return __awaiter(void 0, void 0, void 0, function () {\n                          var gs, r;\n                          return __generator(this, function (_a) {\n                            switch (_a.label) {\n                              case 0:\n                                if (lct.eq(0)) {\n                                  return [2\n                                  /*return*/\n                                  , true];\n                                }\n\n                                return [4\n                                /*yield*/\n                                , getGlobalState()];\n\n                              case 1:\n                                gs = _a.sent();\n                                r = !gs || lct.eq(gs[1]);\n                                debug(\"canIWin\", {\n                                  lct: lct,\n                                  gs: gs,\n                                  r: r\n                                });\n                                return [2\n                                /*return*/\n                                , r];\n                            }\n                          });\n                        });\n                      };\n\n                      return [4\n                      /*yield*/\n                      , getProvider()];\n\n                    case 3:\n                      isin = _b.sent().isIsolatedNetwork;\n\n                      isIsolatedNetwork = function () {\n                        return isin;\n                      };\n\n                      viewMapRef = function (mapi, a) {\n                        return __awaiter(void 0, void 0, void 0, function () {\n                          var ls, mbs, md, mr;\n                          return __generator(this, function (_a) {\n                            switch (_a.label) {\n                              case 0:\n                                debug('viewMapRef', {\n                                  mapi: mapi,\n                                  a: a\n                                });\n                                return [4\n                                /*yield*/\n                                , getLocalState(cbr2algo_addr(a))];\n\n                              case 1:\n                                ls = _a.sent();\n\n                                if (ls === undefined) {\n                                  return [2\n                                  /*return*/\n                                  , ['None', null]];\n                                }\n\n                                debug('viewMapRef', {\n                                  ls: ls\n                                });\n                                mbs = recoverSplitBytes('m', mapDataSize, mapDataKeys, ls);\n                                debug('viewMapRef', {\n                                  mbs: mbs\n                                });\n\n                                if (mbs === undefined) {\n                                  return [2\n                                  /*return*/\n                                  , ['None', null]];\n                                }\n\n                                md = mapDataTy.fromNet(mbs);\n                                debug('viewMapRef', {\n                                  md: md\n                                });\n                                mr = md[mapi];\n                                assert(mr !== undefined, 'viewMapRef mr undefined');\n                                return [2\n                                /*return*/\n                                , mr];\n                            }\n                          });\n                        });\n                      };\n\n                      return [2\n                      /*return*/\n                      , _theC = {\n                        ApplicationID: ApplicationID,\n                        ctcAddr: ctcAddr,\n                        Deployer: Deployer,\n                        getAppState: getAppState,\n                        getGlobalState: getGlobalState,\n                        ensureOptIn: ensureOptIn,\n                        canIWin: canIWin,\n                        isIsolatedNetwork: isIsolatedNetwork,\n                        viewMapRef: viewMapRef\n                      }];\n                  }\n                });\n              });\n            };\n          };\n\n          var getCurrentStep_ = function (ch) {\n            return __awaiter(void 0, void 0, void 0, function () {\n              var getAppState, getGlobalState, appSt, gs;\n              return __generator(this, function (_a) {\n                switch (_a.label) {\n                  case 0:\n                    getAppState = ch.getAppState, getGlobalState = ch.getGlobalState;\n                    return [4\n                    /*yield*/\n                    , getAppState()];\n\n                  case 1:\n                    appSt = _a.sent();\n\n                    if (!appSt) {\n                      throw Error(\"getCurrentStep_: no appSt\");\n                    }\n\n                    return [4\n                    /*yield*/\n                    , getGlobalState(appSt)];\n\n                  case 2:\n                    gs = _a.sent();\n\n                    if (!gs) {\n                      throw Error(\"getCurrentStep_: no gs\");\n                    }\n\n                    return [2\n                    /*return*/\n                    , gs[0]];\n                }\n              });\n            });\n          };\n\n          var getState_ = function (getC, lookup) {\n            return __awaiter(void 0, void 0, void 0, function () {\n              var _a, getAppState, getGlobalState, appSt, gs, vvn, vi, vtys, vty, vvs;\n\n              return __generator(this, function (_b) {\n                switch (_b.label) {\n                  case 0:\n                    return [4\n                    /*yield*/\n                    , getC()];\n\n                  case 1:\n                    _a = _b.sent(), getAppState = _a.getAppState, getGlobalState = _a.getGlobalState;\n                    return [4\n                    /*yield*/\n                    , getAppState()];\n\n                  case 2:\n                    appSt = _b.sent();\n\n                    if (!appSt) {\n                      throw Error(\"getState: no appSt\");\n                    }\n\n                    return [4\n                    /*yield*/\n                    , getGlobalState(appSt)];\n\n                  case 3:\n                    gs = _b.sent();\n\n                    if (!gs) {\n                      throw Error(\"getState: no gs\");\n                    }\n\n                    debug('getState_', {\n                      gs: gs\n                    });\n                    vvn = recoverSplitBytes('v', stateSize, stateKeys, appSt);\n\n                    if (vvn === undefined) {\n                      throw Error(\"getState: no vvn\");\n                    }\n\n                    vi = gs[0];\n                    vtys = lookup(vi);\n                    vty = T_Tuple(vtys);\n                    vvs = vty.fromNet(vvn);\n                    debug(\"getState_\", {\n                      vvn: vvn,\n                      vvs: vvs\n                    });\n                    return [2\n                    /*return*/\n                    , [gs[2], vvs]];\n                }\n              });\n            });\n          };\n\n          var _setup = function (setupArgs) {\n            var setInfo = setupArgs.setInfo,\n                setTrustedVerifyResult = setupArgs.setTrustedVerifyResult;\n            var eq = newEventQueue();\n            var getC = makeGetC(setupArgs, eq);\n            var companionApp = undefined; // Returns address of a Reach contract\n\n            var getContractAddress = function () {\n              return __awaiter(void 0, void 0, void 0, function () {\n                var ctcAddr;\n                return __generator(this, function (_a) {\n                  switch (_a.label) {\n                    case 0:\n                      return [4\n                      /*yield*/\n                      , getC()];\n\n                    case 1:\n                      ctcAddr = _a.sent().ctcAddr;\n                      return [2\n                      /*return*/\n                      , T_Address.canonicalize(ctcAddr)];\n                  }\n                });\n              });\n            };\n\n            var getContractInfo = function () {\n              return __awaiter(void 0, void 0, void 0, function () {\n                var ApplicationID;\n                return __generator(this, function (_a) {\n                  switch (_a.label) {\n                    case 0:\n                      return [4\n                      /*yield*/\n                      , getC()];\n\n                    case 1:\n                      ApplicationID = _a.sent().ApplicationID;\n                      return [2\n                      /*return*/\n                      , ApplicationID];\n                  }\n                });\n              });\n            };\n\n            var getContractCompanion = function () {\n              return __awaiter(void 0, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                  if (hasCompanion) {\n                    return [2\n                    /*return*/\n                    , ['None', null]];\n                  } else {\n                    // @ts-ignore\n                    return [2\n                    /*return*/\n                    , ['Some', companionApp]];\n                  }\n\n                  return [2\n                  /*return*/\n                  ];\n                });\n              });\n            };\n\n            var getCurrentStep = function () {\n              return __awaiter(void 0, void 0, void 0, function () {\n                var _a;\n\n                return __generator(this, function (_b) {\n                  switch (_b.label) {\n                    case 0:\n                      _a = getCurrentStep_;\n                      return [4\n                      /*yield*/\n                      , getC()];\n\n                    case 1:\n                      return [4\n                      /*yield*/\n                      , _a.apply(void 0, [_b.sent()])];\n\n                    case 2:\n                      return [2\n                      /*return*/\n                      , _b.sent()];\n                  }\n                });\n              });\n            };\n\n            var getState = function (vibne, vtys) {\n              return __awaiter(void 0, void 0, void 0, function () {\n                var _a, ci, ans;\n\n                return __generator(this, function (_b) {\n                  switch (_b.label) {\n                    case 0:\n                      debug('getState');\n                      return [4\n                      /*yield*/\n                      , getState_(getC, function (vibna) {\n                        if (vibne.eq(vibna)) {\n                          return vtys;\n                        }\n\n                        throw apiStateMismatchError(bin, vibne, vibna);\n                      })];\n\n                    case 1:\n                      _a = __read.apply(void 0, [_b.sent(), 2]), ci = _a[0], ans = _a[1];\n                      companionApp = ci;\n                      return [2\n                      /*return*/\n                      , ans];\n                  }\n                });\n              });\n            };\n\n            var apiMapRef = function (i, ty) {\n              return function (f) {\n                return __awaiter(void 0, void 0, void 0, function () {\n                  var viewMapRef;\n                  return __generator(this, function (_a) {\n                    switch (_a.label) {\n                      case 0:\n                        void ty;\n                        return [4\n                        /*yield*/\n                        , getC()];\n\n                      case 1:\n                        viewMapRef = _a.sent().viewMapRef;\n                        return [4\n                        /*yield*/\n                        , viewMapRef(i, f)];\n\n                      case 2:\n                        return [2\n                        /*return*/\n                        , _a.sent()];\n                    }\n                  });\n                });\n              };\n            };\n\n            var simTokenAccepted = function (sim_r, addr, tok) {\n              return __awaiter(void 0, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                  switch (_a.label) {\n                    case 0:\n                      simTokenAccepted_(sim_r, addr, tok);\n                      return [4\n                      /*yield*/\n                      , balanceOfMNonNet(addr, tok)];\n\n                    case 1:\n                      return [2\n                      /*return*/\n                      , _a.sent() !== false];\n                  }\n                });\n              });\n            };\n\n            var sendrecv = function (srargs) {\n              return __awaiter(void 0, void 0, void 0, function () {\n                var funcNum, evt_cnt, lct, tys, args, pay, out_tys, onlyIf, soloSend, timeoutAt, sim_p, isCtor, doRecv, funcName, dhead, trustedRecv, _a, appApproval, appClear, extraPages, Deployer_1, createRes, _b, _c, _d, _e, _f, _g, ai, ApplicationID_1, ctcInfo, _h, ApplicationID, ctcAddr, Deployer, ensureOptIn, canIWin, isIsolatedNetwork, _j, value, toks, curTime, curSecs, _k, _svs, msg, _l, _svs_tys, msg_tys, fake_res, sim_r, amt, isHalt, mapRefs, _loop_1, state_1;\n\n                return __generator(this, function (_m) {\n                  switch (_m.label) {\n                    case 0:\n                      funcNum = srargs.funcNum, evt_cnt = srargs.evt_cnt, lct = srargs.lct, tys = srargs.tys, args = srargs.args, pay = srargs.pay, out_tys = srargs.out_tys, onlyIf = srargs.onlyIf, soloSend = srargs.soloSend, timeoutAt = srargs.timeoutAt, sim_p = srargs.sim_p;\n                      isCtor = funcNum === 0;\n\n                      doRecv = function (didSend, waitIfNotPresent, msg) {\n                        return __awaiter(void 0, void 0, void 0, function () {\n                          return __generator(this, function (_a) {\n                            switch (_a.label) {\n                              case 0:\n                                debug(dhead, \"doRecv\", msg);\n\n                                if (!didSend && lct.eq(0)) {\n                                  throw new Error(\"API call failed: \".concat(msg));\n                                }\n\n                                return [4\n                                /*yield*/\n                                , recv({\n                                  funcNum: funcNum,\n                                  evt_cnt: evt_cnt,\n                                  out_tys: out_tys,\n                                  didSend: didSend,\n                                  waitIfNotPresent: waitIfNotPresent,\n                                  timeoutAt: timeoutAt\n                                })];\n\n                              case 1:\n                                return [2\n                                /*return*/\n                                , _a.sent()];\n                            }\n                          });\n                        });\n                      };\n\n                      funcName = \"m\".concat(funcNum);\n                      dhead = \"\".concat(label, \": sendrecv \").concat(funcName, \" \").concat(timeoutAt);\n                      if (!!onlyIf) return [3\n                      /*break*/\n                      , 2];\n                      return [4\n                      /*yield*/\n                      , doRecv(false, true, \"onlyIf false\")];\n\n                    case 1:\n                      return [2\n                      /*return*/\n                      , _m.sent()];\n\n                    case 2:\n                      trustedRecv = function (txn) {\n                        return __awaiter(void 0, void 0, void 0, function () {\n                          var didSend, correctStep;\n                          return __generator(this, function (_a) {\n                            switch (_a.label) {\n                              case 0:\n                                didSend = true;\n                                correctStep = makeHasLogFor(funcNum, out_tys);\n                                eq.pushIgnore(function (x) {\n                                  return correctStep(indexerTxn2RecvTxn(x));\n                                });\n                                return [4\n                                /*yield*/\n                                , recvFrom({\n                                  dhead: dhead,\n                                  out_tys: out_tys,\n                                  didSend: didSend,\n                                  funcNum: funcNum,\n                                  txn: txn\n                                })];\n\n                              case 1:\n                                return [2\n                                /*return*/\n                                , _a.sent()];\n                            }\n                          });\n                        });\n                      };\n\n                      if (!isCtor) return [3\n                      /*break*/\n                      , 5];\n                      debug(dhead, 'deploy');\n                      must_be_supported(bin);\n                      _a = bin._Connectors.ALGO, appApproval = _a.appApproval, appClear = _a.appClear, extraPages = _a.extraPages;\n                      debug(dhead, \"deploy\", {\n                        extraPages: extraPages\n                      });\n                      Deployer_1 = thisAcc.addr;\n                      _b = sign_and_send_sync;\n                      _c = ['ApplicationCreate', thisAcc];\n                      _d = toWTxn;\n                      _f = (_e = algosdk).makeApplicationCreateTxn;\n                      _g = [Deployer_1];\n                      return [4\n                      /*yield*/\n                      , getTxnParams(dhead)];\n\n                    case 3:\n                      return [4\n                      /*yield*/\n                      , _b.apply(void 0, _c.concat([_d.apply(void 0, [_f.apply(_e, _g.concat([_m.sent(), algosdk.OnApplicationComplete.NoOpOC, base64ToUI8A(appApproval), base64ToUI8A(appClear), appLocalStateNumUInt, appLocalStateNumBytes + mapDataKeys, appGlobalStateNumUInt, appGlobalStateNumBytes + stateKeys, undefined, undefined, undefined, undefined, NOTE_Reach_tag(createTag++), undefined, undefined, extraPages]))])]))];\n\n                    case 4:\n                      createRes = _m.sent();\n                      ai = createRes['created-application-index'];\n\n                      if (!ai) {\n                        throw Error(\"No created-application-index in \".concat(j2s(createRes)));\n                      }\n\n                      ApplicationID_1 = bigNumberify(ai);\n                      debug(label, \"created\", {\n                        ApplicationID: ApplicationID_1\n                      });\n                      ctcInfo = ApplicationID_1;\n                      setTrustedVerifyResult({\n                        ApplicationID: ApplicationID_1,\n                        Deployer: Deployer_1\n                      });\n                      setInfo(ctcInfo);\n                      _m.label = 5;\n\n                    case 5:\n                      return [4\n                      /*yield*/\n                      , getC()];\n\n                    case 6:\n                      _h = _m.sent(), ApplicationID = _h.ApplicationID, ctcAddr = _h.ctcAddr, Deployer = _h.Deployer, ensureOptIn = _h.ensureOptIn, canIWin = _h.canIWin, isIsolatedNetwork = _h.isIsolatedNetwork;\n                      _j = __read(pay, 2), value = _j[0], toks = _j[1];\n                      void toks; // <-- rely on simulation because of ordering\n\n                      debug(dhead, '--- START');\n                      return [4\n                      /*yield*/\n                      , getNetworkTime()];\n\n                    case 7:\n                      curTime = _m.sent();\n                      return [4\n                      /*yield*/\n                      , getTimeSecs(curTime)];\n\n                    case 8:\n                      curSecs = _m.sent();\n                      _k = __read(argsSplit(args, evt_cnt), 2), _svs = _k[0], msg = _k[1];\n                      _l = __read(argsSplit(tys, evt_cnt), 2), _svs_tys = _l[0], msg_tys = _l[1];\n                      void _svs;\n                      void _svs_tys;\n                      fake_res = {\n                        didSend: true,\n                        didTimeout: false,\n                        data: msg,\n                        time: curTime,\n                        secs: curSecs,\n                        value: value,\n                        from: pks,\n                        getOutput: function (o_mode, o_lab, o_ctc, o_val) {\n                          return __awaiter(void 0, void 0, void 0, function () {\n                            return __generator(this, function (_a) {\n                              void o_mode;\n                              void o_lab;\n                              void o_val;\n                              return [2\n                              /*return*/\n                              , o_ctc.defaultValue];\n                            });\n                          });\n                        }\n                      };\n                      return [4\n                      /*yield*/\n                      , sim_p(fake_res)];\n\n                    case 9:\n                      sim_r = _m.sent();\n                      debug(dhead, '--- SIMULATE', sim_r);\n\n                      if (isCtor) {\n                        amt = hasCompanion ? minimumBalance.mul(2) : minimumBalance;\n                        sim_r.txns.unshift({\n                          kind: 'to',\n                          amt: amt,\n                          tok: undefined\n                        });\n                      }\n\n                      isHalt = sim_r.isHalt;\n                      if (!hasMaps) return [3\n                      /*break*/\n                      , 11];\n                      return [4\n                      /*yield*/\n                      , ensureOptIn()];\n\n                    case 10:\n                      _m.sent();\n\n                      _m.label = 11;\n\n                    case 11:\n                      mapRefs = sim_r.mapRefs;\n\n                      _loop_1 = function () {\n                        var params, _o, _p, _q, mapAccts, recordAccount_, recordAccount, foreignArr, recordApp, assetsArr, recordAsset, extraFees, howManyMoreFees, txnExtraTxns, sim_i, whichApi, processRemote, processSimTxn, addCompanion, readCI, companionCalls, mapAcctsVal, assetsVal, foreignVal, actual_args, actual_tys, safe_args, whichAppl, txnAppl, rtxns, wtxns, res, e_10, jes, _r, _s;\n\n                        return __generator(this, function (_t) {\n                          switch (_t.label) {\n                            case 0:\n                              return [4\n                              /*yield*/\n                              , getTxnParams(dhead)];\n\n                            case 1:\n                              params = _t.sent(); // We add one, because the firstRound field is actually the current\n                              // round, which we couldn't possibly be in, because it already\n                              // happened.\n\n                              debug(dhead, '--- TIMECHECK', {\n                                params: params,\n                                timeoutAt: timeoutAt\n                              });\n                              return [4\n                              /*yield*/\n                              , checkTimeout(isIsolatedNetwork, getTimeSecs, timeoutAt, bigNumberify(params.firstRound).add(1))];\n\n                            case 2:\n                              if (!_t.sent()) return [3\n                              /*break*/\n                              , 4];\n                              _o = {};\n                              return [4\n                              /*yield*/\n                              , doRecv(false, false, \"timeout\")];\n\n                            case 3:\n                              return [2\n                              /*return*/\n                              , (_o.value = _t.sent(), _o)];\n\n                            case 4:\n                              _p = !soloSend;\n                              if (!_p) return [3\n                              /*break*/\n                              , 6];\n                              return [4\n                              /*yield*/\n                              , canIWin(lct)];\n\n                            case 5:\n                              _p = !_t.sent();\n                              _t.label = 6;\n\n                            case 6:\n                              if (!_p) return [3\n                              /*break*/\n                              , 8];\n                              _q = {};\n                              return [4\n                              /*yield*/\n                              , doRecv(false, false, \"cannot win \".concat(lct))];\n\n                            case 7:\n                              return [2\n                              /*return*/\n                              , (_q.value = _t.sent(), _q)];\n\n                            case 8:\n                              debug(dhead, '--- ASSEMBLE w/', params);\n                              mapAccts = [];\n\n                              recordAccount_ = function (addr) {\n                                if (addressEq(thisAcc.addr, addr)) {\n                                  return;\n                                }\n\n                                var addrIdx = mapAccts.findIndex(function (other) {\n                                  return addressEq(other, addr);\n                                });\n                                var present = addrIdx !== -1;\n\n                                if (present) {\n                                  return;\n                                }\n\n                                mapAccts.push(addr);\n                              };\n\n                              recordAccount = function (caddr) {\n                                debug(\"recordAccount\", {\n                                  caddr: caddr\n                                });\n                                var addr = cbr2algo_addr(caddr);\n                                debug(\"recordAccount\", {\n                                  addr: addr\n                                });\n                                recordAccount_(addr);\n                              };\n\n                              mapRefs.forEach(recordAccount);\n                              foreignArr = [];\n\n                              recordApp = function (app) {\n                                var appn = bigNumberToNumber(app);\n\n                                if (!foreignArr.includes(appn)) {\n                                  foreignArr.push(appn);\n                                  var addr = algosdk.getApplicationAddress(bigNumberToBigInt(app));\n                                  recordAccount_(addr);\n                                }\n                              };\n\n                              assetsArr = [];\n\n                              recordAsset = function (tok) {\n                                if (tok) {\n                                  var tokn = bigNumberToNumber(tok);\n\n                                  if (!assetsArr.includes(tokn)) {\n                                    assetsArr.push(tokn);\n                                  }\n                                }\n                              };\n\n                              extraFees = 0;\n                              howManyMoreFees = 0;\n                              txnExtraTxns = [];\n                              sim_i = 0;\n\n                              processRemote = function (dr) {\n                                dr.toks.map(recordAsset);\n                                dr.accs.map(recordAccount);\n                                dr.apps.map(recordApp);\n                                howManyMoreFees += 1 + bigNumberToNumber(dr.pays) + bigNumberToNumber(dr.bills) + bigNumberToNumber(dr.fees);\n                                return;\n                              };\n\n                              processSimTxn = function (t) {\n                                var txn;\n\n                                if (t.kind === 'contractNew') {\n                                  processSimTxn({\n                                    kind: 'to',\n                                    amt: minimumBalance_app_create(t.cns[connector]),\n                                    tok: undefined\n                                  });\n                                  processRemote(t.remote);\n                                  return;\n                                } else if (t.kind === 'tokenNew') {\n                                  processSimTxn({\n                                    kind: 'to',\n                                    amt: minimumBalance,\n                                    tok: undefined\n                                  });\n                                  howManyMoreFees++;\n                                  return;\n                                } else if (t.kind === 'tokenBurn') {\n                                  // There's no burning on Algorand\n                                  return;\n                                } else if (t.kind === 'tokenDestroy') {\n                                  recordAsset(t.tok);\n                                  howManyMoreFees++;\n                                  return;\n                                } else if (t.kind === 'tokenAccepted') {\n                                  recordAsset(t.tok);\n                                  recordAccount(t.addr);\n                                  return;\n                                } else if (t.kind === 'remote') {\n                                  recordApp(t.obj);\n                                  processRemote(t.remote);\n                                  return;\n                                } else if (t.kind === 'api') {\n                                  whichApi = t.who;\n                                  return;\n                                } else {\n                                  var tok = t.tok;\n                                  var amt = bigNumberify(0);\n                                  var from = ctcAddr;\n                                  var to = ctcAddr;\n                                  var closeTo = undefined;\n\n                                  if (t.kind === 'from') {\n                                    recordAsset(tok);\n                                    recordAccount(t.to);\n                                    howManyMoreFees++;\n                                    return;\n                                  } else if (t.kind === 'init') {\n                                    processSimTxn({\n                                      kind: 'to',\n                                      amt: minimumBalance,\n                                      tok: undefined\n                                    });\n                                    recordAsset(tok);\n                                    howManyMoreFees++;\n                                    return;\n                                  } else if (t.kind === 'halt') {\n                                    if (tok) {\n                                      recordAsset(tok);\n                                    }\n\n                                    recordAccount_(Deployer);\n                                    howManyMoreFees++;\n                                    return;\n                                  } else if (t.kind === 'to') {\n                                    from = thisAcc.addr;\n                                    to = ctcAddr;\n                                    amt = t.amt;\n                                  } else if (t.kind === 'info') {\n                                    recordAsset(tok);\n                                    return;\n                                  } else {\n                                    assert(false, 'sim txn kind');\n                                  }\n\n                                  txn = makeTransferTxn(from, to, amt, tok, params, closeTo, sim_i++);\n                                }\n\n                                extraFees += txn.fee;\n                                txn.fee = 0;\n                                txnExtraTxns.push(txn);\n                              };\n\n                              sim_r.txns.forEach(processSimTxn);\n\n                              if (hasCompanion) {\n                                if (isCtor) {\n                                  // XXX Algorand says I won't need this eventually\n                                  recordApp(bigNumberify(0));\n                                  howManyMoreFees++;\n                                }\n\n                                addCompanion = function () {\n                                  if (!isCtor) {\n                                    if (companionApp === undefined) {\n                                      throw Error('impossible: no companion yet');\n                                    }\n\n                                    recordApp(companionApp);\n                                  }\n                                };\n\n                                readCI = function (lab) {\n                                  return companionInfo[lab] || 0;\n                                };\n\n                                companionCalls = readCI(\"publish\".concat(funcNum)) + (whichApi ? readCI(\"api_\".concat(whichApi)) : 0);\n                                debug('companion', {\n                                  whichApi: whichApi,\n                                  companionCalls: companionCalls,\n                                  companionInfo: companionInfo\n                                });\n\n                                if (companionCalls > 0) {\n                                  howManyMoreFees += companionCalls;\n                                  addCompanion();\n                                }\n\n                                if (isHalt) {\n                                  addCompanion();\n                                  howManyMoreFees++;\n                                }\n                              }\n\n                              debug(dhead, 'txnExtraTxns', txnExtraTxns);\n                              debug(dhead, {\n                                howManyMoreFees: howManyMoreFees,\n                                extraFees: extraFees\n                              });\n                              extraFees += MinTxnFee * howManyMoreFees;\n                              debug(dhead, {\n                                extraFees: extraFees\n                              });\n                              debug(dhead, 'MAP', {\n                                mapAccts: mapAccts\n                              });\n\n                              if (mapAccts.length > MaxAppTxnAccounts) {\n                                throw Error(\"Application references too many local state cells in one step. Reach should catch this problem statically.\");\n                              }\n\n                              mapAcctsVal = mapAccts.length === 0 ? undefined : mapAccts;\n                              assetsVal = assetsArr.length === 0 ? undefined : assetsArr;\n                              debug(dhead, {\n                                assetsArr: assetsArr,\n                                assetsVal: assetsVal\n                              });\n                              foreignVal = foreignArr.length === 0 ? undefined : foreignArr;\n                              debug(dhead, {\n                                foreignArr: foreignArr,\n                                foreignVal: foreignVal\n                              });\n                              actual_args = [lct, msg];\n                              actual_tys = [T_UInt, T_Tuple(msg_tys)];\n                              debug(dhead, '--- ARGS =', actual_args);\n                              safe_args = actual_args.map( // @ts-ignore\n                              function (m, i) {\n                                return actual_tys[i].toNet(m);\n                              });\n                              safe_args.unshift(new Uint8Array([funcNum]));\n                              safe_args.unshift(new Uint8Array([0]));\n                              safe_args.forEach(function (x) {\n                                if (!(x instanceof Uint8Array)) {\n                                  // The types say this is impossible now,\n                                  // but we'll leave it in for a while just in case...\n                                  throw Error(\"expect safe program argument, got \".concat(j2s(x)));\n                                }\n                              });\n                              debug(dhead, '--- PREPARE:', safe_args.map(ui8h));\n                              whichAppl = isHalt ? // We are treating it like any party can delete the application, but the docs say it may only be possible for the creator. The code appears to not care: https://github.com/algorand/go-algorand/blob/0e9cc6b0c2ddc43c3cfa751d61c1321d8707c0da/ledger/apply/application.go#L589\n                              algosdk.makeApplicationDeleteTxn : algosdk.makeApplicationNoOpTxn;\n                              txnAppl = whichAppl(thisAcc.addr, params, bigNumberToNumber(ApplicationID), safe_args, mapAcctsVal, foreignVal, assetsVal, NOTE_Reach);\n                              txnAppl.fee += extraFees;\n                              rtxns = __spreadArray(__spreadArray([], __read(txnExtraTxns), false), [txnAppl], false);\n                              debug(dhead, \"assigning\", {\n                                rtxns: rtxns\n                              });\n                              algosdk.assignGroupID(rtxns);\n                              wtxns = rtxns.map(toWTxn);\n                              debug(dhead, 'signing', {\n                                wtxns: wtxns\n                              });\n                              res = void 0;\n                              _t.label = 9;\n\n                            case 9:\n                              _t.trys.push([9, 11,, 14]);\n\n                              return [4\n                              /*yield*/\n                              , signSendAndConfirm(thisAcc, wtxns)];\n\n                            case 10:\n                              res = _t.sent();\n                              return [3\n                              /*break*/\n                              , 14];\n\n                            case 11:\n                              e_10 = _t.sent();\n                              jes = j2s(e_10);\n                              debug(dhead, 'FAIL', e_10, jes);\n                              if (!!soloSend) return [3\n                              /*break*/\n                              , 13]; // If there is no soloSend, then someone else \"won\", so let's\n                              // listen for their message\n\n                              debug(dhead, 'LOST');\n                              _r = {};\n                              return [4\n                              /*yield*/\n                              , doRecv(false, false, jes)];\n\n                            case 12:\n                              return [2\n                              /*return*/\n                              , (_r.value = _t.sent(), _r)];\n\n                            case 13:\n                              if (timeoutAt) {\n                                // If there can be a timeout, then keep waiting for it\n                                debug(dhead, \"CONTINUE\");\n                                return [2\n                                /*return*/\n                                , \"continue\"];\n                              } else {\n                                // Otherwise, something bad is happening\n                                throw Error(\"\".concat(label, \" failed to call \").concat(funcName, \": \").concat(jes));\n                              }\n\n                              return [3\n                              /*break*/\n                              , 14];\n\n                            case 14:\n                              debug(dhead, 'SUCCESS', res);\n                              _s = {};\n                              return [4\n                              /*yield*/\n                              , trustedRecv(res)];\n\n                            case 15:\n                              return [2\n                              /*return*/\n                              , (_s.value = _t.sent(), _s)];\n                          }\n                        });\n                      };\n\n                      _m.label = 12;\n\n                    case 12:\n                      if (!true) return [3\n                      /*break*/\n                      , 14];\n                      return [5\n                      /*yield**/\n                      , _loop_1()];\n\n                    case 13:\n                      state_1 = _m.sent();\n                      if (typeof state_1 === \"object\") return [2\n                      /*return*/\n                      , state_1.value];\n                      return [3\n                      /*break*/\n                      , 12];\n\n                    case 14:\n                      return [2\n                      /*return*/\n                      ];\n                  }\n                });\n              });\n            };\n\n            var recvFrom = function (rfargs) {\n              return __awaiter(void 0, void 0, void 0, function () {\n                var dhead, funcNum, out_tys, didSend, txn, isCtor, ccai, theRound, theSecs, lr, ctc_args, fromAddr, from, getOutput;\n                return __generator(this, function (_a) {\n                  switch (_a.label) {\n                    case 0:\n                      dhead = rfargs.dhead, funcNum = rfargs.funcNum, out_tys = rfargs.out_tys, didSend = rfargs.didSend, txn = rfargs.txn;\n                      debug(dhead, 'txn', txn);\n\n                      if (hasCompanion) {\n                        isCtor = funcNum === 0;\n\n                        if (isCtor) {\n                          ccai = txn['created-companion-application-index'];\n\n                          if (ccai == undefined) {\n                            throw Error('impossible: no companion index');\n                          }\n\n                          companionApp = bigNumberify(ccai);\n                        }\n                      }\n\n                      theRound = txn['confirmed-round'];\n                      return [4\n                      /*yield*/\n                      , retryLoop([dhead, 'getTimeSecs'], function () {\n                        return getTimeSecs(bigNumberify(theRound));\n                      })];\n\n                    case 1:\n                      theSecs = _a.sent();\n                      lr = makeLogRep(reachEvent(funcNum), out_tys);\n                      ctc_args = lr.parse0(txn);\n                      debug(dhead, {\n                        ctc_args: ctc_args\n                      });\n\n                      if (ctc_args === undefined) {\n                        throw Error(\"impossible: txn doesn't have right log as first\");\n                      }\n\n                      fromAddr = txn['sender'];\n                      from = T_Address.canonicalize({\n                        addr: fromAddr\n                      });\n                      debug(dhead, {\n                        from: from,\n                        fromAddr: fromAddr\n                      });\n\n                      getOutput = function (o_mode, o_lab, o_ctc, o_val) {\n                        return __awaiter(void 0, void 0, void 0, function () {\n                          var f_ctc, _a, _b, l, lb, ln, ls, ld, o;\n\n                          var e_11, _c;\n\n                          return __generator(this, function (_d) {\n                            debug(\"getOutput\", {\n                              o_mode: o_mode,\n                              o_lab: o_lab,\n                              o_ctc: o_ctc,\n                              o_val: o_val\n                            });\n                            f_ctc = T_Tuple([T_UInt, o_ctc]);\n\n                            try {\n                              for (_a = __values(txn['logs']), _b = _a.next(); !_b.done; _b = _a.next()) {\n                                l = _b.value;\n                                lb = reNetify(l);\n                                ln = T_UInt.fromNet(lb);\n                                ls = \"v\".concat(ln);\n                                debug(\"getOutput\", {\n                                  l: l,\n                                  lb: lb,\n                                  ln: ln,\n                                  ls: ls\n                                });\n\n                                if (ls === o_lab) {\n                                  ld = f_ctc.fromNet(lb);\n                                  o = ld[1];\n                                  debug(\"getOutput\", {\n                                    ld: ld,\n                                    o: o\n                                  });\n                                  return [2\n                                  /*return*/\n                                  , o];\n                                }\n                              }\n                            } catch (e_11_1) {\n                              e_11 = {\n                                error: e_11_1\n                              };\n                            } finally {\n                              try {\n                                if (_b && !_b.done && (_c = _a[\"return\"])) _c.call(_a);\n                              } finally {\n                                if (e_11) throw e_11.error;\n                              }\n                            }\n\n                            throw Error(\"no log for \".concat(o_lab));\n                          });\n                        });\n                      };\n\n                      return [2\n                      /*return*/\n                      , {\n                        didSend: didSend,\n                        didTimeout: false,\n                        data: ctc_args,\n                        time: bigNumberify(theRound),\n                        secs: bigNumberify(theSecs),\n                        from: from,\n                        getOutput: getOutput\n                      }];\n                  }\n                });\n              });\n            };\n\n            var recv = function (rargs) {\n              return __awaiter(void 0, void 0, void 0, function () {\n                var funcNum, out_tys, didSend, timeoutAt, waitIfNotPresent, funcName, dhead, isIsolatedNetwork, didTimeout, res, correctStep, good, txn;\n                return __generator(this, function (_a) {\n                  switch (_a.label) {\n                    case 0:\n                      funcNum = rargs.funcNum, out_tys = rargs.out_tys, didSend = rargs.didSend, timeoutAt = rargs.timeoutAt, waitIfNotPresent = rargs.waitIfNotPresent;\n                      funcName = \"m\".concat(funcNum);\n                      dhead = \"\".concat(label, \": recv \").concat(funcName, \" \").concat(timeoutAt);\n                      debug(dhead, 'start');\n                      return [4\n                      /*yield*/\n                      , getC()];\n\n                    case 1:\n                      isIsolatedNetwork = _a.sent().isIsolatedNetwork;\n\n                      didTimeout = function (cr_bn) {\n                        return __awaiter(void 0, void 0, void 0, function () {\n                          var crp, r;\n                          return __generator(this, function (_a) {\n                            switch (_a.label) {\n                              case 0:\n                                crp = cr_bn.add(1);\n                                debug(dhead, 'TIMECHECK', {\n                                  timeoutAt: timeoutAt,\n                                  cr_bn: cr_bn,\n                                  crp: crp\n                                });\n                                return [4\n                                /*yield*/\n                                , checkTimeout(isIsolatedNetwork, getTimeSecs, timeoutAt, crp)];\n\n                              case 1:\n                                r = _a.sent();\n                                debug(dhead, 'TIMECHECK', {\n                                  r: r,\n                                  waitIfNotPresent: waitIfNotPresent\n                                });\n                                if (!(!r && waitIfNotPresent)) return [3\n                                /*break*/\n                                , 3];\n                                return [4\n                                /*yield*/\n                                , waitUntilTime(crp)];\n\n                              case 2:\n                                _a.sent();\n\n                                _a.label = 3;\n\n                              case 3:\n                                return [2\n                                /*return*/\n                                , r];\n                            }\n                          });\n                        });\n                      };\n\n                      return [4\n                      /*yield*/\n                      , eq.peq(dhead, didTimeout)];\n\n                    case 2:\n                      res = _a.sent();\n                      debug(dhead, \"res\", res);\n                      correctStep = makeHasLogFor(funcNum, out_tys);\n                      good = !res.timeout && correctStep(res.txn);\n                      if (!good) return [3\n                      /*break*/\n                      , 5];\n                      return [4\n                      /*yield*/\n                      , eq.deq(dhead)];\n\n                    case 3:\n                      _a.sent();\n\n                      txn = res.txn;\n                      return [4\n                      /*yield*/\n                      , recvFrom({\n                        dhead: dhead,\n                        out_tys: out_tys,\n                        didSend: didSend,\n                        funcNum: funcNum,\n                        txn: txn\n                      })];\n\n                    case 4:\n                      return [2\n                      /*return*/\n                      , _a.sent()];\n\n                    case 5:\n                      if (timeoutAt) {\n                        debug(dhead, \"timeout\");\n                        return [2\n                        /*return*/\n                        , {\n                          didTimeout: true\n                        }];\n                      } else {\n                        throw Error(\"\".concat(dhead, \": impossible: not good, but no timeout\"));\n                      }\n\n                      _a.label = 6;\n\n                    case 6:\n                      return [2\n                      /*return*/\n                      ];\n                  }\n                });\n              });\n            };\n\n            var getBalance = function (mtok) {\n              if (mtok === void 0) {\n                mtok = false;\n              }\n\n              return __awaiter(void 0, void 0, void 0, function () {\n                var ctcAddr, bal, result;\n                return __generator(this, function (_a) {\n                  switch (_a.label) {\n                    case 0:\n                      return [4\n                      /*yield*/\n                      , getC()];\n\n                    case 1:\n                      ctcAddr = _a.sent().ctcAddr;\n                      return [4\n                      /*yield*/\n                      , balanceOf({\n                        addr: ctcAddr\n                      }, mtok)];\n\n                    case 2:\n                      bal = _a.sent();\n                      result = bal.lt(minimumBalance) ? bigNumberify(0) : bal.sub(minimumBalance);\n                      debug(\"Balance of contract:\", result);\n                      return [2\n                      /*return*/\n                      , result];\n                  }\n                });\n              });\n            };\n\n            return {\n              getContractInfo: getContractInfo,\n              getContractAddress: getContractAddress,\n              getContractCompanion: getContractCompanion,\n              getBalance: getBalance,\n              getState: getState,\n              getCurrentStep: getCurrentStep,\n              sendrecv: sendrecv,\n              recv: recv,\n              apiMapRef: apiMapRef,\n              simTokenAccepted: simTokenAccepted\n            };\n          };\n\n          var readStateBytes = function (prefix, key, src) {\n            debug({\n              prefix: prefix,\n              key: key\n            });\n            var ik = base64ify(new Uint8Array(key));\n            debug({\n              ik: ik\n            });\n            var ste = src.find(function (x) {\n              return x.key === ik;\n            });\n            debug({\n              ste: ste\n            });\n\n            if (ste === undefined) {\n              return undefined;\n            }\n\n            ;\n            var st = ste.value;\n            debug({\n              st: st\n            });\n\n            if (st.bytes === undefined) {\n              return undefined;\n            }\n\n            ;\n            var bsi = base64ToUI8A(st.bytes);\n            debug({\n              bsi: bsi\n            });\n            return bsi;\n          };\n\n          var recoverSplitBytes = function (prefix, size, howMany, src) {\n            debug('recoverSplitBytes', {\n              prefix: prefix,\n              size: size,\n              howMany: howMany,\n              src: src\n            });\n            var bs = new Uint8Array(size);\n            var offset = 0;\n\n            for (var i = 0; i < howMany; i++) {\n              var bsi = readStateBytes(prefix, [i], src);\n\n              if (!bsi || bsi.length == 0) {\n                // We are at a state where we don't need all the keys, so they\n                // haven't all been set, bs is initialized to 0, so this should be\n                // fine.\n                return bs;\n              }\n\n              bs.set(bsi, offset);\n              offset += bsi.length;\n            }\n\n            return bs;\n          };\n\n          var setupView = function (setupViewArgs) {\n            var eq = newEventQueue();\n            var getC = makeGetC(setupViewArgs, eq);\n            var viewLib = {\n              viewMapRef: function (mapi, a) {\n                return __awaiter(void 0, void 0, void 0, function () {\n                  var viewMapRef;\n                  return __generator(this, function (_a) {\n                    switch (_a.label) {\n                      case 0:\n                        return [4\n                        /*yield*/\n                        , getC()];\n\n                      case 1:\n                        viewMapRef = _a.sent().viewMapRef;\n                        return [4\n                        /*yield*/\n                        , viewMapRef(mapi, a)];\n\n                      case 2:\n                        return [2\n                        /*return*/\n                        , _a.sent()];\n                    }\n                  });\n                });\n              }\n            };\n\n            var getView1 = function (vs, v, k, vim, isSafe) {\n              if (isSafe === void 0) {\n                isSafe = true;\n              }\n\n              return function () {\n                var args = [];\n\n                for (var _i = 0; _i < arguments.length; _i++) {\n                  args[_i] = arguments[_i];\n                }\n\n                return __awaiter(void 0, void 0, void 0, function () {\n                  var decode, ch, step, vi, vtys_1, _a, _, vvs, vres, e_12;\n\n                  return __generator(this, function (_b) {\n                    switch (_b.label) {\n                      case 0:\n                        debug('getView1', v, k, args);\n                        decode = vim.decode;\n                        return [4\n                        /*yield*/\n                        , getC()];\n\n                      case 1:\n                        ch = _b.sent();\n                        _b.label = 2;\n\n                      case 2:\n                        _b.trys.push([2, 6,, 7]);\n\n                        return [4\n                        /*yield*/\n                        , getCurrentStep_(ch)];\n\n                      case 3:\n                        step = _b.sent();\n                        vi = bigNumberToNumber(step);\n                        vtys_1 = vs[vi];\n\n                        if (!vtys_1) {\n                          throw Error(\"no views for state \".concat(step));\n                        }\n\n                        return [4\n                        /*yield*/\n                        , getState_(getC, function (_) {\n                          return vtys_1;\n                        })];\n\n                      case 4:\n                        _a = __read.apply(void 0, [_b.sent(), 2]), _ = _a[0], vvs = _a[1];\n                        return [4\n                        /*yield*/\n                        , decode(vi, vvs, args)];\n\n                      case 5:\n                        vres = _b.sent();\n                        debug({\n                          vres: vres\n                        });\n                        return [2\n                        /*return*/\n                        , isSafe ? ['Some', vres] : vres];\n\n                      case 6:\n                        e_12 = _b.sent();\n                        debug(\"getView1\", v, k, 'error', e_12);\n\n                        if (isSafe) {\n                          return [2\n                          /*return*/\n                          , ['None', null]];\n                        } else {\n                          throw Error(\"View \".concat(v, \".\").concat(k, \" is not set.\"));\n                        }\n\n                        return [3\n                        /*break*/\n                        , 7];\n\n                      case 7:\n                        return [2\n                        /*return*/\n                        ];\n                    }\n                  });\n                });\n              };\n            };\n\n            return {\n              getView1: getView1,\n              viewLib: viewLib\n            };\n          };\n\n          var setupEvents = function (setupArgs) {\n            var createEventStream = function (evt, tys) {\n              var eq = newEventQueue();\n              var getC = makeGetC(setupArgs, eq);\n\n              var getTxnTime = function (r) {\n                return bigNumberify(r['confirmed-round']);\n              };\n\n              var sync = function () {\n                return __awaiter(void 0, void 0, void 0, function () {\n                  var _a;\n\n                  return __generator(this, function (_b) {\n                    switch (_b.label) {\n                      case 0:\n                        return [4\n                        /*yield*/\n                        , getC()];\n\n                      case 1:\n                        _a = _b.sent();\n                        return [2\n                        /*return*/\n                        ];\n                    }\n                  });\n                });\n              };\n\n              var getLogs = function (r) {\n                return r['logs'];\n              };\n\n              var lr = makeLogRep(evt, tys);\n              var parseLog = lr.parse;\n              return makeEventStream({\n                eq: eq,\n                getTxnTime: getTxnTime,\n                sync: sync,\n                getNetworkTime: getNetworkTime,\n                getLogs: getLogs,\n                parseLog: parseLog\n              });\n            };\n\n            return {\n              createEventStream: createEventStream\n            };\n          };\n\n          var ABI_sigs = ABI.sigs;\n\n          var getABI = function (isFull) {\n            return {\n              sigs: isFull ? ABI_sigs : ABI_sigs.map(function (name) {\n                return {\n                  name: name\n                };\n              }).filter(stdABIFilter).map(function (_a) {\n                var name = _a.name;\n                return name;\n              })\n            };\n          };\n\n          return stdContract({\n            bin: bin,\n            getABI: getABI,\n            waitUntilTime: waitUntilTime,\n            waitUntilSecs: waitUntilSecs,\n            selfAddress: selfAddress,\n            iam: iam,\n            stdlib: stdlib,\n            setupView: setupView,\n            setupEvents: setupEvents,\n            _setup: _setup,\n            givenInfoP: givenInfoP\n          });\n        };\n\n        me_na = {\n          networkAccount: networkAccount\n        };\n\n        tokenAccepted = function (token) {\n          return __awaiter(void 0, void 0, void 0, function () {\n            var r;\n            return __generator(this, function (_a) {\n              switch (_a.label) {\n                case 0:\n                  debug(\"tokenAccepted\", token);\n                  return [4\n                  /*yield*/\n                  , balanceOfM(me_na, token)];\n\n                case 1:\n                  r = _a.sent();\n                  return [2\n                  /*return*/\n                  , r !== false];\n              }\n            });\n          });\n        };\n\n        tokenAccept = function (token) {\n          return __awaiter(void 0, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n              switch (_a.label) {\n                case 0:\n                  return [4\n                  /*yield*/\n                  , tokenAccepted(token)];\n\n                case 1:\n                  if (!!_a.sent()) return [3\n                  /*break*/\n                  , 3];\n                  debug(\"tokenAccept\", token); // @ts-ignore\n\n                  return [4\n                  /*yield*/\n                  , transfer(me_na, me_na, 0, token)];\n\n                case 2:\n                  // @ts-ignore\n                  _a.sent();\n\n                  _a.label = 3;\n\n                case 3:\n                  return [2\n                  /*return*/\n                  ];\n              }\n            });\n          });\n        };\n\n        tokenMetadata = function (token) {\n          return __awaiter(void 0, void 0, void 0, function () {\n            var tokenRes, tokenInfo, p_t, p, name, symbol, url, metadata, supply, decimals, clawback, creator, freeze, manager, reserve, defaultFrozen;\n            return __generator(this, function (_a) {\n              switch (_a.label) {\n                case 0:\n                  debug(\"tokenMetadata\", token);\n                  return [4\n                  /*yield*/\n                  , getAssetInfo(bigNumberToNumber(token))];\n\n                case 1:\n                  tokenRes = _a.sent();\n                  debug({\n                    tokenRes: tokenRes\n                  });\n                  tokenInfo = tokenRes['params'];\n                  debug({\n                    tokenInfo: tokenInfo\n                  });\n\n                  p_t = function (t, x) {\n                    return x ? t.fromNet(reNetify(x)) : undefined;\n                  };\n\n                  p = function (n, x) {\n                    return p_t(T_Bytes(n), x);\n                  };\n\n                  name = p(32, tokenInfo['name-b64']);\n                  symbol = p(8, tokenInfo['unit-name-b64']);\n                  url = p(96, tokenInfo['url-b64']);\n\n                  metadata = function () {\n                    var mh = tokenInfo['metadata-hash'];\n\n                    try {\n                      return p(32, mh);\n                    } catch (e) {\n                      debug(\"tokenMetadata metadata-hash\", \"\".concat(e));\n                      return p_t(T_Digest, mh);\n                    }\n                  }();\n\n                  supply = bigNumberify(tokenInfo['total']);\n                  decimals = bigNumberify(tokenInfo['decimals']);\n                  clawback = tokenInfo.clawback, creator = tokenInfo.creator, freeze = tokenInfo.freeze, manager = tokenInfo.manager, reserve = tokenInfo.reserve;\n                  defaultFrozen = tokenInfo['default-frozen'];\n                  return [2\n                  /*return*/\n                  , {\n                    name: name,\n                    symbol: symbol,\n                    url: url,\n                    metadata: metadata,\n                    supply: supply,\n                    decimals: decimals,\n                    clawback: clawback,\n                    creator: creator,\n                    defaultFrozen: defaultFrozen,\n                    freeze: freeze,\n                    manager: manager,\n                    reserve: reserve\n                  }];\n              }\n            });\n          });\n        };\n\n        unsupportedAcc = stdAccount_unsupported(connector);\n        accObj = __assign(__assign({}, unsupportedAcc), {\n          networkAccount: networkAccount,\n          getAddress: selfAddress,\n          stdlib: stdlib,\n          setDebugLabel: setDebugLabel,\n          tokenAccepted: tokenAccepted,\n          tokenAccept: tokenAccept,\n          tokenMetadata: tokenMetadata,\n          contract: contract\n        });\n        acc = accObj;\n\n        balanceOf_ = function (token) {\n          return balanceOf(acc, token);\n        };\n\n        balancesOf_ = function (tokens) {\n          return balancesOf(acc, tokens);\n        };\n\n        return [2\n        /*return*/\n        , stdAccount(__assign(__assign({}, accObj), {\n          balanceOf: balanceOf_,\n          balancesOf: balancesOf_\n        }))];\n      });\n    });\n  };\n\n  var minimumBalanceOf = function (acc) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var ai, createdAppCount, optinAppCount, numByteSlice, numUInt, assetCount, accMinBalance;\n\n      var _a, _b, _c, _d, _e, _f, _g;\n\n      return __generator(this, function (_h) {\n        switch (_h.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , getAccountInfo(acc)];\n\n          case 1:\n            ai = _h.sent();\n\n            if (ai.amount === BigInt(0)) {\n              return [2\n              /*return*/\n              , bigNumberify(0)];\n            }\n\n            createdAppCount = bigNumberify(((_a = ai['created-apps']) !== null && _a !== void 0 ? _a : []).length);\n            optinAppCount = bigNumberify(((_b = ai['apps-local-state']) !== null && _b !== void 0 ? _b : []).length);\n            numByteSlice = bigNumberify((_d = ((_c = ai['apps-total-schema']) !== null && _c !== void 0 ? _c : {})['num-byte-slice']) !== null && _d !== void 0 ? _d : 0);\n            numUInt = bigNumberify((_f = ((_e = ai['apps-total-schema']) !== null && _e !== void 0 ? _e : {})['num-uint']) !== null && _f !== void 0 ? _f : 0);\n            assetCount = bigNumberify(((_g = ai.assets) !== null && _g !== void 0 ? _g : []).length);\n            accMinBalance = bigNumberify(0).add(assetCount.mul(appFlatOptInMinBalance)).add(schemaMinBalancePerEntry.add(schemaUintMinBalance).mul(numUInt)).add(schemaMinBalancePerEntry.add(schemaBytesMinBalance).mul(numByteSlice)).add(appFlatParamsMinBalance.mul(createdAppCount)).add(appFlatOptInMinBalance.mul(optinAppCount)).add(minimumBalance);\n            debug(\"minBalance\", accMinBalance);\n            return [2\n            /*return*/\n            , accMinBalance];\n        }\n      });\n    });\n  };\n\n  var balancesOfM = function (acc, tokens) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var bn, tokenbs, client, query_1, accountInfoM, accountInfo_1, accountAssets_1, tokenBalances_1, indexer, addr, query, accountAssets, tokenBalances;\n\n      var _a;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            bn = bigNumberify;\n            tokenbs = tokens.map(function (tr) {\n              return tr == null ? tr : bn(tr);\n            });\n            return [4\n            /*yield*/\n            , nodeCanRead()];\n\n          case 1:\n            if (!_b.sent()) return [3\n            /*break*/\n            , 4];\n            return [4\n            /*yield*/\n            , getAlgodClient()];\n\n          case 2:\n            client = _b.sent();\n            query_1 = client.accountInformation(extractAddr(acc));\n            return [4\n            /*yield*/\n            , doQueryM_('balancesOfM', query_1)];\n\n          case 3:\n            accountInfoM = _b.sent();\n\n            if ('val' in accountInfoM) {\n              accountInfo_1 = accountInfoM['val'];\n              accountAssets_1 = (_a = accountInfo_1['assets']) !== null && _a !== void 0 ? _a : [];\n              tokenBalances_1 = tokenbs.map(function (tb) {\n                var _a;\n\n                if (tb === null) {\n                  return bn(accountInfo_1['amount']);\n                } else {\n                  var bal = (_a = accountAssets_1.find(function (asset) {\n                    return tb.eq(asset['asset-id']);\n                  })) === null || _a === void 0 ? void 0 : _a['amount'];\n                  return bal ? bn(bal) : false;\n                }\n              });\n              return [2\n              /*return*/\n              , tokenBalances_1];\n            }\n\n            _b.label = 4;\n\n          case 4:\n            return [4\n            /*yield*/\n            , getIndexer()];\n\n          case 5:\n            indexer = _b.sent();\n            addr = extractAddr(acc);\n            query = indexer.lookupAccountAssets(addr);\n            return [4\n            /*yield*/\n            , doQuery_('balancesOfM', query)];\n\n          case 6:\n            accountAssets = _b.sent()['assets'];\n            tokenBalances = tokenbs.map(function (tb) {\n              return __awaiter(void 0, void 0, void 0, function () {\n                var bal;\n\n                var _a;\n\n                return __generator(this, function (_b) {\n                  switch (_b.label) {\n                    case 0:\n                      if (!(tb === null)) return [3\n                      /*break*/\n                      , 2];\n                      return [4\n                      /*yield*/\n                      , balanceOfM(acc, tb)];\n\n                    case 1:\n                      return [2\n                      /*return*/\n                      , _b.sent()];\n\n                    case 2:\n                      bal = (_a = accountAssets.find(function (asset) {\n                        return tb.eq(asset['asset-id']);\n                      })) === null || _a === void 0 ? void 0 : _a['amount'];\n                      return [2\n                      /*return*/\n                      , bal ? bn(bal) : false];\n                  }\n                });\n              });\n            });\n            return [2\n            /*return*/\n            , Promise.all(tokenBalances)];\n        }\n      });\n    });\n  };\n\n  var balanceOfM = function (acc, token) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var dhead, addr, client, query, accountInfo, indexer, query, accountInfoM;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            dhead = 'balanceOfM';\n            addr = extractAddr(acc);\n            if (!(token == null)) return [3\n            /*break*/\n            , 8];\n            return [4\n            /*yield*/\n            , nodeCanRead()];\n\n          case 1:\n            if (!_a.sent()) return [3\n            /*break*/\n            , 4];\n            return [4\n            /*yield*/\n            , getAlgodClient()];\n\n          case 2:\n            client = _a.sent();\n            query = client.accountInformation(addr).exclude('all');\n            return [4\n            /*yield*/\n            , doQuery_(dhead, query)];\n\n          case 3:\n            accountInfo = _a.sent();\n            return [2\n            /*return*/\n            , bigNumberify(accountInfo['amount'])];\n\n          case 4:\n            return [4\n            /*yield*/\n            , getIndexer()];\n\n          case 5:\n            indexer = _a.sent();\n            query = indexer.lookupAccountByID(addr).exclude('all');\n            return [4\n            /*yield*/\n            , doQueryM_(dhead, query)];\n\n          case 6:\n            accountInfoM = _a.sent();\n\n            if ('val' in accountInfoM) {\n              return [2\n              /*return*/\n              , bigNumberify(accountInfoM['val']['account']['amount'])];\n            } else {\n              return [2\n              /*return*/\n              , false];\n            }\n\n            _a.label = 7;\n\n          case 7:\n            return [3\n            /*break*/\n            , 9];\n\n          case 8:\n            return [2\n            /*return*/\n            , balanceOfMNonNet(addr, token)];\n\n          case 9:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  var balanceOfMNonNet = function (addr, token) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var tokenId, client, query, accountAssetInfoM, assetHolding;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            tokenId = bigNumberToNumber(token);\n            return [4\n            /*yield*/\n            , getAlgodClient()];\n\n          case 1:\n            client = _a.sent();\n            query = client.accountAssetInformation(addr, tokenId);\n            return [4\n            /*yield*/\n            , doQueryM_(\"balanceOfMNonNet\", query)];\n\n          case 2:\n            accountAssetInfoM = _a.sent();\n\n            if ('val' in accountAssetInfoM) {\n              assetHolding = accountAssetInfoM['val']['asset-holding'];\n              return [2\n              /*return*/\n              , assetHolding ? bigNumberify(assetHolding['amount']) : false];\n            } else {\n              return [2\n              /*return*/\n              , false];\n            }\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  var balancesOf = function (acc, tokens) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , balancesOfM(acc, tokens)];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent().map(function (bal) {\n              return bal == false ? bigNumberify(0) : bal;\n            })];\n        }\n      });\n    });\n  };\n\n  var balanceOf = function (acc, token) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , balanceOfM(acc, token || null)];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent() || bigNumberify(0)];\n        }\n      });\n    });\n  };\n\n  var createAccount = function () {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var networkAccount;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            networkAccount = algosdk.generateAccount();\n            return [4\n            /*yield*/\n            , connectAccount(networkAccount)];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent()];\n        }\n      });\n    });\n  };\n\n  var canFundFromFaucet = function () {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var faucet, dhead, txnParams, act, exp, fbal;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , getFaucet()];\n\n          case 1:\n            faucet = _a.sent();\n            dhead = 'canFundFromFaucet';\n            debug(dhead, 'check genesis');\n            return [4\n            /*yield*/\n            , getTxnParams(dhead)];\n\n          case 2:\n            txnParams = _a.sent();\n            act = txnParams.genesisID;\n            exp = 'devnet-v1';\n\n            if (act !== exp) {\n              debug(dhead, \"expected '\".concat(exp, \"' !== actual '\").concat(act, \"'\"));\n              return [2\n              /*return*/\n              , false];\n            }\n\n            debug(dhead, 'check balance');\n            return [4\n            /*yield*/\n            , balanceOf(faucet)];\n\n          case 3:\n            fbal = _a.sent();\n            debug(dhead, \"faucet balance = \".concat(formatCurrency(fbal, 4), \" \").concat(standardUnit));\n            return [2\n            /*return*/\n            , gt(fbal, 0)];\n        }\n      });\n    });\n  };\n\n  var fundFromFaucet = function (account, value) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var faucet, tag;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , getFaucet()];\n\n          case 1:\n            faucet = _a.sent();\n            debug('fundFromFaucet');\n            tag = Math.round(Math.random() * Math.pow(2, 32));\n            return [4\n            /*yield*/\n            , transfer(faucet, account, value, undefined, tag)];\n\n          case 2:\n            _a.sent();\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  var newTestAccount = function (startingBalance) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var account;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , createAccount()];\n\n          case 1:\n            account = _a.sent();\n            return [4\n            /*yield*/\n            , fundFromFaucet(account, startingBalance)];\n\n          case 2:\n            _a.sent();\n\n            return [2\n            /*return*/\n            , account];\n        }\n      });\n    });\n  };\n\n  var newTestAccounts = make_newTestAccounts(newTestAccount).parallel;\n  /** @description the display name of the standard unit of currency for the network */\n\n  var standardUnit = 'ALGO';\n  /** @description the display name of the atomic (smallest) unit of currency for the network */\n\n  var atomicUnit = 'ALGO';\n  /**\n   * @description  Parse currency by network\n   * @param amt  value in the {@link standardUnit} for the token.\n   * @param {number} [decimals] how many \"decimal places\" the target currency has. Defaults to the network standard.\n   * @returns  the amount in the {@link atomicUnit} of the token.\n   * @example  parseCurrency(100).toString() // => '100000000'\n   * @example  parseCurrency(100, 3).toString() // => '100000'\n   */\n\n  var parseCurrency = makeParseCurrency(6);\n  var minimumBalance = bigNumberify(MinBalance);\n  var schemaMinBalancePerEntry = bigNumberify(SchemaMinBalancePerEntry);\n  var schemaBytesMinBalance = bigNumberify(SchemaBytesMinBalance);\n  var schemaUintMinBalance = bigNumberify(SchemaUintMinBalance);\n  var appFlatParamsMinBalance = bigNumberify(AppFlatParamsMinBalance);\n  var appFlatOptInMinBalance = bigNumberify(AppFlatOptInMinBalance);\n\n  var minimumBalance_app_create = function (cns) {\n    var code = cns.code,\n        opts = cns.opts;\n    var approval = code.approval,\n        clearState = code.clearState;\n    var totalLen = approval.length + clearState.length;\n    var ai_ExtraProgramPages = Math.ceil(totalLen / MaxAppProgramLen) - 1;\n    var ai_GlobalNumByteSlice = opts.globalBytes,\n        ai_GlobalNumUint = opts.globalUints;\n    return bigNumberify(100000 * (1 + ai_ExtraProgramPages) + (25000 + 3500) * ai_GlobalNumUint + (25000 + 25000) * ai_GlobalNumByteSlice);\n  };\n  /**\n   * @description  Format currency by network\n   */\n\n\n  function formatCurrency(amt, decimals) {\n    if (decimals === void 0) {\n      decimals = 6;\n    }\n\n    return handleFormat(amt, decimals, 6);\n  }\n\n  function getDefaultAccount() {\n    return __awaiter(this, void 0, void 0, function () {\n      var addr;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , getProvider()];\n\n          case 1:\n            return [4\n            /*yield*/\n            , _a.sent().getDefaultAddress()];\n\n          case 2:\n            addr = _a.sent();\n            return [4\n            /*yield*/\n            , connectAccount({\n              addr: addr\n            })];\n\n          case 3:\n            return [2\n            /*return*/\n            , _a.sent()];\n        }\n      });\n    });\n  }\n  /**\n   * @param mnemonic 25 words, space-separated\n   */\n\n\n  var newAccountFromMnemonic = function (mnemonic) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , connectAccount(algosdk.mnemonicToSecretKey(mnemonic))];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent()];\n        }\n      });\n    });\n  };\n  /**\n   * @param secret a Uint8Array, or its hex string representation\n   */\n\n\n  var newAccountFromSecret = function (secret) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var sk, mnemonic;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            sk = ethers.utils.arrayify(secret);\n            mnemonic = algosdk.secretKeyToMnemonic(sk);\n            return [4\n            /*yield*/\n            , newAccountFromMnemonic(mnemonic)];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent()];\n        }\n      });\n    });\n  };\n\n  var getNetworkTime = function () {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var indexer, hc;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , getIndexer()];\n\n          case 1:\n            indexer = _a.sent();\n            return [4\n            /*yield*/\n            , indexer.makeHealthCheck()[\"do\"]()];\n\n          case 2:\n            hc = _a.sent();\n            return [2\n            /*return*/\n            , bigNumberify(hc['round'])];\n        }\n      });\n    });\n  };\n\n  var getTimeSecs = function (now_bn) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var now, client, binfo, e_13, indexer, info;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            now = bigNumberToNumber(now_bn);\n            _a.label = 1;\n\n          case 1:\n            _a.trys.push([1, 5,, 8]);\n\n            return [4\n            /*yield*/\n            , ensureNodeCanRead()];\n\n          case 2:\n            _a.sent();\n\n            return [4\n            /*yield*/\n            , getAlgodClient()];\n\n          case 3:\n            client = _a.sent();\n            return [4\n            /*yield*/\n            , client.block(now)[\"do\"]()];\n\n          case 4:\n            binfo = _a.sent(); //debug(`getTimeSecs`, `node`, binfo);\n\n            return [2\n            /*return*/\n            , bigNumberify(binfo.block.ts)];\n\n          case 5:\n            e_13 = _a.sent();\n            debug(\"getTimeSecs\", \"node failed\", e_13);\n            return [4\n            /*yield*/\n            , getIndexer()];\n\n          case 6:\n            indexer = _a.sent();\n            return [4\n            /*yield*/\n            , indexer.lookupBlock(now)[\"do\"]()];\n\n          case 7:\n            info = _a.sent();\n            debug(\"getTimeSecs\", \"indexer\", info);\n            return [2\n            /*return*/\n            , bigNumberify(info['timestamp'])];\n\n          case 8:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  var getNetworkSecs = function () {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var _a;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            _a = getTimeSecs;\n            return [4\n            /*yield*/\n            , getNetworkTime()];\n\n          case 1:\n            return [4\n            /*yield*/\n            , _a.apply(void 0, [_b.sent()])];\n\n          case 2:\n            return [2\n            /*return*/\n            , _b.sent()];\n        }\n      });\n    });\n  };\n\n  var stepTime = function (target) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var now, _a;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            if (!true) return [3\n            /*break*/\n            , 8];\n            return [4\n            /*yield*/\n            , getNetworkTime()];\n\n          case 1:\n            now = _b.sent();\n            debug(\"stepTime\", {\n              target: target,\n              now: now\n            });\n\n            if (target.lte(now)) {\n              return [2\n              /*return*/\n              , now];\n            }\n\n            return [4\n            /*yield*/\n            , getProvider()];\n\n          case 2:\n            if (!_b.sent().isIsolatedNetwork) return [3\n            /*break*/\n            , 5];\n            _a = fundFromFaucet;\n            return [4\n            /*yield*/\n            , getFaucet()];\n\n          case 3:\n            return [4\n            /*yield*/\n            , _a.apply(void 0, [_b.sent(), 0])];\n\n          case 4:\n            _b.sent();\n\n            return [3\n            /*break*/\n            , 7];\n\n          case 5:\n            return [4\n            /*yield*/\n            , stdWait()];\n\n          case 6:\n            _b.sent();\n\n            _b.label = 7;\n\n          case 7:\n            return [3\n            /*break*/\n            , 0];\n\n          case 8:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  var waitUntilTime = make_waitUntilX('time', getNetworkTime, stepTime);\n\n  var stepSecs = function (target) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var now, _a;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            void target;\n            _a = stepTime;\n            return [4\n            /*yield*/\n            , getNetworkTime()];\n\n          case 1:\n            return [4\n            /*yield*/\n            , _a.apply(void 0, [_b.sent().add(1)])];\n\n          case 2:\n            now = _b.sent();\n            return [4\n            /*yield*/\n            , getTimeSecs(now)];\n\n          case 3:\n            return [2\n            /*return*/\n            , _b.sent()];\n        }\n      });\n    });\n  };\n\n  var waitUntilSecs = make_waitUntilX('secs', getNetworkSecs, stepSecs);\n\n  var wait = function (delta, onProgress) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var now;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , getNetworkTime()];\n\n          case 1:\n            now = _a.sent();\n            return [4\n            /*yield*/\n            , waitUntilTime(now.add(delta), onProgress)];\n\n          case 2:\n            return [2\n            /*return*/\n            , _a.sent()];\n        }\n      });\n    });\n  };\n\n  var appLocalStateNumUInt = 0;\n  var appLocalStateNumBytes = 0;\n  var appGlobalStateNumUInt = 0;\n  var appGlobalStateNumBytes = 1;\n\n  var verifyContract = function (info, bin) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2\n        /*return*/\n        , verifyContract_('', info, bin, newEventQueue())];\n      });\n    });\n  };\n\n  var verifyContract_ = function (label, info, bin, eq) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var ApplicationID, _a, appApproval, appClear, mapDataKeys, stateKeys, dhead, chk, chkeq_x, chkeq_bn_, chkeq_bn, chkeq_bs, appInfoM, appInfo, appInfo_p, Deployer, appInfo_LocalState, appInfo_GlobalState, iat, allocRound;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            must_be_supported(bin);\n            ApplicationID = protect(T_Contract, info);\n            _a = bin._Connectors.ALGO, appApproval = _a.appApproval, appClear = _a.appClear, mapDataKeys = _a.mapDataKeys, stateKeys = _a.stateKeys;\n            dhead = \"\".concat(label, \": verifyContract\");\n\n            chk = function (p, msg) {\n              if (!p) {\n                throw Error(\"\".concat(dhead, \" failed: \").concat(msg));\n              }\n            };\n\n            chkeq_x = function (cmp) {\n              return function (a, e, msg) {\n                var as = j2sf(a);\n                var es = j2sf(e);\n                chk(cmp(a, e), \"\".concat(msg, \": expected \").concat(es, \", got \").concat(as));\n              };\n            };\n\n            chkeq_bn_ = chkeq_x(function (a, b) {\n              return a.eq(b);\n            });\n\n            chkeq_bn = function (a, b, msg) {\n              return chkeq_bn_(bigNumberify(a), bigNumberify(b), msg);\n            };\n\n            chkeq_bs = chkeq_x(function (a, b) {\n              return j2sf(a) === j2sf(b);\n            });\n            return [4\n            /*yield*/\n            , getApplicationInfoM(ApplicationID)];\n\n          case 1:\n            appInfoM = _b.sent();\n\n            if ('exn' in appInfoM) {\n              throw Error(\"\".concat(dhead, \" failed: failed to lookup application (\").concat(ApplicationID, \"): \").concat(j2s(appInfoM.exn)));\n            }\n\n            appInfo = appInfoM.val;\n            appInfo_p = appInfo['params'];\n            debug(dhead, {\n              appInfo_wanted: bin._Connectors.ALGO\n            });\n            debug(dhead, {\n              appInfo_p: appInfo_p\n            });\n            chk(appInfo_p !== undefined, \"Cannot lookup ApplicationId\");\n            chkeq_bs(appInfo_p['approval-program'], appApproval, \"Approval program does not match Reach backend\");\n            chkeq_bs(appInfo_p['clear-state-program'], appClear, \"ClearState program does not match Reach backend\");\n            Deployer = appInfo_p['creator'];\n            appInfo_LocalState = appInfo_p['local-state-schema'];\n            chkeq_bn(appInfo_LocalState['num-byte-slice'], appLocalStateNumBytes + mapDataKeys, \"Num of byte-slices in local state schema does not match Reach backend\");\n            chkeq_bn(appInfo_LocalState['num-uint'], appLocalStateNumUInt, \"Num of uints in local state schema does not match Reach backend\");\n            appInfo_GlobalState = appInfo_p['global-state-schema'];\n            chkeq_bn(appInfo_GlobalState['num-byte-slice'], appGlobalStateNumBytes + stateKeys, \"Num of byte-slices in global state schema does not match Reach backend\");\n            chkeq_bn(appInfo_GlobalState['num-uint'], appGlobalStateNumUInt, \"Num of uints in global state schema does not match Reach backend\");\n            eq.init({\n              ApplicationID: ApplicationID\n            });\n            return [4\n            /*yield*/\n            , eq.deq(dhead, 1)];\n\n          case 2:\n            iat = _b.sent();\n            debug({\n              iat: iat\n            });\n            chkeq_bn(iat['created-application-index'], ApplicationID, 'app created');\n            chkeq_bn(iat['application-index'], 0, 'app created');\n            allocRound = appInfo['created-at-round'];\n\n            if (allocRound) {\n              chkeq_bn(iat['confirmed-round'], allocRound, 'created on correct round');\n            }\n\n            chkeq_bs(iat['approval-program'], appInfo_p['approval-program'], \"ApprovalProgram unchanged since creation\");\n            chkeq_bs(iat['clear-state-program'], appInfo_p['clear-state-program'], \"ClearStateProgram unchanged since creation\");\n            return [2\n            /*return*/\n            , {\n              ApplicationID: ApplicationID,\n              Deployer: Deployer\n            }];\n        }\n      });\n    });\n  };\n  /**\n   * Formats an account's address in the way users expect to see it.\n   * @param acc Account, NetworkAccount, base32-encoded address, or hex-encoded address\n   * @returns the address formatted as a base32-encoded string with checksum\n   */\n\n\n  function formatAddress(acc) {\n    return addressFromHex(T_Address.canonicalize(acc));\n  }\n\n  function unsafeGetMnemonic(acc) {\n    // @ts-ignore\n    var networkAccount = acc.networkAccount || acc;\n\n    if (!networkAccount.sk) {\n      throw Error(\"unsafeGetMnemonic: Secret key not accessible for account\");\n    }\n\n    return algosdk.secretKeyToMnemonic(networkAccount.sk);\n  }\n\n  var launchToken = function (accCreator, name, sym, opts) {\n    if (opts === void 0) {\n      opts = {};\n    }\n\n    return __awaiter(void 0, void 0, void 0, function () {\n      var addrCreator, supply, decimals, url, assetMetadataHash, f_addr, clawback, freeze, reserve, note, defaultFrozen, suggestedParams, txnResult, assetIndex, id, mint, optOut;\n\n      var _a, _b, _c, _d;\n\n      return __generator(this, function (_e) {\n        switch (_e.label) {\n          case 0:\n            addrCreator = accCreator.networkAccount.addr;\n            supply = opts.supply ? bigNumberify(opts.supply) : bigNumberify(2).pow(64).sub(1);\n            decimals = (_a = opts.decimals) !== null && _a !== void 0 ? _a : 6;\n            url = (_b = opts.url) !== null && _b !== void 0 ? _b : '';\n            assetMetadataHash = (_c = opts.metadataHash) !== null && _c !== void 0 ? _c : '';\n\n            f_addr = function (x) {\n              return x ? cbr2algo_addr(protect(T_Address, x)) : undefined;\n            };\n\n            clawback = f_addr(opts.clawback);\n            freeze = f_addr(opts.freeze);\n            reserve = f_addr(opts.reserve);\n            note = opts.note || undefined;\n            defaultFrozen = (_d = opts.defaultFrozen) !== null && _d !== void 0 ? _d : false;\n            return [4\n            /*yield*/\n            , getTxnParams('launchToken')];\n\n          case 1:\n            suggestedParams = _e.sent();\n            return [4\n            /*yield*/\n            , sign_and_send_sync(\"launchToken \".concat(j2s(accCreator), \" \").concat(name, \" \").concat(sym), accCreator.networkAccount, toWTxn(algosdk.makeAssetCreateTxnWithSuggestedParamsFromObject({\n              assetMetadataHash: assetMetadataHash,\n              assetName: name,\n              assetURL: url,\n              clawback: clawback,\n              decimals: decimals,\n              defaultFrozen: defaultFrozen,\n              freeze: freeze,\n              note: note,\n              reserve: reserve,\n              suggestedParams: suggestedParams,\n              total: bigNumberToBigInt(supply),\n              unitName: sym,\n              from: addrCreator\n            })))];\n\n          case 2:\n            txnResult = _e.sent();\n            assetIndex = txnResult['created-asset-index'];\n            if (!assetIndex) throw Error(\"\".concat(sym, \" no asset-index!\"));\n            id = bigNumberify(assetIndex);\n\n            mint = function (accTo, amt) {\n              return transfer(accCreator, accTo, amt, id);\n            };\n\n            optOut = function (accFrom, accTo) {\n              if (accTo === void 0) {\n                accTo = accCreator;\n              }\n\n              return __awaiter(void 0, void 0, void 0, function () {\n                var addrFrom, addrTo, params, optOutTxn;\n                return __generator(this, function (_a) {\n                  switch (_a.label) {\n                    case 0:\n                      addrFrom = accFrom.networkAccount.addr;\n                      addrTo = accTo.networkAccount.addr;\n                      return [4\n                      /*yield*/\n                      , getTxnParams('token.optOut')];\n\n                    case 1:\n                      params = _a.sent();\n                      optOutTxn = makeTransferTxn(addrFrom, addrTo, bigNumberify(0), id, params, addrTo);\n                      return [4\n                      /*yield*/\n                      , sign_and_send_sync(\"token.optOut \".concat(j2s(accFrom), \" \").concat(name), accFrom.networkAccount, toWTxn(optOutTxn))];\n\n                    case 2:\n                      _a.sent();\n\n                      return [2\n                      /*return*/\n                      ];\n                  }\n                });\n              });\n            };\n\n            return [2\n            /*return*/\n            , {\n              name: name,\n              sym: sym,\n              id: id,\n              mint: mint,\n              optOut: optOut\n            }];\n        }\n      });\n    });\n  };\n\n  return __assign(__assign(__assign(__assign(__assign({}, stdlib), typeDefs), shared_user), {\n    setQueryLowerBound: setQueryLowerBound,\n    getQueryLowerBound: getQueryLowerBound,\n    addressFromHex: addressFromHex,\n    formatWithDecimals: formatWithDecimals,\n    setSigningMonitor: setSigningMonitor\n  }), {\n    setCustomHttpEventHandler: setCustomHttpEventHandler,\n    setMinMillisBetweenRequests: setMinMillisBetweenRequests,\n    signSendAndConfirm: signSendAndConfirm,\n    toWTxn: toWTxn,\n    getTxnParams: getTxnParams,\n    MinTxnFee: MinTxnFee,\n    makeTransferTxn: makeTransferTxn,\n    getValidQueryWindow: getValidQueryWindow,\n    setValidQueryWindow: setValidQueryWindow,\n    randomUInt: randomUInt,\n    hasRandom: hasRandom,\n    setWalletFallback: setWalletFallback,\n    walletFallback: walletFallback,\n    getProvider: getProvider,\n    setProvider: setProvider,\n    setProviderByEnv: setProviderByEnv,\n    setProviderByName: setProviderByName,\n    getFaucet: getFaucet,\n    setFaucet: setFaucet,\n    canFundFromFaucet: canFundFromFaucet,\n    fundFromFaucet: fundFromFaucet,\n    providerEnvByName: providerEnvByName,\n    transfer: transfer,\n    connectAccount: connectAccount,\n    minimumBalanceOf: minimumBalanceOf,\n    balancesOf: balancesOf,\n    balanceOf: balanceOf,\n    createAccount: createAccount,\n    newTestAccount: newTestAccount,\n    newTestAccounts: newTestAccounts,\n    getDefaultAccount: getDefaultAccount,\n    newAccountFromMnemonic: newAccountFromMnemonic,\n    newAccountFromSecret: newAccountFromSecret,\n    getNetworkTime: getNetworkTime,\n    getTimeSecs: getTimeSecs,\n    getNetworkSecs: getNetworkSecs,\n    waitUntilTime: waitUntilTime,\n    waitUntilSecs: waitUntilSecs,\n    wait: wait,\n    verifyContract: verifyContract,\n    formatAddress: formatAddress,\n    unsafeGetMnemonic: unsafeGetMnemonic,\n    launchToken: launchToken,\n    parseCurrency: parseCurrency,\n    minimumBalance: minimumBalance,\n    formatCurrency: formatCurrency,\n    reachStdlib: reachStdlib,\n    algosdk: algosdk,\n    connector: connector,\n    standardUnit: standardUnit,\n    atomicUnit: atomicUnit\n  });\n};","map":{"version":3,"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","Symbol","iterator","v","op","TypeError","pop","push","__read","o","m","r","ar","error","__values","__spreadArray","to","from","pack","l","Array","slice","concat","algosdk","ethers","Timeout","buffer","RHC","UTBC","Buffer","VERSION","apiStateMismatchError","stdContract","stdVerifyContract","stdABIFilter","stdAccount","stdAccount_unsupported","debug","envDefault","argsSplit","makeRandom","replaceableThunk","ensureConnectorAvailable","make_newTestAccounts","make_waitUntilX","checkTimeout","truthyEnv","Lock","retryLoop","makeEventQueue","makeEventStream","makeSigningMonitor","j2sf","j2s","hideWarnings","hasProp","makeParseCurrency","bigNumberify","bigNumberToNumber","bigNumberToBigInt","waitPort","addressFromHex","stdlib","typeDefs","extractAddr","bytestringyNet","simTokenAccepted_","window","process","sha512_256","shared_user","shared_impl","defaultALGO_TOKEN_HEADER","defaultALGO_INDEXER_TOKEN_HEADER","reachBackendVersion","reachAlgoBackendVersion","load","connector","reachStdlib","setQueryLowerBound","getQueryLowerBound","formatWithDecimals","handleFormat","_a","setSigningMonitor","notifySend","customHttpEventHandler","undefined","setCustomHttpEventHandler","h","minMillisBetweenRequests","setMinMillisBetweenRequests","reqLock","currentReqNum","currentReqLabel","lastReqSentAt","appStateMinRefreshMillis","httpEventHandler","en","waitMs","eventName","acquire","Math","max","Date","now","set","reqNum","release","Error","cbr2algo_addr","x","encodeAddress","txnFromAddress","publicKey","uint8ArrayToStr","a","enc","Uint8Array","console","log","toString","rawDefaultToken","rawDefaultItoken","indexerTxn2RecvTxn","txn","ait","aargs","aidx","ccai","e_1","its","its_1","its_1_1","itx","e_1_1","waitForConfirmation","txId","doOrDie","dhead","client","checkAlgod","checkIndexer","e_2","_b","val","getAlgodClient","q","infoM","info","cr","dtxn","uToS","pendingTransactionInformation","Transaction","from_obj_for_encoding","map","e_3","its_2","its_2_1","e_3_1","appArgs","indexer","res","getIndexer","lookupTransactionByID","doQuery_","nodeCanRead","decodeB64Txn","ts","tb","decodeUnsignedTransaction","doSignTxnToB64","sk","sb","signTxn","doSignTxn","signSendAndConfirm","acc","txns","sapt_res","notifyComplete","e_4","es","N","tN","e_5","forEach","stxn","signers","addr","getProvider","signAndPostTxns","response","text","request","req","type","txID","encodeUnsignedTransaction","toWTxn","stdWait","getTxnParams","params_r","bi2n","params","getTransactionParams","fee","firstRound","lastRound","sign_and_send_sync","e_6","replaceAll","orig","what","whatp","once","replace","must_be_supported","bin","algob","_Connectors","ALGO","unsupported","warnings","render","join","MinTxnFee","MaxAppTxnAccounts","MinBalance","MaxAppProgramLen","SchemaMinBalancePerEntry","SchemaBytesMinBalance","SchemaUintMinBalance","AppFlatParamsMinBalance","AppFlatOptInMinBalance","ui8h","base64ToUI8A","base64ify","looksLikeAccountingNotInitialized","responseText","msg","toLowerCase","includes","doQueryM_","query","exn_1","exn","howMany","failOk","fr","errno","code","getValidQueryWindow","setValidQueryWindow","isCreateTxn","at","eq","emptyOptIn","ataa","apiOnly","ls","l0","l0ui","l0h","subarray","newEventQueue","getTxns","initArgs","ctime","limsug","ApplicationID","mtime","appn","walkTxns","gtime","add","searchForTransactions","applicationID","minRound","limit","ints","filter","ai","cai","transactions","getTxnTime","raw2proc","alwaysIgnored","addressEq","assert","gt","protect","T_UInt","T_Tuple","T_Contract","T_Bytes","T_Address","T_Digest","randomUInt","hasRandom","waitIndexerFromEnv","env","ALGO_INDEXER_SERVER","ALGO_INDEXER_PORT","ALGO_INDEXER_TOKEN","ALGO_INDEXER_TOKEN_HEADER","port","utbc","rhc","URLTokenBaseHTTPClient","ReachHTTPClient","Indexer","waitAlgodClientFromEnv","ALGO_SERVER","ALGO_PORT","ALGO_TOKEN","ALGO_TOKEN_HEADER","Algodv2","makeProviderByWallet","wallet","defaults","allEnv","ALGO_GENESIS_ID","ALGO_GENESIS_HASH","ALGO_ACCOUNT","REACH_ISOLATED_NETWORK","ALGO_NODE_WRITE_ONLY","walletOpts","isIsolatedNetwork","nodeWriteOnly","enabledNetwork","enabledAccounts","enabled","algod_bc","indexer_bc","algodClient","getDefaultAddress","_env","genesisID","genesisHash","accounts","enableNetwork","enableAccounts","enable","getAlgodv2Client","getIndexerClient","setWalletFallback","wf","algorand","checkNetwork","ret","eopts","id","eid","eh","checkAccounts","got","JSON","stringify","doWalletFallback_signOnly","opts","getAddr","signTxns_","disconnect_","base","providerEnvByName","provider","makeProviderByEnv","nres","ares","signTxns","sopts","to_sign","signed","stxns","shift","postTxns","popts","bs","sendRawTransaction","spopts","disconnect","walletFallback_mnemonic","prompt","mn","mnemonicToSecretKey","walletFallback_MyAlgoWallet","MyAlgoConnect","mac","lock","accts","runWith","connect","shouldSelectOneAccount","address","signTransaction","sts","blob","walletFallback_WalletConnect","WalletConnect","wc","WalletConnect_wc","walletFallback","_c","setProvider","c","setIntEncoding","IntDecoding","BIGINT","ensureNodeCanRead","localhostProviderEnv","envDefaultsALGO","e_7","denv","e_7_1","fullEnv","errmsg","_this","setProviderByEnv","algonodeEnv","net","prefix","suffix","randlabsProviderEnv","RANDLABS_BASE","pn","setProviderByName","rawFaucetDefaultMnemonic","_d","FAUCET","ALGO_FAUCET_PASSPHRASE","connectAccount","getFaucet","setFaucet","str2note","NOTE_Reach_str","NOTE_Reach","NOTE_Reach_tag","tag","makeTransferTxn","token","ps","closeTo","valuen","note","makeAssetTransferTxnWithSuggestedParams","makePaymentTxnWithSuggestedParams","transfer","sender","receiver","valuebn","networkAccount","makeLogRep","evt","tys","hLen","tyns","ty","netName","sig","hu","hp","trunc","parse","fromNet","reNetify","logb","pd","parse0","logs","parse0b","reachEvent","makeHasLogFor","lr","utils","arrayify","getAccountInfo","getAddressInfo","res_1","e_8","accountInformation","BigInt","lookupAccountByID","account","getAssetInfo","lookupAssetByID","asset","getApplicationInfoM","idn","e_9","queryRes","getApplicationByID","lookupApplications","includeAll","application","deleted","getDeletedApplicationInfoM","appTxn","setDebugLabel","newLabel","pks","thisAcc","createTag","selfAddress","iam","contract","me_na","tokenAccepted","tokenAccept","tokenMetadata","unsupportedAcc","accObj","balanceOf_","balancesOf_","substring","canonicalize","some_addr","givenInfoP","stateSize","stateKeys","mapDataKeys","mapDataSize","ABI","companionInfo","hasCompanion","hasMaps","mapDataTy","_getMaps","emptyMapDataTy","netSize","emptyMapData","toNet","makeGetC","setupViewArgs","getInfo","_theC","ctcInfo","Deployer","ctcAddr","getLocalState","didOptIn","doOptIn","ensuredOptIn","ensureOptIn","lastAppState","lastAppStateTime","getAppState","getAppStateFresh","getGlobalState","canIWin","isin","viewMapRef","verifyContract_","isInited","init","pushIgnore","getApplicationAddress","accAppInfo","appLocalStatesRes","appsLocalStates","appLocalState","accountApplicationInformation","lookupAccountAppLocalStates","find","app","_e","_f","_g","makeApplicationOptInTxn","minMillis","lab","appInfoM","appInfo","appSt","appSt_g","gsbs","mCompanion","gty","readStateBytes","lct","gs","mapi","mbs","md","mr","recoverSplitBytes","getCurrentStep_","ch","getState_","getC","lookup","vvn","vi","vtys","vty","vvs","_setup","setupArgs","setInfo","setTrustedVerifyResult","companionApp","getContractAddress","getContractInfo","getContractCompanion","getCurrentStep","getState","vibne","ci","ans","vibna","apiMapRef","simTokenAccepted","sim_r","tok","balanceOfMNonNet","sendrecv","srargs","funcNum","evt_cnt","args","pay","out_tys","onlyIf","soloSend","timeoutAt","sim_p","isCtor","doRecv","funcName","trustedRecv","appApproval","appClear","extraPages","Deployer_1","createRes","ApplicationID_1","_h","_j","toks","curTime","curSecs","_k","_svs","_l","_svs_tys","msg_tys","fake_res","amt","isHalt","mapRefs","_loop_1","state_1","_m","didSend","waitIfNotPresent","recv","correctStep","recvFrom","makeApplicationCreateTxn","OnApplicationComplete","NoOpOC","appLocalStateNumUInt","appLocalStateNumBytes","appGlobalStateNumUInt","appGlobalStateNumBytes","getNetworkTime","getTimeSecs","didTimeout","data","time","secs","getOutput","o_mode","o_lab","o_ctc","o_val","defaultValue","minimumBalance","mul","unshift","kind","_o","_p","_q","mapAccts","recordAccount_","recordAccount","foreignArr","recordApp","assetsArr","recordAsset","extraFees","howManyMoreFees","txnExtraTxns","sim_i","whichApi","processRemote","processSimTxn","addCompanion","readCI","companionCalls","mapAcctsVal","assetsVal","foreignVal","actual_args","actual_tys","safe_args","whichAppl","txnAppl","rtxns","wtxns","e_10","jes","_r","_s","_t","addrIdx","findIndex","other","present","caddr","tokn","dr","accs","apps","pays","bills","fees","minimumBalance_app_create","cns","remote","obj","who","makeApplicationDeleteTxn","makeApplicationNoOpTxn","assignGroupID","rfargs","theRound","theSecs","ctc_args","fromAddr","f_ctc","lb","ln","ld","e_11","e_11_1","rargs","good","cr_bn","crp","waitUntilTime","peq","timeout","deq","getBalance","mtok","bal","balanceOf","lt","sub","key","src","ik","ste","st","bytes","bsi","size","offset","setupView","viewLib","getView1","vs","k","vim","isSafe","_i","decode","vtys_1","vres","e_12","setupEvents","createEventStream","sync","getLogs","parseLog","ABI_sigs","sigs","getABI","isFull","name","waitUntilSecs","balanceOfM","tokenRes","tokenInfo","p_t","symbol","url","metadata","supply","decimals","clawback","creator","freeze","manager","reserve","defaultFrozen","mh","getAddress","tokens","balancesOf","minimumBalanceOf","createdAppCount","optinAppCount","numByteSlice","numUInt","assetCount","accMinBalance","amount","assets","appFlatOptInMinBalance","schemaMinBalancePerEntry","schemaUintMinBalance","schemaBytesMinBalance","appFlatParamsMinBalance","balancesOfM","bn","tokenbs","query_1","accountInfoM","accountInfo_1","accountAssets_1","tokenBalances_1","accountAssets","tokenBalances","tr","lookupAccountAssets","all","accountInfo","exclude","tokenId","accountAssetInfoM","assetHolding","accountAssetInformation","createAccount","generateAccount","canFundFromFaucet","faucet","txnParams","act","exp","fbal","formatCurrency","standardUnit","fundFromFaucet","round","random","pow","newTestAccount","startingBalance","newTestAccounts","parallel","atomicUnit","parseCurrency","approval","clearState","totalLen","ai_ExtraProgramPages","ceil","ai_GlobalNumByteSlice","globalBytes","ai_GlobalNumUint","globalUints","getDefaultAccount","newAccountFromMnemonic","mnemonic","newAccountFromSecret","secret","secretKeyToMnemonic","hc","makeHealthCheck","now_bn","binfo","e_13","block","lookupBlock","getNetworkSecs","stepTime","target","lte","stepSecs","wait","delta","onProgress","verifyContract","chk","chkeq_x","chkeq_bn_","chkeq_bn","chkeq_bs","appInfo_p","appInfo_LocalState","appInfo_GlobalState","iat","allocRound","cmp","as","b","appInfo_wanted","formatAddress","unsafeGetMnemonic","launchToken","accCreator","sym","addrCreator","assetMetadataHash","f_addr","suggestedParams","txnResult","assetIndex","mint","optOut","metadataHash","makeAssetCreateTxnWithSuggestedParamsFromObject","assetName","assetURL","total","unitName","accTo","accFrom","addrFrom","addrTo","optOutTxn"],"sources":["/Users/david/reach/morra/morraUI/node_modules/@reach-sh/stdlib/ALGO.mjs"],"sourcesContent":["var __assign = (this && this.__assign) || function() {\n  __assign = Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s)\n        if (Object.prototype.hasOwnProperty.call(s, p))\n          t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function(resolve) { resolve(value); }); }\n  return new(P || (P = Promise))(function(resolve, reject) {\n    function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n\n    function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n\n    function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = (this && this.__generator) || function(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] },\n    f, y, t, g;\n  return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n\n  function verb(n) { return function(v) { return step([n, v]); }; }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return { value: op[1], done: false };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n          if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n          if (op[0] === 6 && _.label < t[1]) { _.label = t[1];\n            t = op; break; }\n          if (t && _.label < t[2]) { _.label = t[2];\n            _.ops.push(op); break; }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) { op = [6, e];\n      y = 0; } finally { f = t = 0; }\n    if (op[0] & 5) throw op[1];\n    return { value: op[0] ? op[1] : void 0, done: true };\n  }\n};\nvar __read = (this && this.__read) || function(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n    r, ar = [],\n    e;\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) { e = { error: error }; } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally { if (e) throw e.error; }\n  }\n  return ar;\n};\nvar __values = (this && this.__values) || function(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n    m = s && o[s],\n    i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function() {\n      if (o && i >= o.length) o = void 0;\n      return { value: o && o[i++], done: !o };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __spreadArray = (this && this.__spreadArray) || function(to, from, pack) {\n  if (pack || arguments.length === 2)\n    for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n        if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n        ar[i] = from[i];\n      }\n    }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport algosdk from 'algosdk';\nimport ethers from 'ethers';\nimport Timeout from 'await-timeout';\nimport buffer from 'buffer';\nimport * as RHC from './ALGO_ReachHTTPClient.mjs';\n// @ts-ignore // XXX Dan FIXME pls\nimport * as UTBC from './ALGO_UTBC.mjs';\nvar Buffer = buffer.Buffer;\nimport { VERSION } from './version.mjs';\nimport { apiStateMismatchError, stdContract, stdVerifyContract, stdABIFilter, stdAccount, stdAccount_unsupported, debug, envDefault, argsSplit, makeRandom, replaceableThunk, ensureConnectorAvailable, make_newTestAccounts, make_waitUntilX, checkTimeout, truthyEnv, Lock, retryLoop, makeEventQueue, makeEventStream, makeSigningMonitor, j2sf, j2s, hideWarnings, hasProp, makeParseCurrency, } from './shared_impl.mjs';\nimport { bigNumberify, bigNumberToNumber, bigNumberToBigInt, } from './shared_user.mjs';\nimport waitPort from './waitPort.mjs';\nimport { addressFromHex, stdlib, typeDefs, extractAddr, bytestringyNet, } from './ALGO_compiled.mjs';\nimport { simTokenAccepted_ } from './shared_backend.mjs';\nimport { window, process } from './shim.mjs';\nimport { sha512_256 } from 'js-sha512';\nimport * as shared_user from './shared_user.mjs';\nimport * as shared_impl from './shared_impl.mjs';;;\nvar defaultALGO_TOKEN_HEADER = 'X-Algo-API-Token';\nvar defaultALGO_INDEXER_TOKEN_HEADER = 'X-Indexer-API-Token';\nvar reachBackendVersion = 18;\nvar reachAlgoBackendVersion = 10;;;\nexport var load = function() {\n  var connector = 'ALGO';\n  var reachStdlib = stdlib;\n  var setQueryLowerBound = shared_impl.setQueryLowerBound,\n    getQueryLowerBound = shared_impl.getQueryLowerBound,\n    formatWithDecimals = shared_impl.formatWithDecimals,\n    handleFormat = shared_impl.handleFormat;\n  var _a = __read(makeSigningMonitor(), 2),\n    setSigningMonitor = _a[0],\n    notifySend = _a[1];\n  // module-wide config\n  var customHttpEventHandler = function() {\n    return __awaiter(void 0, void 0, void 0, function() {\n      return __generator(this, function(_a) {\n        return [2 /*return*/ , undefined];\n      });\n    });\n  };\n\n  function setCustomHttpEventHandler(h) {\n    customHttpEventHandler = h;\n  }\n  /**\n   * @description client-side rate limiting.\n   *  Setting this to any positive number will also prevent requests from being sent in parallel.\n   *  Rate limiting is applied to all outgoing http requests, even if they are to different servers.\n   */\n  var minMillisBetweenRequests = 0;\n\n  function setMinMillisBetweenRequests(n) {\n    minMillisBetweenRequests = n;\n  }\n  var reqLock = new Lock();\n  var currentReqNum = undefined;\n  var currentReqLabel = undefined;\n  var lastReqSentAt = undefined; // ms\n  var appStateMinRefreshMillis = 1000;\n\n  function httpEventHandler(e) {\n    return __awaiter(this, void 0, void 0, function() {\n      var en, waitMs;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            en = e.eventName;\n            if (!(minMillisBetweenRequests > 0)) return [3 /*break*/ , 5];\n            if (!(en === 'before')) return [3 /*break*/ , 4];\n            return [4 /*yield*/ , reqLock.acquire()];\n          case 1:\n            _a.sent();\n            if (!lastReqSentAt) return [3 /*break*/ , 3];\n            waitMs = Math.max(0, lastReqSentAt + minMillisBetweenRequests - Date.now());\n            debug(\"waiting \".concat(waitMs, \"ms due to minMillisBetweenRequests=\").concat(minMillisBetweenRequests));\n            return [4 /*yield*/ , Timeout.set(waitMs)];\n          case 2:\n            _a.sent();\n            _a.label = 3;\n          case 3:\n            lastReqSentAt = Date.now();\n            currentReqNum = e.reqNum;\n            currentReqLabel = e.label;\n            _a.label = 4;\n          case 4:\n            if (en === 'success' || en === 'error') {\n              if (currentReqNum === e.reqNum && currentReqLabel == e.label) {\n                currentReqNum = undefined;\n                currentReqLabel = undefined;\n                reqLock.release();\n              } else {\n                throw Error('impossible: multiple requests in flight');\n              }\n            }\n            _a.label = 5;\n          case 5:\n            return [4 /*yield*/ , customHttpEventHandler(e)];\n          case 6:\n            _a.sent();\n            return [2 /*return*/ ];\n        }\n      });\n    });\n  }\n  // Helpers\n  // Parse CBR into Public Key\n  var cbr2algo_addr = function(x) {\n    return algosdk.encodeAddress(Buffer.from(x.slice(2), 'hex'));\n  };\n  var txnFromAddress = function(t) {\n    return algosdk.encodeAddress(t.from.publicKey);\n  };\n\n  function uint8ArrayToStr(a, enc) {\n    if (enc === void 0) { enc = 'utf8'; }\n    if (!(a instanceof Uint8Array)) {\n      console.log(a);\n      throw Error(\"Expected Uint8Array, got \".concat(a));\n    }\n    return Buffer.from(a).toString(enc);\n  }\n  // TODO: read token from scripts/devnet-algo/algorand_data/algod.token\n  var rawDefaultToken = 'c87f5580d7a866317b4bfe9e8b8d1dda955636ccebfa88c12b414db208dd9705';\n  var rawDefaultItoken = 'reach-devnet';\n  var indexerTxn2RecvTxn = function(txn) {\n    var ait = txn['application-transaction'] || {};\n    var aargs = ait['application-args'] || [];\n    var aidx = ait['application-id'];\n    // We're returning the first we find, but actually we just want the first one\n    // period.\n    var ccai = (function() {\n      var e_1, _a;\n      var its = txn['inner-txns'] || [];\n      try {\n        for (var its_1 = __values(its), its_1_1 = its_1.next(); !its_1_1.done; its_1_1 = its_1.next()) {\n          var itx = its_1_1.value;\n          debug('ccai itx', itx);\n          return itx['created-application-index'];\n        }\n      } catch (e_1_1) { e_1 = { error: e_1_1 }; } finally {\n        try {\n          if (its_1_1 && !its_1_1.done && (_a = its_1[\"return\"])) _a.call(its_1);\n        } finally { if (e_1) throw e_1.error; }\n      }\n      return undefined;\n    })();\n    return {\n      'confirmed-round': txn['confirmed-round'],\n      'sender': txn['sender'],\n      'approval-program': ait['approval-program'],\n      'clear-state-program': ait['clear-state-program'],\n      'logs': (txn['logs'] || []),\n      'application-args': aargs,\n      'application-index': aidx,\n      'created-application-index': txn['created-application-index'],\n      'created-asset-index': txn['created-asset-index'],\n      'created-companion-application-index': ccai\n    };\n  };\n  var waitForConfirmation = function(txId) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var doOrDie, dhead, client, checkAlgod, checkIndexer;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            doOrDie = function(p) {\n              return __awaiter(void 0, void 0, void 0, function() {\n                var e_2;\n                var _a;\n                return __generator(this, function(_b) {\n                  switch (_b.label) {\n                    case 0:\n                      _b.trys.push([0, 2, , 3]);\n                      _a = {};\n                      return [4 /*yield*/ , p];\n                    case 1:\n                      return [2 /*return*/ , (_a.val = _b.sent(), _a)];\n                    case 2:\n                      e_2 = _b.sent();\n                      return [2 /*return*/ , { 'exn': e_2 }];\n                    case 3:\n                      return [2 /*return*/ ];\n                  }\n                });\n              });\n            };\n            dhead = \"waitForConfirmation \".concat(txId);\n            return [4 /*yield*/ , getAlgodClient()];\n          case 1:\n            client = _a.sent();\n            checkAlgod = function() {\n              return __awaiter(void 0, void 0, void 0, function() {\n                var q, infoM, info, cr, l, dtxn, uToS, ccai;\n                return __generator(this, function(_a) {\n                  switch (_a.label) {\n                    case 0:\n                      q = client.pendingTransactionInformation(txId)[\"do\"]();\n                      return [4 /*yield*/ , doOrDie(q)];\n                    case 1:\n                      infoM = _a.sent();\n                      debug(dhead, 'info', infoM);\n                      if (!('exn' in infoM)) return [3 /*break*/ , 3];\n                      debug(dhead, 'switching to indexer on error');\n                      return [4 /*yield*/ , checkIndexer()];\n                    case 2:\n                      return [2 /*return*/ , _a.sent()];\n                    case 3:\n                      info = infoM.val;\n                      cr = info['confirmed-round'];\n                      if (!(cr !== undefined && cr > 0)) return [3 /*break*/ , 4];\n                      l = info['logs'] === undefined ? [] : info['logs'];\n                      debug(dhead, 'confirmed');\n                      dtxn = algosdk.Transaction.from_obj_for_encoding(info['txn']['txn']);\n                      debug(dhead, 'confirmed', dtxn);\n                      uToS = function(a) { return (a || []).map(function(x) { return uint8ArrayToStr(x, 'base64'); }); };\n                      ccai = (function() {\n                        var e_3, _a;\n                        var its = info['inner-txns'] || [];\n                        try {\n                          for (var its_2 = __values(its), its_2_1 = its_2.next(); !its_2_1.done; its_2_1 = its_2.next()) {\n                            var itx = its_2_1.value;\n                            debug('ccai itx', itx);\n                            return itx['application-index'];\n                          }\n                        } catch (e_3_1) { e_3 = { error: e_3_1 }; } finally {\n                          try {\n                            if (its_2_1 && !its_2_1.done && (_a = its_2[\"return\"])) _a.call(its_2);\n                          } finally { if (e_3) throw e_3.error; }\n                        }\n                        return undefined;\n                      })();\n                      return [2 /*return*/ , {\n                        'confirmed-round': cr,\n                        'created-asset-index': info['asset-index'],\n                        // @ts-ignore\n                        'logs': uToS(l),\n                        'created-application-index': info['application-index'],\n                        'created-companion-application-index': ccai,\n                        'sender': txnFromAddress(dtxn),\n                        'application-args': uToS(dtxn.appArgs)\n                      }];\n                    case 4:\n                      if (!(info['pool-error'] === '')) return [3 /*break*/ , 6];\n                      debug(dhead, 'still in pool, trying again');\n                      return [4 /*yield*/ , checkAlgod()];\n                    case 5:\n                      return [2 /*return*/ , _a.sent()];\n                    case 6:\n                      throw Error(\"waitForConfirmation: error confirming: \".concat(j2s(info)));\n                  }\n                });\n              });\n            };\n            checkIndexer = function() {\n              return __awaiter(void 0, void 0, void 0, function() {\n                var indexer, q, res;\n                return __generator(this, function(_a) {\n                  switch (_a.label) {\n                    case 0:\n                      return [4 /*yield*/ , getIndexer()];\n                    case 1:\n                      indexer = _a.sent();\n                      q = indexer.lookupTransactionByID(txId);\n                      return [4 /*yield*/ , doQuery_(dhead, q)];\n                    case 2:\n                      res = _a.sent();\n                      debug(dhead, 'indexer', res);\n                      return [2 /*return*/ , indexerTxn2RecvTxn(res['transaction'])];\n                  }\n                });\n              });\n            };\n            return [4 /*yield*/ , nodeCanRead()];\n          case 2:\n            if (!_a.sent()) return [3 /*break*/ , 4];\n            return [4 /*yield*/ , checkAlgod()];\n          case 3:\n            return [2 /*return*/ , _a.sent()];\n          case 4:\n            return [4 /*yield*/ , checkIndexer()];\n          case 5:\n            return [2 /*return*/ , _a.sent()];\n        }\n      });\n    });\n  };\n  var decodeB64Txn = function(ts) {\n    var tb = Buffer.from(ts, 'base64');\n    return algosdk.decodeUnsignedTransaction(tb);\n  };\n  var doSignTxnToB64 = function(t, sk) {\n    var sb = Buffer.from(t.signTxn(sk));\n    return sb.toString('base64');\n  };\n  var doSignTxn = function(ts, sk) {\n    return doSignTxnToB64(decodeB64Txn(ts), sk);\n  };\n  var signSendAndConfirm = function(acc, txns) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var p, sapt_res, notifyComplete, e_4, es, r, N, tN, e_5, es;\n      var _a;\n      return __generator(this, function(_b) {\n        switch (_b.label) {\n          case 0:\n            if (acc.sk !== undefined) {\n              txns.forEach(function(t) {\n                // XXX this comparison is probably wrong, because the addresses are the\n                // wrong type\n                if (acc.sk !== undefined && !t.stxn && t.signers !== undefined && t.signers.length === 1 && t.signers[0] === acc.addr) {\n                  debug('signSendAndConfirm', 'signing one');\n                  t.stxn = doSignTxn(t.txn, acc.sk);\n                }\n              });\n            }\n            return [4 /*yield*/ , getProvider()];\n          case 1:\n            p = _b.sent();\n            _b.label = 2;\n          case 2:\n            _b.trys.push([2, 4, , 5]);\n            return [4 /*yield*/ , notifySend(txns, p.signAndPostTxns(txns))];\n          case 3:\n            _a = __read.apply(void 0, [_b.sent(), 2]), sapt_res = _a[0], notifyComplete = _a[1];\n            return [3 /*break*/ , 5];\n          case 4:\n            e_4 = _b.sent();\n            es = \"\".concat(e_4);\n            if (hasProp(e_4, 'response')) {\n              r = e_4.response;\n              if (hasProp(r, 'body')) {\n                e_4.response = r.body;\n              } else if (hasProp(r, 'text')) {\n                e_4.response = r.text;\n              } else {\n                delete r.request;\n                delete r.req;\n              }\n            }\n            throw { type: 'signAndPost', e: e_4, es: es };\n          case 5:\n            debug({ sapt_res: sapt_res });\n            N = txns.length - 1;\n            tN = decodeB64Txn(txns[N].txn);\n            _b.label = 6;\n          case 6:\n            _b.trys.push([6, 8, , 9]);\n            return [4 /*yield*/ , notifyComplete(waitForConfirmation(tN.txID()))];\n          case 7:\n            return [2 /*return*/ , _b.sent()]; // tN.lastRound\n          case 8:\n            e_5 = _b.sent();\n            es = \"\".concat(e_5);\n            throw { type: 'waitForConfirmation', e: e_5, es: es };\n          case 9:\n            return [2 /*return*/ ];\n        }\n      });\n    });\n  };\n  var encodeUnsignedTransaction = function(t) {\n    return Buffer.from(algosdk.encodeUnsignedTransaction(t)).toString('base64');\n  };\n  var toWTxn = function(t) {\n    return {\n      txn: encodeUnsignedTransaction(t),\n      signers: [txnFromAddress(t)]\n    };\n  };\n  // Backend\n  var stdWait = function() { return Timeout.set(1000); };\n  var getTxnParams = function(label) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var dhead, client, params_r, bi2n, params;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            dhead = \"\".concat(label, \" fillTxn\");\n            debug(dhead, \"getting params\");\n            return [4 /*yield*/ , getAlgodClient()];\n          case 1:\n            client = _a.sent();\n            _a.label = 2;\n          case 2:\n            if (!true) return [3 /*break*/ , 5];\n            return [4 /*yield*/ , client.getTransactionParams()[\"do\"]()];\n          case 3:\n            params_r = (_a.sent());\n            debug(dhead, 'got params:', params_r);\n            bi2n = function(x) { return bigNumberToNumber(bigNumberify(x)); };\n            params = __assign(__assign({}, params_r), { fee: bi2n(params_r.fee), firstRound: bi2n(params_r.firstRound), lastRound: bi2n(params_r.lastRound) });\n            debug(dhead, 'got params:', params);\n            if (params.firstRound !== 0) {\n              return [2 /*return*/ , params];\n            }\n            debug(dhead, \"...but firstRound is 0, so let's wait and try again.\");\n            return [4 /*yield*/ , stdWait()];\n          case 4:\n            _a.sent();\n            return [3 /*break*/ , 2];\n          case 5:\n            return [2 /*return*/ ];\n        }\n      });\n    });\n  };\n  var sign_and_send_sync = function(label, acc, txn) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var e_6;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            _a.trys.push([0, 2, , 3]);\n            return [4 /*yield*/ , signSendAndConfirm(acc, [txn])];\n          case 1:\n            return [2 /*return*/ , _a.sent()];\n          case 2:\n            e_6 = _a.sent();\n            console.log(e_6);\n            throw Error(\"\".concat(label, \" txn failed:\\n\").concat(j2s(txn), \"\\nwith:\\n\").concat(j2s(e_6)));\n          case 3:\n            return [2 /*return*/ ];\n        }\n      });\n    });\n  };\n  // XXX I'd use x.replaceAll if I could (not supported in this node version), but it would be better to extend ConnectorInfo so these are functions\n  var replaceAll = function(orig, what, whatp) {\n    var once = orig.replace(what, whatp);\n    if (once === orig) {\n      return orig;\n    } else {\n      return replaceAll(once, what, whatp);\n    }\n  };\n\n  function must_be_supported(bin) {\n    var algob = bin._Connectors.ALGO;\n    var unsupported = algob.unsupported,\n      warnings = algob.warnings;\n    var render = function(x) { return x.map(function(s) { return \" * \".concat(s); }).join('\\n'); };\n    if (warnings.length > 0 && !hideWarnings()) {\n      console.error(\"This Reach application is dangerous to run on Algorand for the following reasons:\\n\".concat(render(warnings)));\n    }\n    if (unsupported.length > 0) {\n      throw Error(\"This Reach application is not supported on Algorand for the following reasons:\\n\".concat(render(unsupported)));\n    }\n  }\n  // Get these from stdlib\n  // const MaxTxnLife = 1000;\n  var MinTxnFee = 1000;\n  var MaxAppTxnAccounts = 4;\n  var MinBalance = 100000;\n  var MaxAppProgramLen = 2048;\n  var SchemaMinBalancePerEntry = 25000;\n  var SchemaBytesMinBalance = 25000;\n  var SchemaUintMinBalance = 3500;\n  var AppFlatParamsMinBalance = 100000;\n  var AppFlatOptInMinBalance = 100000;\n  var ui8h = function(x) { return Buffer.from(x).toString('hex'); };\n  var base64ToUI8A = function(x) { return Uint8Array.from(Buffer.from(x, 'base64')); };\n  var base64ify = function(x) { return Buffer.from(x).toString('base64'); };\n\n  function looksLikeAccountingNotInitialized(e) {\n    var _a;\n    var responseText = ((_a = e === null || e === void 0 ? void 0 : e.response) === null || _a === void 0 ? void 0 : _a.text) || null;\n    // TODO: trust the response to be json and parse it?\n    // const json = JSON.parse(responseText) || {};\n    // const msg: string = (json.message || '').toLowerCase();\n    var msg = (responseText || '').toLowerCase();\n    return msg.includes(\"accounting not initialized\");\n  }\n  var doQueryM_ = function(dhead, query) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var val, exn_1;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            _a.trys.push([0, 2, , 3]);\n            return [4 /*yield*/ , query[\"do\"]()];\n          case 1:\n            val = _a.sent();\n            debug(dhead, 'RESULT', val);\n            return [2 /*return*/ , { val: val }];\n          case 2:\n            exn_1 = _a.sent();\n            return [2 /*return*/ , { exn: exn_1 }];\n          case 3:\n            return [2 /*return*/ ];\n        }\n      });\n    });\n  };\n  var doQuery_ = function(dhead, query, howMany, failOk) {\n    if (howMany === void 0) { howMany = 0; }\n    if (failOk === void 0) { failOk = (function(exn) { return { exn: exn }; }); }\n    return __awaiter(void 0, void 0, void 0, function() {\n      var res, e, fr;\n      var _a;\n      return __generator(this, function(_b) {\n        switch (_b.label) {\n          case 0:\n            debug(dhead, query.query);\n            _b.label = 1;\n          case 1:\n            if (!true) return [3 /*break*/ , 5];\n            if (!(howMany > 0)) return [3 /*break*/ , 3];\n            return [4 /*yield*/ , stdWait()];\n          case 2:\n            _b.sent();\n            _b.label = 3;\n          case 3:\n            return [4 /*yield*/ , doQueryM_(dhead, query)];\n          case 4:\n            res = _b.sent();\n            if ('exn' in res) {\n              e = res.exn;\n              if ((e === null || e === void 0 ? void 0 : e.errno) === -111 || (e === null || e === void 0 ? void 0 : e.code) === \"ECONNRESET\") {\n                debug(dhead, 'NO CONNECTION');\n              } else if (looksLikeAccountingNotInitialized(e)) {\n                debug(dhead, 'ACCOUNTING NOT INITIALIZED');\n              }\n              if ((_a = e === null || e === void 0 ? void 0 : e.response) === null || _a === void 0 ? void 0 : _a.text) {\n                e = e.response.text;\n              }\n              fr = failOk(e);\n              if ('exn' in fr) {\n                debug(dhead, 'RETRYING', { e: e });\n                howMany++;\n              } else {\n                debug(dhead, 'FAIL OK', { e: e, fr: fr });\n                return [2 /*return*/ , fr.val];\n              }\n            } else {\n              return [2 /*return*/ , res.val];\n            }\n            return [3 /*break*/ , 1];\n          case 5:\n            return [2 /*return*/ ];\n        }\n      });\n    });\n  };\n\n  function getValidQueryWindow() {\n    return true;\n  }\n\n  function setValidQueryWindow(n) {\n    if (typeof n === 'number') {\n      throw Error(\"Only setValidQueryWindow(true) is supported on Algorand\");\n    }\n  }\n  var isCreateTxn = function(txn) {\n    var at = txn['application-transaction'];\n    return at ? bigNumberify(at['application-id']).eq(0) : false;\n  };\n  var emptyOptIn = function(txn) {\n    var at = txn['application-transaction'];\n    var ataa = at && at['application-args'] || [];\n    return at ?\n      (at['on-completion'] === 'optin' && ataa.length == 0) :\n      false;\n  };\n  var apiOnly = function(txn) {\n    var ls = txn['logs'];\n    if (ls && ls.length === 1) {\n      var l0 = ls[0];\n      var l0ui = base64ToUI8A(l0);\n      if (l0ui.length >= 4) {\n        var l0h = ui8h(l0ui.subarray(0, 4));\n        debug('apiOnly', { l0h: l0h });\n        return (l0h === '151f7c75');\n      } else {\n        return false;\n      }\n    } else {\n      return false;\n    }\n  };\n  var newEventQueue = function() {\n    var getTxns = function(dhead, initArgs, ctime, howMany, limsug) {\n      return __awaiter(void 0, void 0, void 0, function() {\n        var ApplicationID, indexer, mtime, appn, query, q, res, txns, walkTxns, gtime;\n        return __generator(this, function(_a) {\n          switch (_a.label) {\n            case 0:\n              ApplicationID = initArgs.ApplicationID;\n              return [4 /*yield*/ , getIndexer()];\n            case 1:\n              indexer = _a.sent();\n              mtime = bigNumberToNumber(ctime.add(1));\n              debug(dhead, { ctime: ctime, mtime: mtime });\n              appn = bigNumberToNumber(ApplicationID);\n              query = indexer.searchForTransactions()\n                .applicationID(appn)\n                //.txType('appl')\n                .minRound(mtime);\n              // TODO: ignore limsug on randlabs?\n              if (limsug) {\n                query = query.limit(limsug);\n              }\n              q = query;\n              return [4 /*yield*/ , doQuery_(dhead, q, howMany)];\n            case 2:\n              res = _a.sent();\n              txns = [];\n              walkTxns = function(ints) {\n                ints.filter(function(x) { return x['tx-type'] === 'appl'; }).forEach(function(x) {\n                  var at = (x['application-transaction'] || {});\n                  var ai = bigNumberify(at['application-id'] || 0);\n                  var cai = bigNumberify(x['created-application-index'] || 0);\n                  var its = x['inner-txns'];\n                  if (ai.eq(ApplicationID) || cai.eq(ApplicationID)) {\n                    txns.push(x);\n                  } else if (its) {\n                    walkTxns(its);\n                  }\n                });\n              };\n              walkTxns(res.transactions);\n              gtime = bigNumberify(res['current-round']);\n              return [2 /*return*/ , { txns: txns, gtime: gtime }];\n          }\n        });\n      });\n    };\n    var getTxnTime = function(x) { return bigNumberify(x['confirmed-round']); };\n    return makeEventQueue({\n      raw2proc: indexerTxn2RecvTxn,\n      alwaysIgnored: function(x) { return (emptyOptIn(x) || apiOnly(x)); },\n      getTxns: getTxns,\n      getTxnTime: getTxnTime\n    });\n  };\n  var addressEq = stdlib.addressEq,\n    assert = stdlib.assert,\n    gt = stdlib.gt,\n    protect = stdlib.protect;\n  var T_UInt = typeDefs.T_UInt,\n    T_Tuple = typeDefs.T_Tuple,\n    T_Contract = typeDefs.T_Contract,\n    T_Bytes = typeDefs.T_Bytes,\n    T_Address = typeDefs.T_Address,\n    T_Digest = typeDefs.T_Digest;\n  var _b = makeRandom(8),\n    randomUInt = _b.randomUInt,\n    hasRandom = _b.hasRandom;\n\n  function waitIndexerFromEnv(env) {\n    return __awaiter(this, void 0, void 0, function() {\n      var ALGO_INDEXER_SERVER, ALGO_INDEXER_PORT, ALGO_INDEXER_TOKEN, ALGO_INDEXER_TOKEN_HEADER, port, utbc, rhc;\n      var _a;\n      return __generator(this, function(_b) {\n        switch (_b.label) {\n          case 0:\n            ALGO_INDEXER_SERVER = env.ALGO_INDEXER_SERVER, ALGO_INDEXER_PORT = env.ALGO_INDEXER_PORT, ALGO_INDEXER_TOKEN = env.ALGO_INDEXER_TOKEN, ALGO_INDEXER_TOKEN_HEADER = env.ALGO_INDEXER_TOKEN_HEADER;\n            return [4 /*yield*/ , waitPort(ALGO_INDEXER_SERVER, ALGO_INDEXER_PORT)];\n          case 1:\n            _b.sent();\n            port = ALGO_INDEXER_PORT || undefined;\n            utbc = new UTBC.URLTokenBaseHTTPClient((_a = {}, _a[ALGO_INDEXER_TOKEN_HEADER] = ALGO_INDEXER_TOKEN, _a), ALGO_INDEXER_SERVER, port);\n            rhc = new RHC.ReachHTTPClient(utbc, 'indexer', httpEventHandler);\n            return [2 /*return*/ , [rhc, new algosdk.Indexer(rhc)]];\n        }\n      });\n    });\n  }\n\n  function waitAlgodClientFromEnv(env) {\n    return __awaiter(this, void 0, void 0, function() {\n      var ALGO_SERVER, ALGO_PORT, ALGO_TOKEN, ALGO_TOKEN_HEADER, port, utbc, rhc;\n      var _a;\n      return __generator(this, function(_b) {\n        switch (_b.label) {\n          case 0:\n            ALGO_SERVER = env.ALGO_SERVER, ALGO_PORT = env.ALGO_PORT, ALGO_TOKEN = env.ALGO_TOKEN, ALGO_TOKEN_HEADER = env.ALGO_TOKEN_HEADER;\n            return [4 /*yield*/ , waitPort(ALGO_SERVER, ALGO_PORT)];\n          case 1:\n            _b.sent();\n            port = ALGO_PORT || undefined;\n            utbc = new UTBC.URLTokenBaseHTTPClient((_a = {}, _a[ALGO_TOKEN_HEADER] = ALGO_TOKEN, _a), ALGO_SERVER, port);\n            rhc = new RHC.ReachHTTPClient(utbc, 'algodv2', httpEventHandler);\n            return [2 /*return*/ , [rhc, new algosdk.Algodv2(rhc)]];\n        }\n      });\n    });\n  }\n  var makeProviderByWallet = function(wallet, env) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var defaults, allEnv, ALGO_GENESIS_ID, ALGO_GENESIS_HASH, ALGO_ACCOUNT, REACH_ISOLATED_NETWORK, ALGO_NODE_WRITE_ONLY, walletOpts, isIsolatedNetwork, nodeWriteOnly, enabledNetwork, enabledAccounts, enabled, algod_bc, indexer_bc, algodClient, indexer, getDefaultAddress, signAndPostTxns;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            debug(\"making provider with wallet\");\n            defaults = { REACH_ISOLATED_NETWORK: 'no', ALGO_NODE_WRITE_ONLY: 'yes' };\n            allEnv = __assign(__assign(__assign({}, defaults), env), (wallet._env || {}));\n            ALGO_GENESIS_ID = env.ALGO_GENESIS_ID, ALGO_GENESIS_HASH = env.ALGO_GENESIS_HASH, ALGO_ACCOUNT = env.ALGO_ACCOUNT;\n            REACH_ISOLATED_NETWORK = allEnv.REACH_ISOLATED_NETWORK, ALGO_NODE_WRITE_ONLY = allEnv.ALGO_NODE_WRITE_ONLY;\n            walletOpts = {\n              genesisID: ALGO_GENESIS_ID || undefined,\n              genesisHash: ALGO_GENESIS_HASH || undefined,\n              accounts: ALGO_ACCOUNT ? [ALGO_ACCOUNT] : undefined\n            };\n            isIsolatedNetwork = truthyEnv(REACH_ISOLATED_NETWORK);\n            nodeWriteOnly = truthyEnv(ALGO_NODE_WRITE_ONLY);\n            if (!(wallet.enableNetwork === undefined && wallet.enableAccounts === undefined)) return [3 /*break*/ , 2];\n            return [4 /*yield*/ , wallet.enable(walletOpts)];\n          case 1:\n            enabled = _a.sent();\n            enabledNetwork = enabled;\n            enabledAccounts = enabled;\n            return [3 /*break*/ , 5];\n          case 2:\n            if (!(wallet.enableNetwork === undefined || wallet.enableAccounts === undefined)) return [3 /*break*/ , 3];\n            throw new Error('must have enableNetwork AND enableAccounts OR neither');\n          case 3:\n            return [4 /*yield*/ , wallet.enableNetwork(walletOpts)];\n          case 4:\n            enabledNetwork = _a.sent();\n            _a.label = 5;\n          case 5:\n            void enabledNetwork;\n            return [4 /*yield*/ , wallet.getAlgodv2Client()];\n          case 6:\n            algod_bc = _a.sent();\n            return [4 /*yield*/ , wallet.getIndexerClient()];\n          case 7:\n            indexer_bc = _a.sent();\n            algodClient = new algosdk.Algodv2(algod_bc);\n            indexer = new algosdk.Indexer(indexer_bc);\n            getDefaultAddress = function() {\n              return __awaiter(void 0, void 0, void 0, function() {\n                return __generator(this, function(_a) {\n                  switch (_a.label) {\n                    case 0:\n                      if (!(enabledAccounts === undefined)) return [3 /*break*/ , 2];\n                      if (wallet.enableAccounts === undefined) {\n                        throw new Error('impossible: no wallet.enableAccounts');\n                      }\n                      return [4 /*yield*/ , wallet.enableAccounts(walletOpts)];\n                    case 1:\n                      enabledAccounts = _a.sent();\n                      if (enabledAccounts === undefined) {\n                        throw new Error('Could not enable accounts');\n                      }\n                      _a.label = 2;\n                    case 2:\n                      return [2 /*return*/ , enabledAccounts.accounts[0]];\n                  }\n                });\n              });\n            };\n            signAndPostTxns = wallet.signAndPostTxns;\n            return [2 /*return*/ , { algod_bc: algod_bc, indexer_bc: indexer_bc, indexer: indexer, algodClient: algodClient, nodeWriteOnly: nodeWriteOnly, getDefaultAddress: getDefaultAddress, isIsolatedNetwork: isIsolatedNetwork, signAndPostTxns: signAndPostTxns }];\n        }\n      });\n    });\n  };\n  var setWalletFallback = function(wf) {\n    if (!window.algorand) {\n      window.algorand = wf();\n    }\n  };\n  var checkNetwork = function(ret, eopts) {\n    var id = ret.genesisID,\n      h = ret.genesisHash;\n    var _a = eopts || {},\n      eid = _a.genesisID,\n      eh = _a.genesisHash;\n    if ((eid && eid !== id) || (eh && eh !== h)) {\n      throw Error(\"Requested genesis ID or hash not supported by this wallet.\\n\" +\n        \"Expected: '\".concat(id, \"' '\").concat(h, \"'\\n\") +\n        \"Got: '\".concat(eid, \"' '\").concat(eh, \"'\"));\n    }\n  };\n  var checkAccounts = function(addr, got) {\n    if (got && (got[0] !== addr || got.length > 1)) {\n      throw Error(\"One or more requested accounts not supported by this wallet.\\n\" +\n        \"Expected: \".concat(JSON.stringify([addr]), \"\\n\") +\n        \"Got: \".concat(JSON.stringify(got)));\n    }\n  };\n  var doWalletFallback_signOnly = function(opts, getAddr, signTxns_, disconnect_) {\n    var p = undefined;\n    var base = opts['providerEnv'] || 'LocalHost';\n    var _env = typeof base === 'string' ? providerEnvByName(base) : base;\n    var enableNetwork = function(eopts) {\n      return __awaiter(void 0, void 0, void 0, function() {\n        var op, _a, genesisID, genesisHash, ret;\n        return __generator(this, function(_b) {\n          switch (_b.label) {\n            case 0:\n              op = opts.provider;\n              if (!op) return [3 /*break*/ , 1];\n              p = op;\n              return [3 /*break*/ , 3];\n            case 1:\n              return [4 /*yield*/ , makeProviderByEnv(_env)];\n            case 2:\n              p = _b.sent();\n              _b.label = 3;\n            case 3:\n              return [4 /*yield*/ , p.algodClient.getTransactionParams()[\"do\"]()];\n            case 4:\n              _a = _b.sent(), genesisID = _a.genesisID, genesisHash = _a.genesisHash;\n              ret = { genesisID: genesisID, genesisHash: genesisHash };\n              checkNetwork(ret, eopts);\n              return [2 /*return*/ , ret];\n          }\n        });\n      });\n    };\n    var enableAccounts = function(eopts) {\n      return __awaiter(void 0, void 0, void 0, function() {\n        var addr;\n        return __generator(this, function(_a) {\n          switch (_a.label) {\n            case 0:\n              return [4 /*yield*/ , getAddr()];\n            case 1:\n              addr = _a.sent();\n              checkAccounts(addr, eopts === null || eopts === void 0 ? void 0 : eopts.accounts);\n              return [2 /*return*/ , { accounts: [addr] }];\n          }\n        });\n      });\n    };\n    var enable = function(eopts) {\n      return __awaiter(void 0, void 0, void 0, function() {\n        var nres, ares;\n        return __generator(this, function(_a) {\n          switch (_a.label) {\n            case 0:\n              return [4 /*yield*/ , enableNetwork(eopts)];\n            case 1:\n              nres = _a.sent();\n              return [4 /*yield*/ , enableAccounts(eopts)];\n            case 2:\n              ares = _a.sent();\n              return [2 /*return*/ , __assign(__assign({}, nres), ares)];\n          }\n        });\n      });\n    };\n    var getAlgodv2Client = function() {\n      return __awaiter(void 0, void 0, void 0, function() {\n        return __generator(this, function(_a) {\n          if (!p) {\n            throw new Error(\"must call enable\");\n          };\n          return [2 /*return*/ , p.algod_bc];\n        });\n      });\n    };\n    var getIndexerClient = function() {\n      return __awaiter(void 0, void 0, void 0, function() {\n        return __generator(this, function(_a) {\n          if (!p) {\n            throw new Error(\"must call enable\");\n          };\n          return [2 /*return*/ , p.indexer_bc];\n        });\n      });\n    };\n    var signTxns = function(txns, sopts) {\n      return __awaiter(void 0, void 0, void 0, function() {\n        var to_sign, signed, _a, stxns;\n        return __generator(this, function(_b) {\n          switch (_b.label) {\n            case 0:\n              void(sopts);\n              debug(\"fallBack: signAndPostTxns\", { txns: txns });\n              to_sign = [];\n              txns.forEach(function(txn) {\n                if (!txn.stxn) {\n                  to_sign.push(txn.txn);\n                }\n              });\n              debug(\"fallBack: signAndPostTxns\", { to_sign: to_sign });\n              if (!(to_sign.length == 0)) return [3 /*break*/ , 1];\n              _a = [];\n              return [3 /*break*/ , 3];\n            case 1:\n              return [4 /*yield*/ , signTxns_(to_sign)];\n            case 2:\n              _a = _b.sent();\n              _b.label = 3;\n            case 3:\n              signed = _a;\n              debug(\"fallBack: signAndPostTxns\", { signed: signed });\n              stxns = txns.map(function(txn) {\n                if (txn.stxn) {\n                  return txn.stxn;\n                }\n                var s = signed.shift();\n                if (!s) {\n                  throw new Error(\"txn not signed\");\n                }\n                return s;\n              });\n              return [2 /*return*/ , stxns];\n          }\n        });\n      });\n    };\n    var postTxns = function(stxns, popts) {\n      return __awaiter(void 0, void 0, void 0, function() {\n        var bs;\n        return __generator(this, function(_a) {\n          switch (_a.label) {\n            case 0:\n              if (!p) {\n                throw new Error(\"must call enable\");\n              };\n              void(popts);\n              bs = stxns.map(function(stxn) { return Buffer.from(stxn, 'base64'); });\n              debug(\"fallBack: signAndPostTxns\", bs);\n              return [4 /*yield*/ , p.algodClient.sendRawTransaction(bs)[\"do\"]()];\n            case 1:\n              _a.sent();\n              return [2 /*return*/ , {}]; // TODO\n          }\n        });\n      });\n    };\n    var signAndPostTxns = function(txns, spopts) {\n      return __awaiter(void 0, void 0, void 0, function() {\n        var stxns;\n        return __generator(this, function(_a) {\n          switch (_a.label) {\n            case 0:\n              if (!p) {\n                throw new Error(\"must call enable\");\n              };\n              return [4 /*yield*/ , signTxns(txns, spopts)];\n            case 1:\n              stxns = _a.sent();\n              return [4 /*yield*/ , postTxns(stxns, spopts)];\n            case 2:\n              return [2 /*return*/ , _a.sent()];\n          }\n        });\n      });\n    };\n    var disconnect = function() {\n      return __awaiter(void 0, void 0, void 0, function() {\n        return __generator(this, function(_a) {\n          switch (_a.label) {\n            case 0:\n              return [4 /*yield*/ , disconnect_()];\n            case 1:\n              return [2 /*return*/ , _a.sent()];\n          }\n        });\n      });\n    };\n    return { _env: _env, enable: enable, enableNetwork: enableNetwork, enableAccounts: enableAccounts, getAlgodv2Client: getAlgodv2Client, getIndexerClient: getIndexerClient, signTxns: signTxns, postTxns: postTxns, signAndPostTxns: signAndPostTxns, disconnect: disconnect };\n  };\n  var walletFallback_mnemonic = function(opts) {\n    return function() {\n      debug(\"using mnemonic wallet fallback\");\n      var getAddr = function() {\n        return __awaiter(void 0, void 0, void 0, function() {\n          return __generator(this, function(_a) {\n            return [2 /*return*/ , window.prompt(\"Please paste the address of your account:\")];\n          });\n        });\n      };\n      var signTxns = function(txns) {\n        return __awaiter(void 0, void 0, void 0, function() {\n          return __generator(this, function(_a) {\n            return [2 /*return*/ , txns.map(function(ts) {\n              var t = decodeB64Txn(ts);\n              var addr = txnFromAddress(t);\n              var mn = window.prompt(\"Please paste the mnemonic for the address, \".concat(addr, \". It will not be saved.\"));\n              var acc = algosdk.mnemonicToSecretKey(mn);\n              return doSignTxnToB64(t, acc.sk);\n            })];\n          });\n        });\n      };\n      var disconnect = function() {\n        return __awaiter(void 0, void 0, void 0, function() {\n          return __generator(this, function(_a) {\n            return [2 /*return*/ ];\n          });\n        });\n      };\n      return doWalletFallback_signOnly(opts, getAddr, signTxns, disconnect);\n    };\n  };\n  var walletFallback_MyAlgoWallet = function(MyAlgoConnect, opts) {\n    return function() {\n      debug(\"using MyAlgoWallet wallet fallback\");\n      // Workaround for known webpack issue w/ MAW 1.1.2 & earlier\n      // https://github.com/randlabs/myalgo-connect/issues/27\n      if (!window.Buffer)\n        window.Buffer = Buffer;\n      // @ts-ignore\n      var mac = new MyAlgoConnect();\n      // MyAlgoConnect uses a global popup object for managing, so we need to\n      // guarantee there is only one in flight at a time.\n      var lock = new Lock();\n      var getAddr = function() {\n        return __awaiter(void 0, void 0, void 0, function() {\n          var accts;\n          return __generator(this, function(_a) {\n            switch (_a.label) {\n              case 0:\n                return [4 /*yield*/ , lock.runWith(function() {\n                  return __awaiter(void 0, void 0, void 0, function() {\n                    return __generator(this, function(_a) {\n                      switch (_a.label) {\n                        case 0:\n                          return [4 /*yield*/ , mac.connect({ shouldSelectOneAccount: true })];\n                        case 1:\n                          return [2 /*return*/ , _a.sent()];\n                      }\n                    });\n                  });\n                })];\n              case 1:\n                accts = _a.sent();\n                return [2 /*return*/ , accts[0].address];\n            }\n          });\n        });\n      };\n      var signTxns = function(txns) {\n        return __awaiter(void 0, void 0, void 0, function() {\n          var stxns;\n          return __generator(this, function(_a) {\n            switch (_a.label) {\n              case 0:\n                debug(\"MAW signTransaction ->\", txns);\n                return [4 /*yield*/ , lock.runWith(function() {\n                  return __awaiter(void 0, void 0, void 0, function() {\n                    return __generator(this, function(_a) {\n                      switch (_a.label) {\n                        case 0:\n                          return [4 /*yield*/ , mac.signTransaction(txns)];\n                        case 1:\n                          return [2 /*return*/ , _a.sent()];\n                      }\n                    });\n                  });\n                })];\n              case 1:\n                stxns = _a.sent();\n                debug(\"MAW signTransaction <-\", stxns);\n                return [2 /*return*/ , stxns.map(function(sts) { return Buffer.from(sts.blob).toString('base64'); })];\n            }\n          });\n        });\n      };\n      var disconnect = function() {\n        return __awaiter(void 0, void 0, void 0, function() {\n          return __generator(this, function(_a) {\n            return [2 /*return*/ ];\n          });\n        });\n      };\n      return doWalletFallback_signOnly(opts, getAddr, signTxns, disconnect);\n    };\n  };;\n  var walletFallback_WalletConnect = function(WalletConnect, opts) {\n    return function() {\n      debug(\"using WalletConnect wallet fallback\");\n      var wc = opts.WalletConnect_wc || new WalletConnect();\n      var disconnect = (function() { return wc.disconnect(); });\n      var wallet = doWalletFallback_signOnly(opts, (function() { return wc.getAddr(); }), (function(ts) { return wc.signTxns(ts); }), disconnect);\n      return __assign(__assign({}, wallet), { wc: wc });\n    };\n  };\n  var walletFallback = function(opts) {\n    debug(\"using wallet fallback with\", opts);\n    var mac = opts.MyAlgoConnect;\n    if (mac) {\n      return walletFallback_MyAlgoWallet(mac, opts);\n    }\n    var wc = opts.WalletConnect;\n    if (wc) {\n      return walletFallback_WalletConnect(wc, opts);\n    }\n    // This could be implemented with walletFallback_signOnly and the residue\n    // from the old version.\n    //  return walletFallback_AlgoSigner(opts);\n    return walletFallback_mnemonic(opts);\n  };\n  var _c = __read(replaceableThunk(function() {\n      return __awaiter(void 0, void 0, void 0, function() {\n        return __generator(this, function(_a) {\n          switch (_a.label) {\n            case 0:\n              if (!window.algorand) return [3 /*break*/ , 2];\n              return [4 /*yield*/ , makeProviderByWallet(window.algorand, process.env)];\n            case 1:\n              // @ts-ignore\n              return [2 /*return*/ , _a.sent()];\n            case 2:\n              debug(\"making default provider based on process.env\");\n              return [4 /*yield*/ , makeProviderByEnv(process.env)];\n            case 3:\n              return [2 /*return*/ , _a.sent()];\n          }\n        });\n      });\n    }), 2),\n    getProvider = _c[0],\n    setProvider = _c[1];\n  var getAlgodClient = function() {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var c;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/ , getProvider()];\n          case 1:\n            c = (_a.sent()).algodClient;\n            c.setIntEncoding(algosdk.IntDecoding.BIGINT);\n            return [2 /*return*/ , c];\n        }\n      });\n    });\n  };\n  var getIndexer = function() {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var p;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/ , getProvider()];\n          case 1:\n            p = (_a.sent()).indexer;\n            p.setIntEncoding(algosdk.IntDecoding.BIGINT);\n            return [2 /*return*/ , p];\n        }\n      });\n    });\n  };\n  var nodeCanRead = function() {\n    return __awaiter(void 0, void 0, void 0, function() {\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/ , getProvider()];\n          case 1:\n            return [2 /*return*/ , ((_a.sent()).nodeWriteOnly === false)];\n        }\n      });\n    });\n  };\n  var ensureNodeCanRead = function() {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var _a;\n      return __generator(this, function(_b) {\n        switch (_b.label) {\n          case 0:\n            _a = assert;\n            return [4 /*yield*/ , nodeCanRead()];\n          case 1:\n            return [2 /*return*/ , _a.apply(void 0, [_b.sent(), \"node can read\"])];\n        }\n      });\n    });\n  };\n  var localhostProviderEnv = {\n    ALGO_SERVER: 'http://localhost',\n    ALGO_PORT: '4180',\n    ALGO_TOKEN_HEADER: defaultALGO_TOKEN_HEADER,\n    ALGO_TOKEN: rawDefaultToken,\n    ALGO_INDEXER_SERVER: 'http://localhost',\n    ALGO_INDEXER_PORT: '8980',\n    ALGO_INDEXER_TOKEN_HEADER: defaultALGO_INDEXER_TOKEN_HEADER,\n    ALGO_INDEXER_TOKEN: rawDefaultItoken,\n    REACH_ISOLATED_NETWORK: 'yes',\n    ALGO_NODE_WRITE_ONLY: 'no'\n  };\n\n  function envDefaultsALGO(env) {\n    var e_7, _a;\n    var denv = localhostProviderEnv;\n    // @ts-ignore\n    var ret = {};\n    try {\n      for (var _b = __values(['ALGO_SERVER', 'ALGO_PORT', 'ALGO_TOKEN_HEADER', 'ALGO_TOKEN', 'ALGO_INDEXER_SERVER', 'ALGO_INDEXER_PORT', 'ALGO_INDEXER_TOKEN_HEADER', 'ALGO_INDEXER_TOKEN', 'REACH_ISOLATED_NETWORK', 'ALGO_NODE_WRITE_ONLY']), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var f = _c.value;\n        // @ts-ignore\n        ret[f] = envDefault(env[f], denv[f]);\n      }\n    } catch (e_7_1) { e_7 = { error: e_7_1 }; } finally {\n      try {\n        if (_c && !_c.done && (_a = _b[\"return\"])) _a.call(_b);\n      } finally { if (e_7) throw e_7.error; }\n    }\n    return ret;\n  };\n\n  function makeProviderByEnv(env) {\n    return __awaiter(this, void 0, void 0, function() {\n      var fullEnv, _a, algod_bc, algodClient, _b, indexer_bc, indexer, isIsolatedNetwork, nodeWriteOnly, errmsg, getDefaultAddress, signAndPostTxns;\n      var _this = this;\n      return __generator(this, function(_c) {\n        switch (_c.label) {\n          case 0:\n            debug(\"makeProviderByEnv\", env);\n            fullEnv = envDefaultsALGO(env);\n            debug(\"makeProviderByEnv defaulted\", fullEnv);\n            return [4 /*yield*/ , waitAlgodClientFromEnv(fullEnv)];\n          case 1:\n            _a = __read.apply(void 0, [_c.sent(), 2]), algod_bc = _a[0], algodClient = _a[1];\n            return [4 /*yield*/ , waitIndexerFromEnv(fullEnv)];\n          case 2:\n            _b = __read.apply(void 0, [_c.sent(), 2]), indexer_bc = _b[0], indexer = _b[1];\n            isIsolatedNetwork = truthyEnv(fullEnv.REACH_ISOLATED_NETWORK);\n            nodeWriteOnly = truthyEnv(fullEnv.ALGO_NODE_WRITE_ONLY);\n            errmsg = function(s) {\n              return \"Providers created by environment \".concat(s, \". Calling setProviderByEnv or setProviderByName removes this capability. Try removing calls to those functions.\");\n            };\n            getDefaultAddress = function() {\n              return __awaiter(_this, void 0, void 0, function() {\n                return __generator(this, function(_a) {\n                  throw new Error(errmsg(\"do not have default addresses\"));\n                });\n              });\n            };\n            signAndPostTxns = function(txns, opts) {\n              return __awaiter(_this, void 0, void 0, function() {\n                var stxns, bs;\n                return __generator(this, function(_a) {\n                  switch (_a.label) {\n                    case 0:\n                      void(opts);\n                      stxns = txns.map(function(txn) {\n                        if (txn.stxn) {\n                          return txn.stxn;\n                        }\n                        throw new Error(errmsg(\"cannot interactively sign\"));\n                      });\n                      bs = stxns.map(function(stxn) { return Buffer.from(stxn, 'base64'); });\n                      debug(\"signAndPostTxns\", bs);\n                      return [4 /*yield*/ , algodClient.sendRawTransaction(bs)[\"do\"]()];\n                    case 1:\n                      _a.sent();\n                      return [2 /*return*/ ];\n                  }\n                });\n              });\n            };\n            return [2 /*return*/ , { algod_bc: algod_bc, indexer_bc: indexer_bc, algodClient: algodClient, indexer: indexer, nodeWriteOnly: nodeWriteOnly, isIsolatedNetwork: isIsolatedNetwork, getDefaultAddress: getDefaultAddress, signAndPostTxns: signAndPostTxns }];\n        }\n      });\n    });\n  };\n\n  function setProviderByEnv(env) {\n    setProvider(makeProviderByEnv(env));\n  };\n\n  function algonodeEnv(net) {\n    // works for MainNet, TestNet, and BetaNet\n    // https://algonode.io/api/#node-api\n    var prefix = \"https://\".concat(net.toLowerCase(), \"-\");\n    var suffix = \".algonode.cloud\";\n    return {\n      ALGO_SERVER: \"\".concat(prefix, \"api\").concat(suffix),\n      ALGO_PORT: \"\",\n      ALGO_TOKEN_HEADER: defaultALGO_TOKEN_HEADER,\n      ALGO_TOKEN: \"\",\n      ALGO_INDEXER_SERVER: \"\".concat(prefix, \"idx\").concat(suffix),\n      ALGO_INDEXER_PORT: \"\",\n      ALGO_INDEXER_TOKEN_HEADER: defaultALGO_INDEXER_TOKEN_HEADER,\n      ALGO_INDEXER_TOKEN: \"\",\n      REACH_ISOLATED_NETWORK: 'no',\n      ALGO_NODE_WRITE_ONLY: 'yes'\n    };\n  }\n\n  function randlabsProviderEnv(net) {\n    var prefix = net === 'MainNet' ? '' : \"\".concat(net.toLowerCase(), \".\");\n    var RANDLABS_BASE = \"\".concat(prefix, \"algoexplorerapi.io\");\n    return {\n      ALGO_SERVER: \"https://node.\".concat(RANDLABS_BASE),\n      ALGO_PORT: '',\n      ALGO_TOKEN_HEADER: defaultALGO_TOKEN_HEADER,\n      ALGO_TOKEN: '',\n      // TODO: update to just indexer.\n      ALGO_INDEXER_SERVER: \"https://algoindexer.\".concat(RANDLABS_BASE),\n      ALGO_INDEXER_PORT: '',\n      ALGO_INDEXER_TOKEN_HEADER: defaultALGO_INDEXER_TOKEN_HEADER,\n      ALGO_INDEXER_TOKEN: '',\n      REACH_ISOLATED_NETWORK: 'no',\n      ALGO_NODE_WRITE_ONLY: 'yes'\n    };\n  }\n\n  function providerEnvByName(pn) {\n    switch (pn) {\n      case 'MainNet':\n        return algonodeEnv('MainNet');\n      case 'TestNet':\n        return algonodeEnv('TestNet');\n      case 'BetaNet':\n        return algonodeEnv('BetaNet');\n      case 'randlabs/MainNet':\n        return randlabsProviderEnv('MainNet');\n      case 'randlabs/TestNet':\n        return randlabsProviderEnv('TestNet');\n      case 'randlabs/BetaNet':\n        return randlabsProviderEnv('BetaNet');\n      case 'algonode/MainNet':\n        return algonodeEnv('MainNet');\n      case 'algonode/TestNet':\n        return algonodeEnv('TestNet');\n      case 'algonode/BetaNet':\n        return algonodeEnv('BetaNet');\n      case 'LocalHost':\n        return localhostProviderEnv;\n      default:\n        throw Error(\"Unrecognized provider name: \".concat(pn));\n    }\n  }\n\n  function setProviderByName(pn) {\n    return setProviderByEnv(providerEnvByName(pn));\n  }\n  // eslint-disable-next-line max-len\n  var rawFaucetDefaultMnemonic = 'guilt butter canyon devote inflict comfort lumber relief chat key fury absorb reject palm siege draw jelly lyrics melody palace use box joy ability result';\n  var _d = __read(replaceableThunk(function() {\n      return __awaiter(void 0, void 0, void 0, function() {\n        var FAUCET;\n        return __generator(this, function(_a) {\n          switch (_a.label) {\n            case 0:\n              FAUCET = algosdk.mnemonicToSecretKey(envDefault(process.env.ALGO_FAUCET_PASSPHRASE, rawFaucetDefaultMnemonic));\n              return [4 /*yield*/ , connectAccount(FAUCET)];\n            case 1:\n              return [2 /*return*/ , _a.sent()];\n          }\n        });\n      });\n    }), 2),\n    getFaucet = _d[0],\n    setFaucet = _d[1];\n  var str2note = function(x) { return new Uint8Array(Buffer.from(x)); };\n  var NOTE_Reach_str = \"Reach \".concat(VERSION);\n  var NOTE_Reach = str2note(NOTE_Reach_str);\n  var NOTE_Reach_tag = function(tag) { return tag ? str2note(NOTE_Reach_str + \" \".concat(tag, \")\")) : NOTE_Reach; };\n  var makeTransferTxn = function(from, to, value, token, ps, closeTo, tag) {\n    if (closeTo === void 0) { closeTo = undefined; }\n    if (tag === void 0) { tag = undefined; }\n    var valuen = bigNumberToBigInt(value);\n    var note = NOTE_Reach_tag(tag);\n    var txn = token ?\n      algosdk.makeAssetTransferTxnWithSuggestedParams(from, to, closeTo, undefined, valuen, note, bigNumberToNumber(token), ps) :\n      algosdk.makePaymentTxnWithSuggestedParams(from, to, valuen, closeTo, note, ps);\n    return txn;\n  };\n  var transfer = function(from, to, value, token, tag) {\n    if (token === void 0) { token = undefined; }\n    if (tag === void 0) { tag = undefined; }\n    return __awaiter(void 0, void 0, void 0, function() {\n      var sender, receiver, valuebn, ps, txn;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            sender = from.networkAccount;\n            receiver = extractAddr(to);\n            valuebn = bigNumberify(value);\n            return [4 /*yield*/ , getTxnParams('transfer')];\n          case 1:\n            ps = _a.sent();\n            txn = toWTxn(makeTransferTxn(sender.addr, receiver, valuebn, token, ps, undefined, tag));\n            return [4 /*yield*/ , sign_and_send_sync(\"transfer \".concat(j2s(from), \" \").concat(j2s(to), \" \").concat(valuebn), sender, txn)];\n          case 2:\n            return [2 /*return*/ , _a.sent()];\n        }\n      });\n    });\n  };;\n  var makeLogRep = function(evt, tys) {\n    var hLen = 4;\n    var tyns = tys.map(function(ty) { return ty.netName; });\n    var sig = \"\".concat(evt, \"(\").concat(tyns.join(','), \")\");\n    var hu = sha512_256(sig);\n    var hp = hu.slice(0, hLen * 2); // hu is hex nibbles\n    var trunc = function(x) { return ui8h(base64ToUI8A(x).slice(0, hLen)); };\n    debug(\"makeLogRep\", { evt: evt, tyns: tyns, sig: sig, hu: hu, hp: hp });\n    var parse = function(log) {\n      if (trunc(log) !== hp) {\n        return undefined;\n      }\n      debug(\"parse\", { log: log });\n      // @ts-ignore\n      var _a = __read(T_Tuple(__spreadArray([bytestringyNet(hLen)], __read(tys), false)).fromNet(reNetify(log))),\n        logb = _a[0],\n        pd = _a.slice(1);\n      debug(\"parse\", { logb: logb, pd: pd });\n      return pd;\n    };\n    var parse0 = function(txn) {\n      if (txn.logs.length == 0) {\n        return undefined;\n      }\n      var log = txn.logs[0];\n      return parse(log);\n    };\n    var parse0b = function(txn) { return parse0(txn) !== undefined; };\n    return { parse: parse, parse0: parse0, parse0b: parse0b };\n  };\n  var reachEvent = function(i) { return \"_reach_e\".concat(i); };\n  var makeHasLogFor = function(i, tys) {\n    debug(\"hasLogFor\", i, tys);\n    var lr = makeLogRep(reachEvent(i), tys);\n    return lr.parse0b;\n  };\n  /** @description base64->hex->arrayify */\n  var reNetify = function(x) {\n    var s = Buffer.from(x, 'base64').toString('hex');\n    return ethers.utils.arrayify('0x' + s);\n  };\n  var getAccountInfo = function(acc) { return getAddressInfo(extractAddr(acc)); };\n  var getAddressInfo = function(a) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var dhead, client, req, res_1, e_8, indexer, failOk, query, res;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            dhead = 'getAddressInfo';\n            _a.label = 1;\n          case 1:\n            _a.trys.push([1, 5, , 6]);\n            return [4 /*yield*/ , ensureNodeCanRead()];\n          case 2:\n            _a.sent();\n            return [4 /*yield*/ , getAlgodClient()];\n          case 3:\n            client = _a.sent();\n            req = client.accountInformation(a);\n            debug(dhead, req);\n            return [4 /*yield*/ , req[\"do\"]()];\n          case 4:\n            res_1 = (_a.sent());\n            debug(dhead, 'node', res_1);\n            return [2 /*return*/ , res_1];\n          case 5:\n            e_8 = _a.sent();\n            debug(dhead, 'node err', e_8);\n            return [3 /*break*/ , 6];\n          case 6:\n            return [4 /*yield*/ , getIndexer()];\n          case 7:\n            indexer = _a.sent();\n            failOk = function(x) {\n              if (typeof x === 'string' && x.includes('no accounts found for address')) {\n                return {\n                  val: {\n                    'current-round': BigInt(0),\n                    'account': {\n                      'amount': BigInt(0)\n                    }\n                  }\n                };\n              } else {\n                return { exn: x };\n              }\n            };\n            query = indexer.lookupAccountByID(a);\n            return [4 /*yield*/ , doQuery_(dhead, query, 0, failOk)];\n          case 8:\n            res = _a.sent();\n            debug(dhead, res);\n            return [2 /*return*/ , res.account];\n        }\n      });\n    });\n  };\n  var getAssetInfo = function(a) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var dhead, indexer, q, failOk, res;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            dhead = 'getAssetInfo';\n            return [4 /*yield*/ , getIndexer()];\n          case 1:\n            indexer = _a.sent();\n            q = indexer.lookupAssetByID(a);\n            failOk = function(x) {\n              if (typeof x === 'string' && x.includes('no assets found for asset-id')) {\n                throw Error(\"Asset \".concat(a, \" does not exist\"));\n              } else {\n                return { exn: x };\n              }\n            };\n            return [4 /*yield*/ , doQuery_(dhead, q, 0, failOk)];\n          case 2:\n            res = _a.sent();\n            debug(dhead, res);\n            return [2 /*return*/ , res.asset];\n        }\n      });\n    });\n  };\n  var getApplicationInfoM = function(idn) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var id, dhead, client, res, e_9, indexer, query, queryRes;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            id = bigNumberToNumber(idn);\n            dhead = 'getApplicationInfo';\n            _a.label = 1;\n          case 1:\n            _a.trys.push([1, 5, , 6]);\n            return [4 /*yield*/ , ensureNodeCanRead()];\n          case 2:\n            _a.sent();\n            return [4 /*yield*/ , getAlgodClient()];\n          case 3:\n            client = _a.sent();\n            return [4 /*yield*/ , client.getApplicationByID(id)[\"do\"]()];\n          case 4:\n            res = (_a.sent());\n            debug(dhead, 'node', res);\n            return [2 /*return*/ , { val: res }];\n          case 5:\n            e_9 = _a.sent();\n            debug(dhead, 'node err', e_9);\n            return [3 /*break*/ , 6];\n          case 6:\n            return [4 /*yield*/ , getIndexer()];\n          case 7:\n            indexer = _a.sent();\n            query = indexer.lookupApplications(id)\n              .includeAll(true);\n            return [4 /*yield*/ , doQueryM_(dhead, query)];\n          case 8:\n            queryRes = _a.sent();\n            if ('val' in queryRes) {\n              debug(dhead, { application: queryRes.val.application });\n              // If application was deleted, synthesize AppInfo from transaction data\n              return [2 /*return*/ , queryRes.val.application.deleted ? getDeletedApplicationInfoM(id) : { val: queryRes.val.application }];\n            } else {\n              return [2 /*return*/ , queryRes];\n            }\n            return [2 /*return*/ ];\n        }\n      });\n    });\n  };\n  var getDeletedApplicationInfoM = function(id) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var dhead, indexer, query, queryRes, txn, appTxn;\n      var _a;\n      return __generator(this, function(_b) {\n        switch (_b.label) {\n          case 0:\n            dhead = 'getDeletedApplicationInfoM';\n            return [4 /*yield*/ , getIndexer()];\n          case 1:\n            indexer = _b.sent();\n            query = indexer.searchForTransactions()\n              // .txType('appl')\n              .applicationID(id)\n              .limit(1);\n            return [4 /*yield*/ , doQueryM_(dhead, query)];\n          case 2:\n            queryRes = _b.sent();\n            if ('val' in queryRes) {\n              if (queryRes.val.transactions.length === 0) {\n                return [2 /*return*/ , { exn: 'application does not exist' }];\n              }\n              txn = queryRes.val.transactions[0];\n              appTxn = txn['application-transaction'];\n              debug(dhead, { appTxn: appTxn });\n              if (txn['tx-type'] !== 'appl' ||\n                appTxn === undefined ||\n                txn['created-application-index'] !== BigInt(id) ||\n                appTxn['application-id'] !== BigInt(0) ||\n                appTxn['approval-program'] === undefined ||\n                appTxn['clear-state-program'] === undefined ||\n                appTxn['local-state-schema'] === undefined ||\n                appTxn['global-state-schema'] === undefined) {\n                return [2 /*return*/ , { exn: 'tried to synthesize AppInfo from deployment transaction, but the deployment transaction was wrong' }];\n              }\n              return [2 /*return*/ , {\n                val: {\n                  'id': txn['created-application-index'],\n                  'created-at-round': txn['confirmed-round'],\n                  'deleted': true,\n                  'params': {\n                    'creator': txn['sender'],\n                    'approval-program': appTxn['approval-program'],\n                    'clear-state-program': appTxn['clear-state-program'],\n                    'local-state-schema': appTxn['local-state-schema'],\n                    'global-state-schema': appTxn['global-state-schema'],\n                    'global-state': [],\n                    'extra-program-pages': (_a = appTxn['extra-program-pages']) !== null && _a !== void 0 ? _a : BigInt(0)\n                  }\n                }\n              }];\n            } else {\n              return [2 /*return*/ , queryRes];\n            }\n            return [2 /*return*/ ];\n        }\n      });\n    });\n  };\n  var connectAccount = function(networkAccount) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      function setDebugLabel(newLabel) {\n        label = newLabel;\n        debug(\"setDebugLabel\", { newLabel: newLabel, pks: pks });\n        // @ts-ignore\n        return this;\n      }\n      var thisAcc, label, pks, createTag, selfAddress, iam, contract, me_na, tokenAccepted, tokenAccept, tokenMetadata, unsupportedAcc, accObj, acc, balanceOf_, balancesOf_;\n      return __generator(this, function(_a) {\n        thisAcc = networkAccount;\n        label = thisAcc.addr.substring(2, 6);\n        pks = T_Address.canonicalize(thisAcc);\n        debug(label, 'connectAccount');\n        createTag = 0;\n        selfAddress = function() {\n          return pks;\n        };\n        iam = function(some_addr) {\n          if (some_addr === pks) {\n            return some_addr;\n          } else {\n            throw Error(\"I should be \".concat(some_addr, \", but am \").concat(pks));\n          }\n        };\n        contract = function(bin, givenInfoP) {\n          ensureConnectorAvailable(bin, 'ALGO', reachBackendVersion, reachAlgoBackendVersion);\n          must_be_supported(bin);\n          var _a = bin._Connectors.ALGO,\n            stateSize = _a.stateSize,\n            stateKeys = _a.stateKeys,\n            mapDataKeys = _a.mapDataKeys,\n            mapDataSize = _a.mapDataSize,\n            ABI = _a.ABI,\n            companionInfo = _a.companionInfo;\n          var hasCompanion = companionInfo !== null;\n          var hasMaps = mapDataKeys > 0;\n          var mapDataTy = bin._getMaps({ reachStdlib: stdlib }).mapDataTy;\n          var emptyMapDataTy = T_Bytes(mapDataTy.netSize);\n          var emptyMapData =\n            // This is a bunch of Nones\n            mapDataTy.fromNet(emptyMapDataTy.toNet(emptyMapDataTy.canonicalize('')));\n          debug({ emptyMapData: emptyMapData });\n          var makeGetC = function(setupViewArgs, eq) {\n            var getInfo = setupViewArgs.getInfo;\n            var _theC = undefined;\n            return function() {\n              return __awaiter(void 0, void 0, void 0, function() {\n                var ctcInfo, _a, ApplicationID, Deployer, ctcAddr, getLocalState, didOptIn, doOptIn, ensuredOptIn, ensureOptIn, lastAppState, lastAppStateTime, getAppState, getAppStateFresh, getGlobalState, canIWin, isin, isIsolatedNetwork, viewMapRef;\n                return __generator(this, function(_b) {\n                  switch (_b.label) {\n                    case 0:\n                      debug(label, 'getC');\n                      if (_theC) {\n                        debug(label, 'getC', 'ret');\n                        return [2 /*return*/ , _theC];\n                      }\n                      debug(label, 'getC', 'wait');\n                      return [4 /*yield*/ , getInfo()];\n                    case 1:\n                      ctcInfo = _b.sent();\n                      return [4 /*yield*/ , stdVerifyContract(setupViewArgs, (function() {\n                        return __awaiter(void 0, void 0, void 0, function() {\n                          return __generator(this, function(_a) {\n                            switch (_a.label) {\n                              case 0:\n                                return [4 /*yield*/ , verifyContract_(label, ctcInfo, bin, eq)];\n                              case 1:\n                                return [2 /*return*/ , _a.sent()];\n                            }\n                          });\n                        });\n                      }))];\n                    case 2:\n                      _a = _b.sent(), ApplicationID = _a.ApplicationID, Deployer = _a.Deployer;\n                      if (!eq.isInited()) {\n                        eq.init({ ApplicationID: ApplicationID });\n                        eq.pushIgnore(isCreateTxn);\n                      }\n                      debug(label, 'getC', { ApplicationID: ApplicationID });\n                      ctcAddr = algosdk.getApplicationAddress(bigNumberToBigInt(ApplicationID));\n                      debug(label, 'getC', { ctcAddr: ctcAddr });\n                      getLocalState = function(addr) {\n                        return __awaiter(void 0, void 0, void 0, function() {\n                          var dhead, client, query, accAppInfo, indexer, query, appLocalStatesRes, appsLocalStates, appLocalState;\n                          var _a, _b;\n                          return __generator(this, function(_c) {\n                            switch (_c.label) {\n                              case 0:\n                                dhead = 'getLocalState';\n                                return [4 /*yield*/ , nodeCanRead()];\n                              case 1:\n                                if (!_c.sent()) return [3 /*break*/ , 4];\n                                return [4 /*yield*/ , getAlgodClient()];\n                              case 2:\n                                client = _c.sent();\n                                query = client.accountApplicationInformation(addr, bigNumberToNumber(ApplicationID));\n                                return [4 /*yield*/ , doQuery_('contract.getLocalState', query, 0, function(_) { return { val: undefined }; })];\n                              case 3:\n                                accAppInfo = _c.sent();\n                                return [2 /*return*/ , (_a = accAppInfo === null || accAppInfo === void 0 ? void 0 : accAppInfo['app-local-state']) === null || _a === void 0 ? void 0 : _a['key-value']];\n                              case 4:\n                                return [4 /*yield*/ , getIndexer()];\n                              case 5:\n                                indexer = _c.sent();\n                                query = indexer\n                                  .lookupAccountAppLocalStates(addr)\n                                  .applicationID(bigNumberToNumber(ApplicationID));\n                                return [4 /*yield*/ , doQuery_(dhead, query)];\n                              case 6:\n                                appLocalStatesRes = _c.sent();\n                                appsLocalStates = (_b = appLocalStatesRes['apps-local-states']) !== null && _b !== void 0 ? _b : [];\n                                appLocalState = appsLocalStates.find(function(app) { return ApplicationID.eq(app['id']); });\n                                return [2 /*return*/ , appLocalState === null || appLocalState === void 0 ? void 0 : appLocalState['key-value']];\n                            }\n                          });\n                        });\n                      };\n                      didOptIn = function() {\n                        return __awaiter(void 0, void 0, void 0, function() {\n                          return __generator(this, function(_a) {\n                            switch (_a.label) {\n                              case 0:\n                                return [4 /*yield*/ , getLocalState(thisAcc.addr)];\n                              case 1:\n                                return [2 /*return*/ , ((_a.sent()) !== undefined)];\n                            }\n                          });\n                        });\n                      };\n                      doOptIn = function() {\n                        return __awaiter(void 0, void 0, void 0, function() {\n                          var dhead, _a, _b, _c, _d, _e, _f;\n                          return __generator(this, function(_g) {\n                            switch (_g.label) {\n                              case 0:\n                                dhead = \"\".concat(label, \" doOptIn\");\n                                debug(dhead);\n                                _a = sign_and_send_sync;\n                                _b = [dhead,\n                                  thisAcc\n                                ];\n                                _c = toWTxn;\n                                _e = (_d = algosdk).makeApplicationOptInTxn;\n                                _f = [thisAcc.addr];\n                                return [4 /*yield*/ , getTxnParams(dhead)];\n                              case 1:\n                                return [4 /*yield*/ , _a.apply(void 0, _b.concat([_c.apply(void 0, [_e.apply(_d, _f.concat([_g.sent(), bigNumberToNumber(ApplicationID),\n                                  undefined, undefined, undefined, undefined,\n                                  NOTE_Reach\n                                ]))])]))];\n                              case 2:\n                                _g.sent();\n                                return [2 /*return*/ ];\n                            }\n                          });\n                        });\n                      };\n                      ensuredOptIn = false;\n                      ensureOptIn = function() {\n                        return __awaiter(void 0, void 0, void 0, function() {\n                          return __generator(this, function(_a) {\n                            switch (_a.label) {\n                              case 0:\n                                if (!!ensuredOptIn) return [3 /*break*/ , 4];\n                                return [4 /*yield*/ , didOptIn()];\n                              case 1:\n                                if (!!(_a.sent())) return [3 /*break*/ , 3];\n                                return [4 /*yield*/ , doOptIn()];\n                              case 2:\n                                _a.sent();\n                                _a.label = 3;\n                              case 3:\n                                ensuredOptIn = true;\n                                _a.label = 4;\n                              case 4:\n                                return [2 /*return*/ ];\n                            }\n                          });\n                        });\n                      };\n                      lastAppState = undefined;\n                      lastAppStateTime = 0;\n                      getAppState = function() {\n                        return __awaiter(void 0, void 0, void 0, function() {\n                          var now, minMillis;\n                          return __generator(this, function(_a) {\n                            switch (_a.label) {\n                              case 0:\n                                now = Date.now();\n                                minMillis = isIsolatedNetwork() ? 0 : appStateMinRefreshMillis;\n                                if (lastAppState && now - lastAppStateTime < minMillis) {\n                                  debug('getAppState cached');\n                                  return [2 /*return*/ , lastAppState];\n                                }\n                                return [4 /*yield*/ , getAppStateFresh()];\n                              case 1:\n                                lastAppState = _a.sent();\n                                lastAppStateTime = now;\n                                return [2 /*return*/ , lastAppState];\n                            }\n                          });\n                        });\n                      };\n                      getAppStateFresh = function() {\n                        return __awaiter(void 0, void 0, void 0, function() {\n                          var lab, appInfoM, appInfo, appSt;\n                          return __generator(this, function(_a) {\n                            switch (_a.label) {\n                              case 0:\n                                lab = \"getAppStateFresh\";\n                                return [4 /*yield*/ , getApplicationInfoM(ApplicationID)];\n                              case 1:\n                                appInfoM = _a.sent();\n                                if ('exn' in appInfoM || appInfoM.val.deleted) {\n                                  return [2 /*return*/ , undefined];\n                                }\n                                appInfo = appInfoM.val;\n                                appSt = appInfo['params']['global-state'];\n                                debug(lab, { appSt: appSt });\n                                return [2 /*return*/ , appSt];\n                            }\n                          });\n                        });\n                      };\n                      getGlobalState = function(appSt_g) {\n                        return __awaiter(void 0, void 0, void 0, function() {\n                          var appSt, _a, gsbs, mCompanion, gty;\n                          return __generator(this, function(_b) {\n                            switch (_b.label) {\n                              case 0:\n                                _a = appSt_g;\n                                if (_a) return [3 /*break*/ , 2];\n                                return [4 /*yield*/ , getAppState()];\n                              case 1:\n                                _a = (_b.sent());\n                                _b.label = 2;\n                              case 2:\n                                appSt = _a;\n                                if (!appSt) {\n                                  return [2 /*return*/ , undefined];\n                                }\n                                gsbs = readStateBytes('', [], appSt);\n                                if (!gsbs) {\n                                  return [2 /*return*/ , undefined];\n                                }\n                                mCompanion = hasCompanion ? [T_Contract] : [];\n                                gty = T_Tuple(__spreadArray([T_UInt, T_UInt], __read(mCompanion), false));\n                                // @ts-ignore\n                                return [2 /*return*/ , gty.fromNet(gsbs)];\n                            }\n                          });\n                        });\n                      };\n                      canIWin = function(lct) {\n                        return __awaiter(void 0, void 0, void 0, function() {\n                          var gs, r;\n                          return __generator(this, function(_a) {\n                            switch (_a.label) {\n                              case 0:\n                                if (lct.eq(0)) {\n                                  return [2 /*return*/ , true];\n                                }\n                                return [4 /*yield*/ , getGlobalState()];\n                              case 1:\n                                gs = _a.sent();\n                                r = !gs || lct.eq(gs[1]);\n                                debug(\"canIWin\", { lct: lct, gs: gs, r: r });\n                                return [2 /*return*/ , r];\n                            }\n                          });\n                        });\n                      };\n                      return [4 /*yield*/ , getProvider()];\n                    case 3:\n                      isin = (_b.sent()).isIsolatedNetwork;\n                      isIsolatedNetwork = function() { return isin; };\n                      viewMapRef = function(mapi, a) {\n                        return __awaiter(void 0, void 0, void 0, function() {\n                          var ls, mbs, md, mr;\n                          return __generator(this, function(_a) {\n                            switch (_a.label) {\n                              case 0:\n                                debug('viewMapRef', { mapi: mapi, a: a });\n                                return [4 /*yield*/ , getLocalState(cbr2algo_addr(a))];\n                              case 1:\n                                ls = _a.sent();\n                                if (ls === undefined) {\n                                  return [2 /*return*/ , ['None', null]];\n                                }\n                                debug('viewMapRef', { ls: ls });\n                                mbs = recoverSplitBytes('m', mapDataSize, mapDataKeys, ls);\n                                debug('viewMapRef', { mbs: mbs });\n                                if (mbs === undefined) {\n                                  return [2 /*return*/ , ['None', null]];\n                                }\n                                md = mapDataTy.fromNet(mbs);\n                                debug('viewMapRef', { md: md });\n                                mr = md[mapi];\n                                assert(mr !== undefined, 'viewMapRef mr undefined');\n                                return [2 /*return*/ , mr];\n                            }\n                          });\n                        });\n                      };\n                      return [2 /*return*/ , (_theC = { ApplicationID: ApplicationID, ctcAddr: ctcAddr, Deployer: Deployer, getAppState: getAppState, getGlobalState: getGlobalState, ensureOptIn: ensureOptIn, canIWin: canIWin, isIsolatedNetwork: isIsolatedNetwork, viewMapRef: viewMapRef })];\n                  }\n                });\n              });\n            };\n          };\n          var getCurrentStep_ = function(ch) {\n            return __awaiter(void 0, void 0, void 0, function() {\n              var getAppState, getGlobalState, appSt, gs;\n              return __generator(this, function(_a) {\n                switch (_a.label) {\n                  case 0:\n                    getAppState = ch.getAppState, getGlobalState = ch.getGlobalState;\n                    return [4 /*yield*/ , getAppState()];\n                  case 1:\n                    appSt = _a.sent();\n                    if (!appSt) {\n                      throw Error(\"getCurrentStep_: no appSt\");\n                    }\n                    return [4 /*yield*/ , getGlobalState(appSt)];\n                  case 2:\n                    gs = _a.sent();\n                    if (!gs) {\n                      throw Error(\"getCurrentStep_: no gs\");\n                    }\n                    return [2 /*return*/ , gs[0]];\n                }\n              });\n            });\n          };\n          var getState_ = function(getC, lookup) {\n            return __awaiter(void 0, void 0, void 0, function() {\n              var _a, getAppState, getGlobalState, appSt, gs, vvn, vi, vtys, vty, vvs;\n              return __generator(this, function(_b) {\n                switch (_b.label) {\n                  case 0:\n                    return [4 /*yield*/ , getC()];\n                  case 1:\n                    _a = _b.sent(), getAppState = _a.getAppState, getGlobalState = _a.getGlobalState;\n                    return [4 /*yield*/ , getAppState()];\n                  case 2:\n                    appSt = _b.sent();\n                    if (!appSt) {\n                      throw Error(\"getState: no appSt\");\n                    }\n                    return [4 /*yield*/ , getGlobalState(appSt)];\n                  case 3:\n                    gs = _b.sent();\n                    if (!gs) {\n                      throw Error(\"getState: no gs\");\n                    }\n                    debug('getState_', { gs: gs });\n                    vvn = recoverSplitBytes('v', stateSize, stateKeys, appSt);\n                    if (vvn === undefined) {\n                      throw Error(\"getState: no vvn\");\n                    }\n                    vi = gs[0];\n                    vtys = lookup(vi);\n                    vty = T_Tuple(vtys);\n                    vvs = vty.fromNet(vvn);\n                    debug(\"getState_\", { vvn: vvn, vvs: vvs });\n                    return [2 /*return*/ , [gs[2], vvs]];\n                }\n              });\n            });\n          };\n          var _setup = function(setupArgs) {\n            var setInfo = setupArgs.setInfo,\n              setTrustedVerifyResult = setupArgs.setTrustedVerifyResult;\n            var eq = newEventQueue();\n            var getC = makeGetC(setupArgs, eq);\n            var companionApp = undefined;\n            // Returns address of a Reach contract\n            var getContractAddress = function() {\n              return __awaiter(void 0, void 0, void 0, function() {\n                var ctcAddr;\n                return __generator(this, function(_a) {\n                  switch (_a.label) {\n                    case 0:\n                      return [4 /*yield*/ , getC()];\n                    case 1:\n                      ctcAddr = (_a.sent()).ctcAddr;\n                      return [2 /*return*/ , T_Address.canonicalize(ctcAddr)];\n                  }\n                });\n              });\n            };\n            var getContractInfo = function() {\n              return __awaiter(void 0, void 0, void 0, function() {\n                var ApplicationID;\n                return __generator(this, function(_a) {\n                  switch (_a.label) {\n                    case 0:\n                      return [4 /*yield*/ , getC()];\n                    case 1:\n                      ApplicationID = (_a.sent()).ApplicationID;\n                      return [2 /*return*/ , ApplicationID];\n                  }\n                });\n              });\n            };\n            var getContractCompanion = function() {\n              return __awaiter(void 0, void 0, void 0, function() {\n                return __generator(this, function(_a) {\n                  if (hasCompanion) {\n                    return [2 /*return*/ , ['None', null]];\n                  } else {\n                    // @ts-ignore\n                    return [2 /*return*/ , ['Some', companionApp]];\n                  }\n                  return [2 /*return*/ ];\n                });\n              });\n            };\n            var getCurrentStep = function() {\n              return __awaiter(void 0, void 0, void 0, function() {\n                var _a;\n                return __generator(this, function(_b) {\n                  switch (_b.label) {\n                    case 0:\n                      _a = getCurrentStep_;\n                      return [4 /*yield*/ , getC()];\n                    case 1:\n                      return [4 /*yield*/ , _a.apply(void 0, [_b.sent()])];\n                    case 2:\n                      return [2 /*return*/ , _b.sent()];\n                  }\n                });\n              });\n            };\n            var getState = function(vibne, vtys) {\n              return __awaiter(void 0, void 0, void 0, function() {\n                var _a, ci, ans;\n                return __generator(this, function(_b) {\n                  switch (_b.label) {\n                    case 0:\n                      debug('getState');\n                      return [4 /*yield*/ , getState_(getC, function(vibna) {\n                        if (vibne.eq(vibna)) {\n                          return vtys;\n                        }\n                        throw apiStateMismatchError(bin, vibne, vibna);\n                      })];\n                    case 1:\n                      _a = __read.apply(void 0, [_b.sent(), 2]), ci = _a[0], ans = _a[1];\n                      companionApp = ci;\n                      return [2 /*return*/ , ans];\n                  }\n                });\n              });\n            };\n            var apiMapRef = function(i, ty) {\n              return function(f) {\n                return __awaiter(void 0, void 0, void 0, function() {\n                  var viewMapRef;\n                  return __generator(this, function(_a) {\n                    switch (_a.label) {\n                      case 0:\n                        void(ty);\n                        return [4 /*yield*/ , getC()];\n                      case 1:\n                        viewMapRef = (_a.sent()).viewMapRef;\n                        return [4 /*yield*/ , viewMapRef(i, f)];\n                      case 2:\n                        return [2 /*return*/ , _a.sent()];\n                    }\n                  });\n                });\n              };\n            };\n            var simTokenAccepted = function(sim_r, addr, tok) {\n              return __awaiter(void 0, void 0, void 0, function() {\n                return __generator(this, function(_a) {\n                  switch (_a.label) {\n                    case 0:\n                      simTokenAccepted_(sim_r, addr, tok);\n                      return [4 /*yield*/ , balanceOfMNonNet(addr, tok)];\n                    case 1:\n                      return [2 /*return*/ , (_a.sent()) !== false];\n                  }\n                });\n              });\n            };\n            var sendrecv = function(srargs) {\n              return __awaiter(void 0, void 0, void 0, function() {\n                var funcNum, evt_cnt, lct, tys, args, pay, out_tys, onlyIf, soloSend, timeoutAt, sim_p, isCtor, doRecv, funcName, dhead, trustedRecv, _a, appApproval, appClear, extraPages, Deployer_1, createRes, _b, _c, _d, _e, _f, _g, ai, ApplicationID_1, ctcInfo, _h, ApplicationID, ctcAddr, Deployer, ensureOptIn, canIWin, isIsolatedNetwork, _j, value, toks, curTime, curSecs, _k, _svs, msg, _l, _svs_tys, msg_tys, fake_res, sim_r, amt, isHalt, mapRefs, _loop_1, state_1;\n                return __generator(this, function(_m) {\n                  switch (_m.label) {\n                    case 0:\n                      funcNum = srargs.funcNum, evt_cnt = srargs.evt_cnt, lct = srargs.lct, tys = srargs.tys, args = srargs.args, pay = srargs.pay, out_tys = srargs.out_tys, onlyIf = srargs.onlyIf, soloSend = srargs.soloSend, timeoutAt = srargs.timeoutAt, sim_p = srargs.sim_p;\n                      isCtor = (funcNum === 0);\n                      doRecv = function(didSend, waitIfNotPresent, msg) {\n                        return __awaiter(void 0, void 0, void 0, function() {\n                          return __generator(this, function(_a) {\n                            switch (_a.label) {\n                              case 0:\n                                debug(dhead, \"doRecv\", msg);\n                                if (!didSend && lct.eq(0)) {\n                                  throw new Error(\"API call failed: \".concat(msg));\n                                }\n                                return [4 /*yield*/ , recv({ funcNum: funcNum, evt_cnt: evt_cnt, out_tys: out_tys, didSend: didSend, waitIfNotPresent: waitIfNotPresent, timeoutAt: timeoutAt })];\n                              case 1:\n                                return [2 /*return*/ , _a.sent()];\n                            }\n                          });\n                        });\n                      };\n                      funcName = \"m\".concat(funcNum);\n                      dhead = \"\".concat(label, \": sendrecv \").concat(funcName, \" \").concat(timeoutAt);\n                      if (!!onlyIf) return [3 /*break*/ , 2];\n                      return [4 /*yield*/ , doRecv(false, true, \"onlyIf false\")];\n                    case 1:\n                      return [2 /*return*/ , _m.sent()];\n                    case 2:\n                      trustedRecv = function(txn) {\n                        return __awaiter(void 0, void 0, void 0, function() {\n                          var didSend, correctStep;\n                          return __generator(this, function(_a) {\n                            switch (_a.label) {\n                              case 0:\n                                didSend = true;\n                                correctStep = makeHasLogFor(funcNum, out_tys);\n                                eq.pushIgnore(function(x) { return correctStep(indexerTxn2RecvTxn(x)); });\n                                return [4 /*yield*/ , recvFrom({ dhead: dhead, out_tys: out_tys, didSend: didSend, funcNum: funcNum, txn: txn })];\n                              case 1:\n                                return [2 /*return*/ , _a.sent()];\n                            }\n                          });\n                        });\n                      };\n                      if (!isCtor) return [3 /*break*/ , 5];\n                      debug(dhead, 'deploy');\n                      must_be_supported(bin);\n                      _a = bin._Connectors.ALGO, appApproval = _a.appApproval, appClear = _a.appClear, extraPages = _a.extraPages;\n                      debug(dhead, \"deploy\", { extraPages: extraPages });\n                      Deployer_1 = thisAcc.addr;\n                      _b = sign_and_send_sync;\n                      _c = ['ApplicationCreate',\n                        thisAcc\n                      ];\n                      _d = toWTxn;\n                      _f = (_e = algosdk).makeApplicationCreateTxn;\n                      _g = [Deployer_1];\n                      return [4 /*yield*/ , getTxnParams(dhead)];\n                    case 3:\n                      return [4 /*yield*/ , _b.apply(void 0, _c.concat([_d.apply(void 0, [_f.apply(_e, _g.concat([_m.sent(), algosdk.OnApplicationComplete.NoOpOC,\n                        base64ToUI8A(appApproval),\n                        base64ToUI8A(appClear),\n                        appLocalStateNumUInt, appLocalStateNumBytes + mapDataKeys,\n                        appGlobalStateNumUInt, appGlobalStateNumBytes + stateKeys,\n                        undefined, undefined, undefined, undefined,\n                        NOTE_Reach_tag(createTag++), undefined, undefined, extraPages\n                      ]))])]))];\n                    case 4:\n                      createRes = _m.sent();\n                      ai = createRes['created-application-index'];\n                      if (!ai) {\n                        throw Error(\"No created-application-index in \".concat(j2s(createRes)));\n                      }\n                      ApplicationID_1 = bigNumberify(ai);\n                      debug(label, \"created\", { ApplicationID: ApplicationID_1 });\n                      ctcInfo = ApplicationID_1;\n                      setTrustedVerifyResult({ ApplicationID: ApplicationID_1, Deployer: Deployer_1 });\n                      setInfo(ctcInfo);\n                      _m.label = 5;\n                    case 5:\n                      return [4 /*yield*/ , getC()];\n                    case 6:\n                      _h = _m.sent(), ApplicationID = _h.ApplicationID, ctcAddr = _h.ctcAddr, Deployer = _h.Deployer, ensureOptIn = _h.ensureOptIn, canIWin = _h.canIWin, isIsolatedNetwork = _h.isIsolatedNetwork;\n                      _j = __read(pay, 2), value = _j[0], toks = _j[1];\n                      void(toks); // <-- rely on simulation because of ordering\n                      debug(dhead, '--- START');\n                      return [4 /*yield*/ , getNetworkTime()];\n                    case 7:\n                      curTime = _m.sent();\n                      return [4 /*yield*/ , getTimeSecs(curTime)];\n                    case 8:\n                      curSecs = _m.sent();\n                      _k = __read(argsSplit(args, evt_cnt), 2), _svs = _k[0], msg = _k[1];\n                      _l = __read(argsSplit(tys, evt_cnt), 2), _svs_tys = _l[0], msg_tys = _l[1];\n                      void(_svs);\n                      void(_svs_tys);\n                      fake_res = {\n                        didSend: true,\n                        didTimeout: false,\n                        data: msg,\n                        time: curTime,\n                        secs: curSecs,\n                        value: value,\n                        from: pks,\n                        getOutput: (function(o_mode, o_lab, o_ctc, o_val) {\n                          return __awaiter(void 0, void 0, void 0, function() {\n                            return __generator(this, function(_a) {\n                              void(o_mode);\n                              void(o_lab);\n                              void(o_val);\n                              return [2 /*return*/ , o_ctc.defaultValue];\n                            });\n                          });\n                        })\n                      };\n                      return [4 /*yield*/ , sim_p(fake_res)];\n                    case 9:\n                      sim_r = _m.sent();\n                      debug(dhead, '--- SIMULATE', sim_r);\n                      if (isCtor) {\n                        amt = hasCompanion ?\n                          minimumBalance.mul(2) :\n                          minimumBalance;\n                        sim_r.txns.unshift({\n                          kind: 'to',\n                          amt: amt,\n                          tok: undefined\n                        });\n                      }\n                      isHalt = sim_r.isHalt;\n                      if (!hasMaps) return [3 /*break*/ , 11];\n                      return [4 /*yield*/ , ensureOptIn()];\n                    case 10:\n                      _m.sent();\n                      _m.label = 11;\n                    case 11:\n                      mapRefs = sim_r.mapRefs;\n                      _loop_1 = function() {\n                        var params, _o, _p, _q, mapAccts, recordAccount_, recordAccount, foreignArr, recordApp, assetsArr, recordAsset, extraFees, howManyMoreFees, txnExtraTxns, sim_i, whichApi, processRemote, processSimTxn, addCompanion, readCI, companionCalls, mapAcctsVal, assetsVal, foreignVal, actual_args, actual_tys, safe_args, whichAppl, txnAppl, rtxns, wtxns, res, e_10, jes, _r, _s;\n                        return __generator(this, function(_t) {\n                          switch (_t.label) {\n                            case 0:\n                              return [4 /*yield*/ , getTxnParams(dhead)];\n                            case 1:\n                              params = _t.sent();\n                              // We add one, because the firstRound field is actually the current\n                              // round, which we couldn't possibly be in, because it already\n                              // happened.\n                              debug(dhead, '--- TIMECHECK', { params: params, timeoutAt: timeoutAt });\n                              return [4 /*yield*/ , checkTimeout(isIsolatedNetwork, getTimeSecs, timeoutAt, bigNumberify(params.firstRound).add(1))];\n                            case 2:\n                              if (!_t.sent()) return [3 /*break*/ , 4];\n                              _o = {};\n                              return [4 /*yield*/ , doRecv(false, false, \"timeout\")];\n                            case 3:\n                              return [2 /*return*/ , (_o.value = _t.sent(), _o)];\n                            case 4:\n                              _p = !soloSend;\n                              if (!_p) return [3 /*break*/ , 6];\n                              return [4 /*yield*/ , canIWin(lct)];\n                            case 5:\n                              _p = !(_t.sent());\n                              _t.label = 6;\n                            case 6:\n                              if (!_p) return [3 /*break*/ , 8];\n                              _q = {};\n                              return [4 /*yield*/ , doRecv(false, false, \"cannot win \".concat(lct))];\n                            case 7:\n                              return [2 /*return*/ , (_q.value = _t.sent(), _q)];\n                            case 8:\n                              debug(dhead, '--- ASSEMBLE w/', params);\n                              mapAccts = [];\n                              recordAccount_ = function(addr) {\n                                if (addressEq(thisAcc.addr, addr)) {\n                                  return;\n                                }\n                                var addrIdx = mapAccts.findIndex(function(other) { return addressEq(other, addr); });\n                                var present = addrIdx !== -1;\n                                if (present) {\n                                  return;\n                                }\n                                mapAccts.push(addr);\n                              };\n                              recordAccount = function(caddr) {\n                                debug(\"recordAccount\", { caddr: caddr });\n                                var addr = cbr2algo_addr(caddr);\n                                debug(\"recordAccount\", { addr: addr });\n                                recordAccount_(addr);\n                              };\n                              mapRefs.forEach(recordAccount);\n                              foreignArr = [];\n                              recordApp = function(app) {\n                                var appn = bigNumberToNumber(app);\n                                if (!foreignArr.includes(appn)) {\n                                  foreignArr.push(appn);\n                                  var addr = algosdk.getApplicationAddress(bigNumberToBigInt(app));\n                                  recordAccount_(addr);\n                                }\n                              };\n                              assetsArr = [];\n                              recordAsset = function(tok) {\n                                if (tok) {\n                                  var tokn = bigNumberToNumber(tok);\n                                  if (!assetsArr.includes(tokn)) {\n                                    assetsArr.push(tokn);\n                                  }\n                                }\n                              };\n                              extraFees = 0;\n                              howManyMoreFees = 0;\n                              txnExtraTxns = [];\n                              sim_i = 0;\n                              processRemote = function(dr) {\n                                dr.toks.map(recordAsset);\n                                dr.accs.map(recordAccount);\n                                dr.apps.map(recordApp);\n                                howManyMoreFees +=\n                                  1 +\n                                  bigNumberToNumber(dr.pays) +\n                                  bigNumberToNumber(dr.bills) +\n                                  bigNumberToNumber(dr.fees);\n                                return;\n                              };\n                              processSimTxn = function(t) {\n                                var txn;\n                                if (t.kind === 'contractNew') {\n                                  processSimTxn({\n                                    kind: 'to',\n                                    amt: minimumBalance_app_create(t.cns[connector]),\n                                    tok: undefined\n                                  });\n                                  processRemote(t.remote);\n                                  return;\n                                } else if (t.kind === 'tokenNew') {\n                                  processSimTxn({\n                                    kind: 'to',\n                                    amt: minimumBalance,\n                                    tok: undefined\n                                  });\n                                  howManyMoreFees++;\n                                  return;\n                                } else if (t.kind === 'tokenBurn') {\n                                  // There's no burning on Algorand\n                                  return;\n                                } else if (t.kind === 'tokenDestroy') {\n                                  recordAsset(t.tok);\n                                  howManyMoreFees++;\n                                  return;\n                                } else if (t.kind === 'tokenAccepted') {\n                                  recordAsset(t.tok);\n                                  recordAccount(t.addr);\n                                  return;\n                                } else if (t.kind === 'remote') {\n                                  recordApp(t.obj);\n                                  processRemote(t.remote);\n                                  return;\n                                } else if (t.kind === 'api') {\n                                  whichApi = t.who;\n                                  return;\n                                } else {\n                                  var tok = t.tok;\n                                  var amt = bigNumberify(0);\n                                  var from = ctcAddr;\n                                  var to = ctcAddr;\n                                  var closeTo = undefined;\n                                  if (t.kind === 'from') {\n                                    recordAsset(tok);\n                                    recordAccount(t.to);\n                                    howManyMoreFees++;\n                                    return;\n                                  } else if (t.kind === 'init') {\n                                    processSimTxn({\n                                      kind: 'to',\n                                      amt: minimumBalance,\n                                      tok: undefined\n                                    });\n                                    recordAsset(tok);\n                                    howManyMoreFees++;\n                                    return;\n                                  } else if (t.kind === 'halt') {\n                                    if (tok) {\n                                      recordAsset(tok);\n                                    }\n                                    recordAccount_(Deployer);\n                                    howManyMoreFees++;\n                                    return;\n                                  } else if (t.kind === 'to') {\n                                    from = thisAcc.addr;\n                                    to = ctcAddr;\n                                    amt = t.amt;\n                                  } else if (t.kind === 'info') {\n                                    recordAsset(tok);\n                                    return;\n                                  } else {\n                                    assert(false, 'sim txn kind');\n                                  }\n                                  txn = makeTransferTxn(from, to, amt, tok, params, closeTo, sim_i++);\n                                }\n                                extraFees += txn.fee;\n                                txn.fee = 0;\n                                txnExtraTxns.push(txn);\n                              };\n                              sim_r.txns.forEach(processSimTxn);\n                              if (hasCompanion) {\n                                if (isCtor) {\n                                  // XXX Algorand says I won't need this eventually\n                                  recordApp(bigNumberify(0));\n                                  howManyMoreFees++;\n                                }\n                                addCompanion = function() {\n                                  if (!isCtor) {\n                                    if (companionApp === undefined) {\n                                      throw Error('impossible: no companion yet');\n                                    }\n                                    recordApp(companionApp);\n                                  }\n                                };\n                                readCI = function(lab) { return companionInfo[lab] || 0; };\n                                companionCalls = readCI(\"publish\".concat(funcNum)) + (whichApi ? readCI(\"api_\".concat(whichApi)) : 0);\n                                debug('companion', { whichApi: whichApi, companionCalls: companionCalls, companionInfo: companionInfo });\n                                if (companionCalls > 0) {\n                                  howManyMoreFees += companionCalls;\n                                  addCompanion();\n                                }\n                                if (isHalt) {\n                                  addCompanion();\n                                  howManyMoreFees++;\n                                }\n                              }\n                              debug(dhead, 'txnExtraTxns', txnExtraTxns);\n                              debug(dhead, { howManyMoreFees: howManyMoreFees, extraFees: extraFees });\n                              extraFees += MinTxnFee * howManyMoreFees;\n                              debug(dhead, { extraFees: extraFees });\n                              debug(dhead, 'MAP', { mapAccts: mapAccts });\n                              if (mapAccts.length > MaxAppTxnAccounts) {\n                                throw Error(\"Application references too many local state cells in one step. Reach should catch this problem statically.\");\n                              }\n                              mapAcctsVal = (mapAccts.length === 0) ? undefined : mapAccts;\n                              assetsVal = (assetsArr.length === 0) ? undefined : assetsArr;\n                              debug(dhead, { assetsArr: assetsArr, assetsVal: assetsVal });\n                              foreignVal = (foreignArr.length === 0) ? undefined : foreignArr;\n                              debug(dhead, { foreignArr: foreignArr, foreignVal: foreignVal });\n                              actual_args = [lct, msg];\n                              actual_tys = [T_UInt, T_Tuple(msg_tys)];\n                              debug(dhead, '--- ARGS =', actual_args);\n                              safe_args = actual_args.map(\n                                // @ts-ignore\n                                function(m, i) { return actual_tys[i].toNet(m); });\n                              safe_args.unshift(new Uint8Array([funcNum]));\n                              safe_args.unshift(new Uint8Array([0]));\n                              safe_args.forEach(function(x) {\n                                if (!(x instanceof Uint8Array)) {\n                                  // The types say this is impossible now,\n                                  // but we'll leave it in for a while just in case...\n                                  throw Error(\"expect safe program argument, got \".concat(j2s(x)));\n                                }\n                              });\n                              debug(dhead, '--- PREPARE:', safe_args.map(ui8h));\n                              whichAppl = isHalt ?\n                                // We are treating it like any party can delete the application, but the docs say it may only be possible for the creator. The code appears to not care: https://github.com/algorand/go-algorand/blob/0e9cc6b0c2ddc43c3cfa751d61c1321d8707c0da/ledger/apply/application.go#L589\n                                algosdk.makeApplicationDeleteTxn :\n                                algosdk.makeApplicationNoOpTxn;\n                              txnAppl = whichAppl(thisAcc.addr, params, bigNumberToNumber(ApplicationID), safe_args, mapAcctsVal, foreignVal, assetsVal, NOTE_Reach);\n                              txnAppl.fee += extraFees;\n                              rtxns = __spreadArray(__spreadArray([], __read(txnExtraTxns), false), [txnAppl], false);\n                              debug(dhead, \"assigning\", { rtxns: rtxns });\n                              algosdk.assignGroupID(rtxns);\n                              wtxns = rtxns.map(toWTxn);\n                              debug(dhead, 'signing', { wtxns: wtxns });\n                              res = void 0;\n                              _t.label = 9;\n                            case 9:\n                              _t.trys.push([9, 11, , 14]);\n                              return [4 /*yield*/ , signSendAndConfirm(thisAcc, wtxns)];\n                            case 10:\n                              res = _t.sent();\n                              return [3 /*break*/ , 14];\n                            case 11:\n                              e_10 = _t.sent();\n                              jes = j2s(e_10);\n                              debug(dhead, 'FAIL', e_10, jes);\n                              if (!!soloSend) return [3 /*break*/ , 13];\n                              // If there is no soloSend, then someone else \"won\", so let's\n                              // listen for their message\n                              debug(dhead, 'LOST');\n                              _r = {};\n                              return [4 /*yield*/ , doRecv(false, false, jes)];\n                            case 12:\n                              return [2 /*return*/ , (_r.value = _t.sent(), _r)];\n                            case 13:\n                              if (timeoutAt) {\n                                // If there can be a timeout, then keep waiting for it\n                                debug(dhead, \"CONTINUE\");\n                                return [2 /*return*/ , \"continue\"];\n                              } else {\n                                // Otherwise, something bad is happening\n                                throw Error(\"\".concat(label, \" failed to call \").concat(funcName, \": \").concat(jes));\n                              }\n                              return [3 /*break*/ , 14];\n                            case 14:\n                              debug(dhead, 'SUCCESS', res);\n                              _s = {};\n                              return [4 /*yield*/ , trustedRecv(res)];\n                            case 15:\n                              return [2 /*return*/ , (_s.value = _t.sent(), _s)];\n                          }\n                        });\n                      };\n                      _m.label = 12;\n                    case 12:\n                      if (!true) return [3 /*break*/ , 14];\n                      return [5 /*yield**/ , _loop_1()];\n                    case 13:\n                      state_1 = _m.sent();\n                      if (typeof state_1 === \"object\")\n                        return [2 /*return*/ , state_1.value];\n                      return [3 /*break*/ , 12];\n                    case 14:\n                      return [2 /*return*/ ];\n                  }\n                });\n              });\n            };\n            var recvFrom = function(rfargs) {\n              return __awaiter(void 0, void 0, void 0, function() {\n                var dhead, funcNum, out_tys, didSend, txn, isCtor, ccai, theRound, theSecs, lr, ctc_args, fromAddr, from, getOutput;\n                return __generator(this, function(_a) {\n                  switch (_a.label) {\n                    case 0:\n                      dhead = rfargs.dhead, funcNum = rfargs.funcNum, out_tys = rfargs.out_tys, didSend = rfargs.didSend, txn = rfargs.txn;\n                      debug(dhead, 'txn', txn);\n                      if (hasCompanion) {\n                        isCtor = funcNum === 0;\n                        if (isCtor) {\n                          ccai = txn['created-companion-application-index'];\n                          if (ccai == undefined) {\n                            throw Error('impossible: no companion index');\n                          }\n                          companionApp = bigNumberify(ccai);\n                        }\n                      }\n                      theRound = txn['confirmed-round'];\n                      return [4 /*yield*/ , retryLoop([dhead, 'getTimeSecs'], function() { return getTimeSecs(bigNumberify(theRound)); })];\n                    case 1:\n                      theSecs = _a.sent();\n                      lr = makeLogRep(reachEvent(funcNum), out_tys);\n                      ctc_args = lr.parse0(txn);\n                      debug(dhead, { ctc_args: ctc_args });\n                      if (ctc_args === undefined) {\n                        throw Error(\"impossible: txn doesn't have right log as first\");\n                      }\n                      fromAddr = txn['sender'];\n                      from = T_Address.canonicalize({ addr: fromAddr });\n                      debug(dhead, { from: from, fromAddr: fromAddr });\n                      getOutput = function(o_mode, o_lab, o_ctc, o_val) {\n                        return __awaiter(void 0, void 0, void 0, function() {\n                          var f_ctc, _a, _b, l, lb, ln, ls, ld, o;\n                          var e_11, _c;\n                          return __generator(this, function(_d) {\n                            debug(\"getOutput\", { o_mode: o_mode, o_lab: o_lab, o_ctc: o_ctc, o_val: o_val });\n                            f_ctc = T_Tuple([T_UInt, o_ctc]);\n                            try {\n                              for (_a = __values(txn['logs']), _b = _a.next(); !_b.done; _b = _a.next()) {\n                                l = _b.value;\n                                lb = reNetify(l);\n                                ln = T_UInt.fromNet(lb);\n                                ls = \"v\".concat(ln);\n                                debug(\"getOutput\", { l: l, lb: lb, ln: ln, ls: ls });\n                                if (ls === o_lab) {\n                                  ld = f_ctc.fromNet(lb);\n                                  o = ld[1];\n                                  debug(\"getOutput\", { ld: ld, o: o });\n                                  return [2 /*return*/ , o];\n                                }\n                              }\n                            } catch (e_11_1) { e_11 = { error: e_11_1 }; } finally {\n                              try {\n                                if (_b && !_b.done && (_c = _a[\"return\"])) _c.call(_a);\n                              } finally { if (e_11) throw e_11.error; }\n                            }\n                            throw Error(\"no log for \".concat(o_lab));\n                          });\n                        });\n                      };\n                      return [2 /*return*/ , {\n                        didSend: didSend,\n                        didTimeout: false,\n                        data: ctc_args,\n                        time: bigNumberify(theRound),\n                        secs: bigNumberify(theSecs),\n                        from: from,\n                        getOutput: getOutput\n                      }];\n                  }\n                });\n              });\n            };\n            var recv = function(rargs) {\n              return __awaiter(void 0, void 0, void 0, function() {\n                var funcNum, out_tys, didSend, timeoutAt, waitIfNotPresent, funcName, dhead, isIsolatedNetwork, didTimeout, res, correctStep, good, txn;\n                return __generator(this, function(_a) {\n                  switch (_a.label) {\n                    case 0:\n                      funcNum = rargs.funcNum, out_tys = rargs.out_tys, didSend = rargs.didSend, timeoutAt = rargs.timeoutAt, waitIfNotPresent = rargs.waitIfNotPresent;\n                      funcName = \"m\".concat(funcNum);\n                      dhead = \"\".concat(label, \": recv \").concat(funcName, \" \").concat(timeoutAt);\n                      debug(dhead, 'start');\n                      return [4 /*yield*/ , getC()];\n                    case 1:\n                      isIsolatedNetwork = (_a.sent()).isIsolatedNetwork;\n                      didTimeout = function(cr_bn) {\n                        return __awaiter(void 0, void 0, void 0, function() {\n                          var crp, r;\n                          return __generator(this, function(_a) {\n                            switch (_a.label) {\n                              case 0:\n                                crp = cr_bn.add(1);\n                                debug(dhead, 'TIMECHECK', { timeoutAt: timeoutAt, cr_bn: cr_bn, crp: crp });\n                                return [4 /*yield*/ , checkTimeout(isIsolatedNetwork, getTimeSecs, timeoutAt, crp)];\n                              case 1:\n                                r = _a.sent();\n                                debug(dhead, 'TIMECHECK', { r: r, waitIfNotPresent: waitIfNotPresent });\n                                if (!(!r && waitIfNotPresent)) return [3 /*break*/ , 3];\n                                return [4 /*yield*/ , waitUntilTime(crp)];\n                              case 2:\n                                _a.sent();\n                                _a.label = 3;\n                              case 3:\n                                return [2 /*return*/ , r];\n                            }\n                          });\n                        });\n                      };\n                      return [4 /*yield*/ , eq.peq(dhead, didTimeout)];\n                    case 2:\n                      res = _a.sent();\n                      debug(dhead, \"res\", res);\n                      correctStep = makeHasLogFor(funcNum, out_tys);\n                      good = (!res.timeout) && correctStep(res.txn);\n                      if (!good) return [3 /*break*/ , 5];\n                      return [4 /*yield*/ , eq.deq(dhead)];\n                    case 3:\n                      _a.sent();\n                      txn = res.txn;\n                      return [4 /*yield*/ , recvFrom({ dhead: dhead, out_tys: out_tys, didSend: didSend, funcNum: funcNum, txn: txn })];\n                    case 4:\n                      return [2 /*return*/ , _a.sent()];\n                    case 5:\n                      if (timeoutAt) {\n                        debug(dhead, \"timeout\");\n                        return [2 /*return*/ , { didTimeout: true }];\n                      } else {\n                        throw Error(\"\".concat(dhead, \": impossible: not good, but no timeout\"));\n                      }\n                      _a.label = 6;\n                    case 6:\n                      return [2 /*return*/ ];\n                  }\n                });\n              });\n            };\n            var getBalance = function(mtok) {\n              if (mtok === void 0) { mtok = false; }\n              return __awaiter(void 0, void 0, void 0, function() {\n                var ctcAddr, bal, result;\n                return __generator(this, function(_a) {\n                  switch (_a.label) {\n                    case 0:\n                      return [4 /*yield*/ , getC()];\n                    case 1:\n                      ctcAddr = (_a.sent()).ctcAddr;\n                      return [4 /*yield*/ , balanceOf({ addr: ctcAddr }, mtok)];\n                    case 2:\n                      bal = _a.sent();\n                      result = bal.lt(minimumBalance) ? bigNumberify(0) : bal.sub(minimumBalance);\n                      debug(\"Balance of contract:\", result);\n                      return [2 /*return*/ , result];\n                  }\n                });\n              });\n            };\n            return { getContractInfo: getContractInfo, getContractAddress: getContractAddress, getContractCompanion: getContractCompanion, getBalance: getBalance, getState: getState, getCurrentStep: getCurrentStep, sendrecv: sendrecv, recv: recv, apiMapRef: apiMapRef, simTokenAccepted: simTokenAccepted };\n          };\n          var readStateBytes = function(prefix, key, src) {\n            debug({ prefix: prefix, key: key });\n            var ik = base64ify(new Uint8Array(key));\n            debug({ ik: ik });\n            var ste = src.find(function(x) { return x.key === ik; });\n            debug({ ste: ste });\n            if (ste === undefined) {\n              return undefined;\n            };\n            var st = ste.value;\n            debug({ st: st });\n            if (st.bytes === undefined) {\n              return undefined;\n            };\n            var bsi = base64ToUI8A(st.bytes);\n            debug({ bsi: bsi });\n            return bsi;\n          };\n          var recoverSplitBytes = function(prefix, size, howMany, src) {\n            debug('recoverSplitBytes', { prefix: prefix, size: size, howMany: howMany, src: src });\n            var bs = new Uint8Array(size);\n            var offset = 0;\n            for (var i = 0; i < howMany; i++) {\n              var bsi = readStateBytes(prefix, [i], src);\n              if (!bsi || bsi.length == 0) {\n                // We are at a state where we don't need all the keys, so they\n                // haven't all been set, bs is initialized to 0, so this should be\n                // fine.\n                return bs;\n              }\n              bs.set(bsi, offset);\n              offset += bsi.length;\n            }\n            return bs;\n          };\n          var setupView = function(setupViewArgs) {\n            var eq = newEventQueue();\n            var getC = makeGetC(setupViewArgs, eq);\n            var viewLib = {\n              viewMapRef: function(mapi, a) {\n                return __awaiter(void 0, void 0, void 0, function() {\n                  var viewMapRef;\n                  return __generator(this, function(_a) {\n                    switch (_a.label) {\n                      case 0:\n                        return [4 /*yield*/ , getC()];\n                      case 1:\n                        viewMapRef = (_a.sent()).viewMapRef;\n                        return [4 /*yield*/ , viewMapRef(mapi, a)];\n                      case 2:\n                        return [2 /*return*/ , _a.sent()];\n                    }\n                  });\n                });\n              }\n            };\n            var getView1 = function(vs, v, k, vim, isSafe) {\n              if (isSafe === void 0) { isSafe = true; }\n              return function() {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                  args[_i] = arguments[_i];\n                }\n                return __awaiter(void 0, void 0, void 0, function() {\n                  var decode, ch, step, vi, vtys_1, _a, _, vvs, vres, e_12;\n                  return __generator(this, function(_b) {\n                    switch (_b.label) {\n                      case 0:\n                        debug('getView1', v, k, args);\n                        decode = vim.decode;\n                        return [4 /*yield*/ , getC()];\n                      case 1:\n                        ch = _b.sent();\n                        _b.label = 2;\n                      case 2:\n                        _b.trys.push([2, 6, , 7]);\n                        return [4 /*yield*/ , getCurrentStep_(ch)];\n                      case 3:\n                        step = _b.sent();\n                        vi = bigNumberToNumber(step);\n                        vtys_1 = vs[vi];\n                        if (!vtys_1) {\n                          throw Error(\"no views for state \".concat(step));\n                        }\n                        return [4 /*yield*/ , getState_(getC, function(_) { return vtys_1; })];\n                      case 4:\n                        _a = __read.apply(void 0, [_b.sent(), 2]), _ = _a[0], vvs = _a[1];\n                        return [4 /*yield*/ , decode(vi, vvs, args)];\n                      case 5:\n                        vres = _b.sent();\n                        debug({ vres: vres });\n                        return [2 /*return*/ , isSafe ? ['Some', vres] : vres];\n                      case 6:\n                        e_12 = _b.sent();\n                        debug(\"getView1\", v, k, 'error', e_12);\n                        if (isSafe) {\n                          return [2 /*return*/ , ['None', null]];\n                        } else {\n                          throw Error(\"View \".concat(v, \".\").concat(k, \" is not set.\"));\n                        }\n                        return [3 /*break*/ , 7];\n                      case 7:\n                        return [2 /*return*/ ];\n                    }\n                  });\n                });\n              };\n            };\n            return { getView1: getView1, viewLib: viewLib };\n          };\n          var setupEvents = function(setupArgs) {\n            var createEventStream = function(evt, tys) {\n              var eq = newEventQueue();\n              var getC = makeGetC(setupArgs, eq);\n              var getTxnTime = function(r) { return bigNumberify(r['confirmed-round']); };\n              var sync = function() {\n                return __awaiter(void 0, void 0, void 0, function() {\n                  var _a;\n                  return __generator(this, function(_b) {\n                    switch (_b.label) {\n                      case 0:\n                        return [4 /*yield*/ , getC()];\n                      case 1:\n                        _a = _b.sent();\n                        return [2 /*return*/ ];\n                    }\n                  });\n                });\n              };\n              var getLogs = function(r) { return r['logs']; };\n              var lr = makeLogRep(evt, tys);\n              var parseLog = lr.parse;\n              return makeEventStream({\n                eq: eq,\n                getTxnTime: getTxnTime,\n                sync: sync,\n                getNetworkTime: getNetworkTime,\n                getLogs: getLogs,\n                parseLog: parseLog\n              });\n            };\n            return { createEventStream: createEventStream };\n          };\n          var ABI_sigs = ABI.sigs;\n          var getABI = function(isFull) {\n            return ({\n              sigs: (isFull ? ABI_sigs : ABI_sigs.map(function(name) { return ({ name: name }); }).filter(stdABIFilter).map(function(_a) {\n                var name = _a.name;\n                return name;\n              }))\n            });\n          };\n          return stdContract({ bin: bin, getABI: getABI, waitUntilTime: waitUntilTime, waitUntilSecs: waitUntilSecs, selfAddress: selfAddress, iam: iam, stdlib: stdlib, setupView: setupView, setupEvents: setupEvents, _setup: _setup, givenInfoP: givenInfoP });\n        };\n        me_na = { networkAccount: networkAccount };\n        tokenAccepted = function(token) {\n          return __awaiter(void 0, void 0, void 0, function() {\n            var r;\n            return __generator(this, function(_a) {\n              switch (_a.label) {\n                case 0:\n                  debug(\"tokenAccepted\", token);\n                  return [4 /*yield*/ , balanceOfM(me_na, token)];\n                case 1:\n                  r = _a.sent();\n                  return [2 /*return*/ , (r !== false)];\n              }\n            });\n          });\n        };\n        tokenAccept = function(token) {\n          return __awaiter(void 0, void 0, void 0, function() {\n            return __generator(this, function(_a) {\n              switch (_a.label) {\n                case 0:\n                  return [4 /*yield*/ , tokenAccepted(token)];\n                case 1:\n                  if (!!(_a.sent())) return [3 /*break*/ , 3];\n                  debug(\"tokenAccept\", token);\n                  // @ts-ignore\n                  return [4 /*yield*/ , transfer(me_na, me_na, 0, token)];\n                case 2:\n                  // @ts-ignore\n                  _a.sent();\n                  _a.label = 3;\n                case 3:\n                  return [2 /*return*/ ];\n              }\n            });\n          });\n        };\n        tokenMetadata = function(token) {\n          return __awaiter(void 0, void 0, void 0, function() {\n            var tokenRes, tokenInfo, p_t, p, name, symbol, url, metadata, supply, decimals, clawback, creator, freeze, manager, reserve, defaultFrozen;\n            return __generator(this, function(_a) {\n              switch (_a.label) {\n                case 0:\n                  debug(\"tokenMetadata\", token);\n                  return [4 /*yield*/ , getAssetInfo(bigNumberToNumber(token))];\n                case 1:\n                  tokenRes = _a.sent();\n                  debug({ tokenRes: tokenRes });\n                  tokenInfo = tokenRes['params'];\n                  debug({ tokenInfo: tokenInfo });\n                  p_t = function(t, x) {\n                    return x ? t.fromNet(reNetify(x)) : undefined;\n                  };\n                  p = function(n, x) {\n                    return p_t(T_Bytes(n), x);\n                  };\n                  name = p(32, tokenInfo['name-b64']);\n                  symbol = p(8, tokenInfo['unit-name-b64']);\n                  url = p(96, tokenInfo['url-b64']);\n                  metadata = (function() {\n                    var mh = tokenInfo['metadata-hash'];\n                    try {\n                      return p(32, mh);\n                    } catch (e) {\n                      debug(\"tokenMetadata metadata-hash\", \"\".concat(e));\n                      return p_t(T_Digest, mh);\n                    }\n                  })();\n                  supply = bigNumberify(tokenInfo['total']);\n                  decimals = bigNumberify(tokenInfo['decimals']);\n                  clawback = tokenInfo.clawback, creator = tokenInfo.creator, freeze = tokenInfo.freeze, manager = tokenInfo.manager, reserve = tokenInfo.reserve;\n                  defaultFrozen = tokenInfo['default-frozen'];\n                  return [2 /*return*/ , { name: name, symbol: symbol, url: url, metadata: metadata, supply: supply, decimals: decimals, clawback: clawback, creator: creator, defaultFrozen: defaultFrozen, freeze: freeze, manager: manager, reserve: reserve }];\n              }\n            });\n          });\n        };\n        unsupportedAcc = stdAccount_unsupported(connector);\n        accObj = __assign(__assign({}, unsupportedAcc), { networkAccount: networkAccount, getAddress: selfAddress, stdlib: stdlib, setDebugLabel: setDebugLabel, tokenAccepted: tokenAccepted, tokenAccept: tokenAccept, tokenMetadata: tokenMetadata, contract: contract });\n        acc = accObj;\n        balanceOf_ = function(token) { return balanceOf(acc, token); };\n        balancesOf_ = function(tokens) { return balancesOf(acc, tokens); };\n        return [2 /*return*/ , stdAccount(__assign(__assign({}, accObj), { balanceOf: balanceOf_, balancesOf: balancesOf_ }))];\n      });\n    });\n  };\n  var minimumBalanceOf = function(acc) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var ai, createdAppCount, optinAppCount, numByteSlice, numUInt, assetCount, accMinBalance;\n      var _a, _b, _c, _d, _e, _f, _g;\n      return __generator(this, function(_h) {\n        switch (_h.label) {\n          case 0:\n            return [4 /*yield*/ , getAccountInfo(acc)];\n          case 1:\n            ai = _h.sent();\n            if (ai.amount === BigInt(0)) {\n              return [2 /*return*/ , bigNumberify(0)];\n            }\n            createdAppCount = bigNumberify(((_a = ai['created-apps']) !== null && _a !== void 0 ? _a : []).length);\n            optinAppCount = bigNumberify(((_b = ai['apps-local-state']) !== null && _b !== void 0 ? _b : []).length);\n            numByteSlice = bigNumberify((_d = ((_c = ai['apps-total-schema']) !== null && _c !== void 0 ? _c : {})['num-byte-slice']) !== null && _d !== void 0 ? _d : 0);\n            numUInt = bigNumberify((_f = ((_e = ai['apps-total-schema']) !== null && _e !== void 0 ? _e : {})['num-uint']) !== null && _f !== void 0 ? _f : 0);\n            assetCount = bigNumberify(((_g = ai.assets) !== null && _g !== void 0 ? _g : []).length);\n            accMinBalance = bigNumberify(0)\n              .add(assetCount.mul(appFlatOptInMinBalance))\n              .add(schemaMinBalancePerEntry.add(schemaUintMinBalance).mul(numUInt))\n              .add(schemaMinBalancePerEntry.add(schemaBytesMinBalance).mul(numByteSlice))\n              .add(appFlatParamsMinBalance.mul(createdAppCount))\n              .add(appFlatOptInMinBalance.mul(optinAppCount))\n              .add(minimumBalance);\n            debug(\"minBalance\", accMinBalance);\n            return [2 /*return*/ , accMinBalance];\n        }\n      });\n    });\n  };\n  var balancesOfM = function(acc, tokens) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var bn, tokenbs, client, query_1, accountInfoM, accountInfo_1, accountAssets_1, tokenBalances_1, indexer, addr, query, accountAssets, tokenBalances;\n      var _a;\n      return __generator(this, function(_b) {\n        switch (_b.label) {\n          case 0:\n            bn = bigNumberify;\n            tokenbs = tokens.map(function(tr) { return tr == null ? tr : bn(tr); });\n            return [4 /*yield*/ , nodeCanRead()];\n          case 1:\n            if (!_b.sent()) return [3 /*break*/ , 4];\n            return [4 /*yield*/ , getAlgodClient()];\n          case 2:\n            client = _b.sent();\n            query_1 = client.accountInformation(extractAddr(acc));\n            return [4 /*yield*/ , doQueryM_('balancesOfM', query_1)];\n          case 3:\n            accountInfoM = _b.sent();\n            if ('val' in accountInfoM) {\n              accountInfo_1 = accountInfoM['val'];\n              accountAssets_1 = (_a = accountInfo_1['assets']) !== null && _a !== void 0 ? _a : [];\n              tokenBalances_1 = tokenbs.map(function(tb) {\n                var _a;\n                if (tb === null) {\n                  return bn(accountInfo_1['amount']);\n                } else {\n                  var bal = (_a = accountAssets_1.find(function(asset) { return tb.eq(asset['asset-id']); })) === null || _a === void 0 ? void 0 : _a['amount'];\n                  return bal ? bn(bal) : false;\n                }\n              });\n              return [2 /*return*/ , tokenBalances_1];\n            }\n            _b.label = 4;\n          case 4:\n            return [4 /*yield*/ , getIndexer()];\n          case 5:\n            indexer = _b.sent();\n            addr = extractAddr(acc);\n            query = indexer.lookupAccountAssets(addr);\n            return [4 /*yield*/ , doQuery_('balancesOfM', query)];\n          case 6:\n            accountAssets = (_b.sent())['assets'];\n            tokenBalances = tokenbs.map(function(tb) {\n              return __awaiter(void 0, void 0, void 0, function() {\n                var bal;\n                var _a;\n                return __generator(this, function(_b) {\n                  switch (_b.label) {\n                    case 0:\n                      if (!(tb === null)) return [3 /*break*/ , 2];\n                      return [4 /*yield*/ , balanceOfM(acc, tb)];\n                    case 1:\n                      return [2 /*return*/ , _b.sent()];\n                    case 2:\n                      bal = (_a = accountAssets.find(function(asset) { return tb.eq(asset['asset-id']); })) === null || _a === void 0 ? void 0 : _a['amount'];\n                      return [2 /*return*/ , bal ? bn(bal) : false];\n                  }\n                });\n              });\n            });\n            return [2 /*return*/ , Promise.all(tokenBalances)];\n        }\n      });\n    });\n  };\n  var balanceOfM = function(acc, token) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var dhead, addr, client, query, accountInfo, indexer, query, accountInfoM;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            dhead = 'balanceOfM';\n            addr = extractAddr(acc);\n            if (!(token == null)) return [3 /*break*/ , 8];\n            return [4 /*yield*/ , nodeCanRead()];\n          case 1:\n            if (!_a.sent()) return [3 /*break*/ , 4];\n            return [4 /*yield*/ , getAlgodClient()];\n          case 2:\n            client = _a.sent();\n            query = client.accountInformation(addr).exclude('all');\n            return [4 /*yield*/ , doQuery_(dhead, query)];\n          case 3:\n            accountInfo = _a.sent();\n            return [2 /*return*/ , bigNumberify(accountInfo['amount'])];\n          case 4:\n            return [4 /*yield*/ , getIndexer()];\n          case 5:\n            indexer = _a.sent();\n            query = indexer.lookupAccountByID(addr).exclude('all');\n            return [4 /*yield*/ , doQueryM_(dhead, query)];\n          case 6:\n            accountInfoM = _a.sent();\n            if ('val' in accountInfoM) {\n              return [2 /*return*/ , bigNumberify(accountInfoM['val']['account']['amount'])];\n            } else {\n              return [2 /*return*/ , false];\n            }\n            _a.label = 7;\n          case 7:\n            return [3 /*break*/ , 9];\n          case 8:\n            return [2 /*return*/ , balanceOfMNonNet(addr, token)];\n          case 9:\n            return [2 /*return*/ ];\n        }\n      });\n    });\n  };\n  var balanceOfMNonNet = function(addr, token) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var tokenId, client, query, accountAssetInfoM, assetHolding;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            tokenId = bigNumberToNumber(token);\n            return [4 /*yield*/ , getAlgodClient()];\n          case 1:\n            client = _a.sent();\n            query = client.accountAssetInformation(addr, tokenId);\n            return [4 /*yield*/ , doQueryM_(\"balanceOfMNonNet\", query)];\n          case 2:\n            accountAssetInfoM = _a.sent();\n            if ('val' in accountAssetInfoM) {\n              assetHolding = accountAssetInfoM['val']['asset-holding'];\n              return [2 /*return*/ , assetHolding ? bigNumberify(assetHolding['amount']) : false];\n            } else {\n              return [2 /*return*/ , false];\n            }\n            return [2 /*return*/ ];\n        }\n      });\n    });\n  };\n  var balancesOf = function(acc, tokens) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/ , balancesOfM(acc, tokens)];\n          case 1:\n            return [2 /*return*/ , (_a.sent()).map(function(bal) { return bal == false ? bigNumberify(0) : bal; })];\n        }\n      });\n    });\n  };\n  var balanceOf = function(acc, token) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/ , balanceOfM(acc, token || null)];\n          case 1:\n            return [2 /*return*/ , (_a.sent()) || bigNumberify(0)];\n        }\n      });\n    });\n  };\n  var createAccount = function() {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var networkAccount;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            networkAccount = algosdk.generateAccount();\n            return [4 /*yield*/ , connectAccount(networkAccount)];\n          case 1:\n            return [2 /*return*/ , _a.sent()];\n        }\n      });\n    });\n  };\n  var canFundFromFaucet = function() {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var faucet, dhead, txnParams, act, exp, fbal;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/ , getFaucet()];\n          case 1:\n            faucet = _a.sent();\n            dhead = 'canFundFromFaucet';\n            debug(dhead, 'check genesis');\n            return [4 /*yield*/ , getTxnParams(dhead)];\n          case 2:\n            txnParams = _a.sent();\n            act = txnParams.genesisID;\n            exp = 'devnet-v1';\n            if (act !== exp) {\n              debug(dhead, \"expected '\".concat(exp, \"' !== actual '\").concat(act, \"'\"));\n              return [2 /*return*/ , false];\n            }\n            debug(dhead, 'check balance');\n            return [4 /*yield*/ , balanceOf(faucet)];\n          case 3:\n            fbal = _a.sent();\n            debug(dhead, \"faucet balance = \".concat(formatCurrency(fbal, 4), \" \").concat(standardUnit));\n            return [2 /*return*/ , gt(fbal, 0)];\n        }\n      });\n    });\n  };\n  var fundFromFaucet = function(account, value) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var faucet, tag;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/ , getFaucet()];\n          case 1:\n            faucet = _a.sent();\n            debug('fundFromFaucet');\n            tag = Math.round(Math.random() * (Math.pow(2, 32)));\n            return [4 /*yield*/ , transfer(faucet, account, value, undefined, tag)];\n          case 2:\n            _a.sent();\n            return [2 /*return*/ ];\n        }\n      });\n    });\n  };\n  var newTestAccount = function(startingBalance) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var account;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/ , createAccount()];\n          case 1:\n            account = _a.sent();\n            return [4 /*yield*/ , fundFromFaucet(account, startingBalance)];\n          case 2:\n            _a.sent();\n            return [2 /*return*/ , account];\n        }\n      });\n    });\n  };\n  var newTestAccounts = make_newTestAccounts(newTestAccount).parallel;\n  /** @description the display name of the standard unit of currency for the network */\n  var standardUnit = 'ALGO';\n  /** @description the display name of the atomic (smallest) unit of currency for the network */\n  var atomicUnit = 'ALGO';\n  /**\n   * @description  Parse currency by network\n   * @param amt  value in the {@link standardUnit} for the token.\n   * @param {number} [decimals] how many \"decimal places\" the target currency has. Defaults to the network standard.\n   * @returns  the amount in the {@link atomicUnit} of the token.\n   * @example  parseCurrency(100).toString() // => '100000000'\n   * @example  parseCurrency(100, 3).toString() // => '100000'\n   */\n  var parseCurrency = makeParseCurrency(6);\n  var minimumBalance = bigNumberify(MinBalance);\n  var schemaMinBalancePerEntry = bigNumberify(SchemaMinBalancePerEntry);\n  var schemaBytesMinBalance = bigNumberify(SchemaBytesMinBalance);\n  var schemaUintMinBalance = bigNumberify(SchemaUintMinBalance);\n  var appFlatParamsMinBalance = bigNumberify(AppFlatParamsMinBalance);\n  var appFlatOptInMinBalance = bigNumberify(AppFlatOptInMinBalance);\n  var minimumBalance_app_create = function(cns) {\n    var code = cns.code,\n      opts = cns.opts;\n    var approval = code.approval,\n      clearState = code.clearState;\n    var totalLen = approval.length + clearState.length;\n    var ai_ExtraProgramPages = Math.ceil(totalLen / MaxAppProgramLen) - 1;\n    var ai_GlobalNumByteSlice = opts.globalBytes,\n      ai_GlobalNumUint = opts.globalUints;\n    return bigNumberify(100000 * (1 + ai_ExtraProgramPages) + (25000 + 3500) * ai_GlobalNumUint + (25000 + 25000) * ai_GlobalNumByteSlice);\n  };\n  /**\n   * @description  Format currency by network\n   */\n  function formatCurrency(amt, decimals) {\n    if (decimals === void 0) { decimals = 6; }\n    return handleFormat(amt, decimals, 6);\n  }\n\n  function getDefaultAccount() {\n    return __awaiter(this, void 0, void 0, function() {\n      var addr;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/ , getProvider()];\n          case 1:\n            return [4 /*yield*/ , (_a.sent()).getDefaultAddress()];\n          case 2:\n            addr = _a.sent();\n            return [4 /*yield*/ , connectAccount({ addr: addr })];\n          case 3:\n            return [2 /*return*/ , _a.sent()];\n        }\n      });\n    });\n  }\n  /**\n   * @param mnemonic 25 words, space-separated\n   */\n  var newAccountFromMnemonic = function(mnemonic) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/ , connectAccount(algosdk.mnemonicToSecretKey(mnemonic))];\n          case 1:\n            return [2 /*return*/ , _a.sent()];\n        }\n      });\n    });\n  };\n  /**\n   * @param secret a Uint8Array, or its hex string representation\n   */\n  var newAccountFromSecret = function(secret) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var sk, mnemonic;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            sk = ethers.utils.arrayify(secret);\n            mnemonic = algosdk.secretKeyToMnemonic(sk);\n            return [4 /*yield*/ , newAccountFromMnemonic(mnemonic)];\n          case 1:\n            return [2 /*return*/ , _a.sent()];\n        }\n      });\n    });\n  };\n  var getNetworkTime = function() {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var indexer, hc;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/ , getIndexer()];\n          case 1:\n            indexer = _a.sent();\n            return [4 /*yield*/ , indexer.makeHealthCheck()[\"do\"]()];\n          case 2:\n            hc = _a.sent();\n            return [2 /*return*/ , bigNumberify(hc['round'])];\n        }\n      });\n    });\n  };\n  var getTimeSecs = function(now_bn) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var now, client, binfo, e_13, indexer, info;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            now = bigNumberToNumber(now_bn);\n            _a.label = 1;\n          case 1:\n            _a.trys.push([1, 5, , 8]);\n            return [4 /*yield*/ , ensureNodeCanRead()];\n          case 2:\n            _a.sent();\n            return [4 /*yield*/ , getAlgodClient()];\n          case 3:\n            client = _a.sent();\n            return [4 /*yield*/ , client.block(now)[\"do\"]()];\n          case 4:\n            binfo = _a.sent();\n            //debug(`getTimeSecs`, `node`, binfo);\n            return [2 /*return*/ , bigNumberify(binfo.block.ts)];\n          case 5:\n            e_13 = _a.sent();\n            debug(\"getTimeSecs\", \"node failed\", e_13);\n            return [4 /*yield*/ , getIndexer()];\n          case 6:\n            indexer = _a.sent();\n            return [4 /*yield*/ , indexer.lookupBlock(now)[\"do\"]()];\n          case 7:\n            info = _a.sent();\n            debug(\"getTimeSecs\", \"indexer\", info);\n            return [2 /*return*/ , bigNumberify(info['timestamp'])];\n          case 8:\n            return [2 /*return*/ ];\n        }\n      });\n    });\n  };\n  var getNetworkSecs = function() {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var _a;\n      return __generator(this, function(_b) {\n        switch (_b.label) {\n          case 0:\n            _a = getTimeSecs;\n            return [4 /*yield*/ , getNetworkTime()];\n          case 1:\n            return [4 /*yield*/ , _a.apply(void 0, [_b.sent()])];\n          case 2:\n            return [2 /*return*/ , _b.sent()];\n        }\n      });\n    });\n  };\n  var stepTime = function(target) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var now, _a;\n      return __generator(this, function(_b) {\n        switch (_b.label) {\n          case 0:\n            if (!true) return [3 /*break*/ , 8];\n            return [4 /*yield*/ , getNetworkTime()];\n          case 1:\n            now = _b.sent();\n            debug(\"stepTime\", { target: target, now: now });\n            if (target.lte(now)) {\n              return [2 /*return*/ , now];\n            }\n            return [4 /*yield*/ , getProvider()];\n          case 2:\n            if (!(_b.sent()).isIsolatedNetwork) return [3 /*break*/ , 5];\n            _a = fundFromFaucet;\n            return [4 /*yield*/ , getFaucet()];\n          case 3:\n            return [4 /*yield*/ , _a.apply(void 0, [_b.sent(), 0])];\n          case 4:\n            _b.sent();\n            return [3 /*break*/ , 7];\n          case 5:\n            return [4 /*yield*/ , stdWait()];\n          case 6:\n            _b.sent();\n            _b.label = 7;\n          case 7:\n            return [3 /*break*/ , 0];\n          case 8:\n            return [2 /*return*/ ];\n        }\n      });\n    });\n  };\n  var waitUntilTime = make_waitUntilX('time', getNetworkTime, stepTime);\n  var stepSecs = function(target) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var now, _a;\n      return __generator(this, function(_b) {\n        switch (_b.label) {\n          case 0:\n            void(target);\n            _a = stepTime;\n            return [4 /*yield*/ , getNetworkTime()];\n          case 1:\n            return [4 /*yield*/ , _a.apply(void 0, [(_b.sent()).add(1)])];\n          case 2:\n            now = _b.sent();\n            return [4 /*yield*/ , getTimeSecs(now)];\n          case 3:\n            return [2 /*return*/ , _b.sent()];\n        }\n      });\n    });\n  };\n  var waitUntilSecs = make_waitUntilX('secs', getNetworkSecs, stepSecs);\n  var wait = function(delta, onProgress) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var now;\n      return __generator(this, function(_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/ , getNetworkTime()];\n          case 1:\n            now = _a.sent();\n            return [4 /*yield*/ , waitUntilTime(now.add(delta), onProgress)];\n          case 2:\n            return [2 /*return*/ , _a.sent()];\n        }\n      });\n    });\n  };\n  var appLocalStateNumUInt = 0;\n  var appLocalStateNumBytes = 0;\n  var appGlobalStateNumUInt = 0;\n  var appGlobalStateNumBytes = 1;\n  var verifyContract = function(info, bin) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      return __generator(this, function(_a) {\n        return [2 /*return*/ , verifyContract_('', info, bin, newEventQueue())];\n      });\n    });\n  };\n  var verifyContract_ = function(label, info, bin, eq) {\n    return __awaiter(void 0, void 0, void 0, function() {\n      var ApplicationID, _a, appApproval, appClear, mapDataKeys, stateKeys, dhead, chk, chkeq_x, chkeq_bn_, chkeq_bn, chkeq_bs, appInfoM, appInfo, appInfo_p, Deployer, appInfo_LocalState, appInfo_GlobalState, iat, allocRound;\n      return __generator(this, function(_b) {\n        switch (_b.label) {\n          case 0:\n            must_be_supported(bin);\n            ApplicationID = protect(T_Contract, info);\n            _a = bin._Connectors.ALGO, appApproval = _a.appApproval, appClear = _a.appClear, mapDataKeys = _a.mapDataKeys, stateKeys = _a.stateKeys;\n            dhead = \"\".concat(label, \": verifyContract\");\n            chk = function(p, msg) {\n              if (!p) {\n                throw Error(\"\".concat(dhead, \" failed: \").concat(msg));\n              }\n            };\n            chkeq_x = function(cmp) {\n              return function(a, e, msg) {\n                var as = j2sf(a);\n                var es = j2sf(e);\n                chk(cmp(a, e), \"\".concat(msg, \": expected \").concat(es, \", got \").concat(as));\n              };\n            };\n            chkeq_bn_ = chkeq_x(function(a, b) { return a.eq(b); });\n            chkeq_bn = function(a, b, msg) { return chkeq_bn_(bigNumberify(a), bigNumberify(b), msg); };\n            chkeq_bs = chkeq_x(function(a, b) { return j2sf(a) === j2sf(b); });\n            return [4 /*yield*/ , getApplicationInfoM(ApplicationID)];\n          case 1:\n            appInfoM = _b.sent();\n            if ('exn' in appInfoM) {\n              throw Error(\"\".concat(dhead, \" failed: failed to lookup application (\").concat(ApplicationID, \"): \").concat(j2s(appInfoM.exn)));\n            }\n            appInfo = appInfoM.val;\n            appInfo_p = appInfo['params'];\n            debug(dhead, { appInfo_wanted: bin._Connectors.ALGO });\n            debug(dhead, { appInfo_p: appInfo_p });\n            chk(appInfo_p !== undefined, \"Cannot lookup ApplicationId\");\n            chkeq_bs(appInfo_p['approval-program'], appApproval, \"Approval program does not match Reach backend\");\n            chkeq_bs(appInfo_p['clear-state-program'], appClear, \"ClearState program does not match Reach backend\");\n            Deployer = appInfo_p['creator'];\n            appInfo_LocalState = appInfo_p['local-state-schema'];\n            chkeq_bn(appInfo_LocalState['num-byte-slice'], appLocalStateNumBytes + mapDataKeys, \"Num of byte-slices in local state schema does not match Reach backend\");\n            chkeq_bn(appInfo_LocalState['num-uint'], appLocalStateNumUInt, \"Num of uints in local state schema does not match Reach backend\");\n            appInfo_GlobalState = appInfo_p['global-state-schema'];\n            chkeq_bn(appInfo_GlobalState['num-byte-slice'], appGlobalStateNumBytes + stateKeys, \"Num of byte-slices in global state schema does not match Reach backend\");\n            chkeq_bn(appInfo_GlobalState['num-uint'], appGlobalStateNumUInt, \"Num of uints in global state schema does not match Reach backend\");\n            eq.init({ ApplicationID: ApplicationID });\n            return [4 /*yield*/ , eq.deq(dhead, 1)];\n          case 2:\n            iat = _b.sent();\n            debug({ iat: iat });\n            chkeq_bn(iat['created-application-index'], ApplicationID, 'app created');\n            chkeq_bn(iat['application-index'], 0, 'app created');\n            allocRound = appInfo['created-at-round'];\n            if (allocRound) {\n              chkeq_bn(iat['confirmed-round'], allocRound, 'created on correct round');\n            }\n            chkeq_bs(iat['approval-program'], appInfo_p['approval-program'], \"ApprovalProgram unchanged since creation\");\n            chkeq_bs(iat['clear-state-program'], appInfo_p['clear-state-program'], \"ClearStateProgram unchanged since creation\");\n            return [2 /*return*/ , { ApplicationID: ApplicationID, Deployer: Deployer }];\n        }\n      });\n    });\n  };\n  /**\n   * Formats an account's address in the way users expect to see it.\n   * @param acc Account, NetworkAccount, base32-encoded address, or hex-encoded address\n   * @returns the address formatted as a base32-encoded string with checksum\n   */\n  function formatAddress(acc) {\n    return addressFromHex(T_Address.canonicalize(acc));\n  }\n\n  function unsafeGetMnemonic(acc) {\n    // @ts-ignore\n    var networkAccount = acc.networkAccount || acc;\n    if (!networkAccount.sk) {\n      throw Error(\"unsafeGetMnemonic: Secret key not accessible for account\");\n    }\n    return algosdk.secretKeyToMnemonic(networkAccount.sk);\n  }\n  var launchToken = function(accCreator, name, sym, opts) {\n    if (opts === void 0) { opts = {}; }\n    return __awaiter(void 0, void 0, void 0, function() {\n      var addrCreator, supply, decimals, url, assetMetadataHash, f_addr, clawback, freeze, reserve, note, defaultFrozen, suggestedParams, txnResult, assetIndex, id, mint, optOut;\n      var _a, _b, _c, _d;\n      return __generator(this, function(_e) {\n        switch (_e.label) {\n          case 0:\n            addrCreator = accCreator.networkAccount.addr;\n            supply = opts.supply ? bigNumberify(opts.supply) : bigNumberify(2).pow(64).sub(1);\n            decimals = (_a = opts.decimals) !== null && _a !== void 0 ? _a : 6;\n            url = (_b = opts.url) !== null && _b !== void 0 ? _b : '';\n            assetMetadataHash = (_c = opts.metadataHash) !== null && _c !== void 0 ? _c : '';\n            f_addr = function(x) { return x ? cbr2algo_addr(protect(T_Address, x)) : undefined; };\n            clawback = f_addr(opts.clawback);\n            freeze = f_addr(opts.freeze);\n            reserve = f_addr(opts.reserve);\n            note = opts.note || undefined;\n            defaultFrozen = (_d = opts.defaultFrozen) !== null && _d !== void 0 ? _d : false;\n            return [4 /*yield*/ , getTxnParams('launchToken')];\n          case 1:\n            suggestedParams = _e.sent();\n            return [4 /*yield*/ , sign_and_send_sync(\"launchToken \".concat(j2s(accCreator), \" \").concat(name, \" \").concat(sym), accCreator.networkAccount, toWTxn(algosdk.makeAssetCreateTxnWithSuggestedParamsFromObject({\n              assetMetadataHash: assetMetadataHash,\n              assetName: name,\n              assetURL: url,\n              clawback: clawback,\n              decimals: decimals,\n              defaultFrozen: defaultFrozen,\n              freeze: freeze,\n              note: note,\n              reserve: reserve,\n              suggestedParams: suggestedParams,\n              total: bigNumberToBigInt(supply),\n              unitName: sym,\n              from: addrCreator\n            })))];\n          case 2:\n            txnResult = _e.sent();\n            assetIndex = txnResult['created-asset-index'];\n            if (!assetIndex)\n              throw Error(\"\".concat(sym, \" no asset-index!\"));\n            id = bigNumberify(assetIndex);\n            mint = function(accTo, amt) { return transfer(accCreator, accTo, amt, id); };\n            optOut = function(accFrom, accTo) {\n              if (accTo === void 0) { accTo = accCreator; }\n              return __awaiter(void 0, void 0, void 0, function() {\n                var addrFrom, addrTo, params, optOutTxn;\n                return __generator(this, function(_a) {\n                  switch (_a.label) {\n                    case 0:\n                      addrFrom = accFrom.networkAccount.addr;\n                      addrTo = accTo.networkAccount.addr;\n                      return [4 /*yield*/ , getTxnParams('token.optOut')];\n                    case 1:\n                      params = _a.sent();\n                      optOutTxn = makeTransferTxn(addrFrom, addrTo, bigNumberify(0), id, params, addrTo);\n                      return [4 /*yield*/ , sign_and_send_sync(\"token.optOut \".concat(j2s(accFrom), \" \").concat(name), accFrom.networkAccount, toWTxn(optOutTxn))];\n                    case 2:\n                      _a.sent();\n                      return [2 /*return*/ ];\n                  }\n                });\n              });\n            };\n            return [2 /*return*/ , { name: name, sym: sym, id: id, mint: mint, optOut: optOut }];\n        }\n      });\n    });\n  };\n  return __assign(__assign(__assign(__assign(__assign({}, stdlib), typeDefs), shared_user), ({ setQueryLowerBound: setQueryLowerBound, getQueryLowerBound: getQueryLowerBound, addressFromHex: addressFromHex, formatWithDecimals: formatWithDecimals, setSigningMonitor: setSigningMonitor })), { setCustomHttpEventHandler: setCustomHttpEventHandler, setMinMillisBetweenRequests: setMinMillisBetweenRequests, signSendAndConfirm: signSendAndConfirm, toWTxn: toWTxn, getTxnParams: getTxnParams, MinTxnFee: MinTxnFee, makeTransferTxn: makeTransferTxn, getValidQueryWindow: getValidQueryWindow, setValidQueryWindow: setValidQueryWindow, randomUInt: randomUInt, hasRandom: hasRandom, setWalletFallback: setWalletFallback, walletFallback: walletFallback, getProvider: getProvider, setProvider: setProvider, setProviderByEnv: setProviderByEnv, setProviderByName: setProviderByName, getFaucet: getFaucet, setFaucet: setFaucet, canFundFromFaucet: canFundFromFaucet, fundFromFaucet: fundFromFaucet, providerEnvByName: providerEnvByName, transfer: transfer, connectAccount: connectAccount, minimumBalanceOf: minimumBalanceOf, balancesOf: balancesOf, balanceOf: balanceOf, createAccount: createAccount, newTestAccount: newTestAccount, newTestAccounts: newTestAccounts, getDefaultAccount: getDefaultAccount, newAccountFromMnemonic: newAccountFromMnemonic, newAccountFromSecret: newAccountFromSecret, getNetworkTime: getNetworkTime, getTimeSecs: getTimeSecs, getNetworkSecs: getNetworkSecs, waitUntilTime: waitUntilTime, waitUntilSecs: waitUntilSecs, wait: wait, verifyContract: verifyContract, formatAddress: formatAddress, unsafeGetMnemonic: unsafeGetMnemonic, launchToken: launchToken, parseCurrency: parseCurrency, minimumBalance: minimumBalance, formatCurrency: formatCurrency, reachStdlib: reachStdlib, algosdk: algosdk, connector: connector, standardUnit: standardUnit, atomicUnit: atomicUnit });\n};\n//# sourceMappingURL=ALGO.js.map\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}